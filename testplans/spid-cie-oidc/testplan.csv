V2.3,UID,Old Input tester,Input to test,Input to Entity Under Test,Output,Pattern name,Type,Message Under test,Test Name,Description,Entity under test,Input for generated MR: message to handle,Input for generated MR: Oracle,Requirement,Requirement Source,Profile,Type MIG,Severity,Reasons  for chosen Severity,Reference OAuch,Reference OpenID Connect Conformance Profiles v3.0,Reference spid-cie-oidc-django unit test,Reference Test MIG for CIE Core Web,Reference IPZS Test plan document,Reference spid-oidc-check-op,Note,Has Reference,Checked,Divider,Implementation dependent,Session in spid-oidc-cie-django,"Stato del test [E= Eseguito, N= Non eseguito, ND= Non definito, ToDo= Da Eseguire]",Motivazione,Spid-cie-oidc-django result,"Versione Django Feb,21 2024 - 87467470e7c491e91d0e6bb95ada85ec6f71ca77",Test,Django v2.2
x,AA-Entity Configuration response-metadata-authorization_endpoint-value,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authorization_endpoint claim contains ""private"", not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA metadata contain correct type authorization_endpoint claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the authorization_endpoint claim in the 'federation_entity' entity type is ""private""",AA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"": ""object"",""properties"": {""authorization_endpoint"": {""type"": ""string"",""const"": ""private""}},""required"": [""authorization_endpoint""]}",The AA Metadata of type 'federation_entity' MUST contain authorization_endpoint,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-logo_uri-type,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim is an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA metadata contain correct type logo_uri claim,In this test the SA metadata in the TA Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL with an .svg file,AA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"":""object"", ""properties"":{""logo_uri"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://.*\\.svg$""}},""required"":[""logo_uri""]}",The AA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-op_policy_uri,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the op_policy_uri claim is in the AA metadata, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the AA metadata contain op_policy_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_policy_uri claim in the 'openid_provider' entity type is checked,AA,,Entity Configuration response | body | [^\n\r]* | payload | .metadata.openid_provider.op_policy_uri,The AA Metadata of type 'openid_provider' MUST contain op_policy_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-op_policy_uri-type,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the op_policy_uri claim contains an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA metadata contain correct type op_policy_uri claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the op_policy_uri claim in the 'openid_provider' entity type is ""private""",AA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.openid_provider | {""type"": ""object"",""properties"": {""op_policy_uri"": {""type"": ""string"",""format"": ""uri""}},""required"": [""op_policy_uri""]}",The AA Metadata of type 'openid_provider' MUST contain op_policy_uri as URL,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-resource-type,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the resource claim contains one or more https URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA metadata contain correct type resource claim,In this test the AA metadata in the AA Entity Configuration are taken and the value of the resource claim in the 'federation_entity' entity type is an HTTPS URL,AA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"": ""object"",""properties"": {""resource"": {""oneOf"": [{""type"": ""string"", ""format"": ""uri"", ""pattern"": ""^https://""},{""type"": ""array"",""items"": {""type"": ""string"", ""format"": ""uri"", ""pattern"": ""^https://""},""minItems"": 1}]}},""required"": [""resource""]}",The AA Metadata of type 'federation_entity' MUST contain resource,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-authorization_endpoint,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authorization_endpoint claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the authorization_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the authorization_endpoint claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.authorization_endpoint,The AA Metadata of type 'oauth_authorization_server' MUST contain authorization_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-contacts,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the contacts claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the contacts claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.contacts,The AA Metadata of type 'federation_entity' MUST contain contacts,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-dpop_signing_alg_values_supported-not_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the dpop_signing_alg_values_supported claim does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the AA metadata contain incorrect dpop_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",AA,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.dpop_signing_alg_values_supported.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The AA Metadata of type 'oauth_authorization_server' MUST contain dpop_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-dpop_signing_alg_values_supported-presence,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the dpop_signing_alg_values_supported claim is present, not compliant if it is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain dpop_signing_alg_values_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.dpop_signing_alg_values_supported,The AA Metadata of type 'oauth_authorization_server' MUST contain dpop_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,H,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-dpop_signing_alg_values_supported-supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the dpop_signing_alg_values_supported claim contains 'one_of': ['RS256', 'RS512'], not compliant if it is missing",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the AA metadata contain correct dpop_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is 'one_of': ['RS256', 'RS512']",AA,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.dpop_signing_alg_values_supported.one_of | [""RS256"", ""RS512""]",The AA Metadata of type 'oauth_authorization_server' MUST contain dpop_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-federation_resolve_endpoint,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the federation_resolve_endpoint claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the federation_resolve_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_resolve_endpoint,The AA Metadata of type 'federation_entity' MUST contain federation_resolve_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-federation_trust_mark_status_endpoint,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the federation_trust_mark_status_endpoint claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the federation_trust_mark_status_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_trust_mark_status_endpoint claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_trust_mark_status_endpoint,The AA Metadata of type 'federation_entity' MUST contain federation_trust_mark_status_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-grant_types_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the grant_types_supported claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the grant_types_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the grant_types_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.grant_types_supported,The AA Metadata of type 'oauth_authorization_server' MUST contain grant_types_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-homepage_uri,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the homepage_uri claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the homepage_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.homepage_uri,The AA Metadata of type 'federation_entity' MUST contain homepage_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.28,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-issuer,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the issuer claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the issuer claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the issuer claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.issuer,The AA Metadata of type 'oauth_authorization_server' MUST contain issuer,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-issuer-type,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the issuer claim in the metadata claim is an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA metadata contain a correct type of issuer claim,In this test the AA metadata in the AA Entity Configuration are taken and the value of the issuer claim in the 'oauth_authorization_server' entity type is an URL,AA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.oauth_authorization_server | {""type"":""object"", ""properties"":{""issuer"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://""}},""required"":[""issuer""]})",The AA Metadata of type 'oauth_authorization_server' MUST contain issuer,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-jwks,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the jwks claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the jwks claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the jwks claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.jwks,The AA Metadata of type 'oauth_authorization_server' MUST contain jwks,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-logo_uri,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the logo_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.logo_uri,The AA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-logo_uri-value,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim in the metadata claim is an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA metadata contain a correct logo_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the value of the logo_uri claim is an URL,AA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"":""object"", ""properties"":{""logo_uri"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://""}},""required"":[""logo_uri""]})",The AA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-op_policy_uri,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the op_policy_uri claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the op_policy_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_policy_uri claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.op_policy_uri,The AA Metadata of type 'oauth_authorization_server' MUST contain op_policy_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-op_tos_uri,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the op_tos_uri claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the op_tos_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_tos_uri claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.op_tos_uri,The AA Metadata of type 'oauth_authorization_server' MUST contain op_tos_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-organization_name,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the organization_name claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the organization_name claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.organization_name,The AA Metadata of type 'federation_entity' MUST contain organization_name,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.27,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-policy_uri,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the policy_uri claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the policy_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.policy_uri,The AA Metadata of type 'federation_entity' MUST contain policy_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-resource,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the resource claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the resource claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the resource claim in the 'oauth_resource' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_resource.resource,The AA Metadata of type 'oauth_resource' MUST contain resource,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-response_types_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the response_types_supported claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the response_types_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the response_types_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.response_types_supported,The AA Metadata of type 'oauth_authorization_server' MUST contain response_types_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-scopes_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the scopes_supported claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the scopes_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the scopes_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.scopes_supported,The AA Metadata of type 'oauth_authorization_server' MUST contain scopes_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-token_endpoint,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint claim is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the token_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.token_endpoint,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-token_endpoint_auth_methods_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_methods_supported claim is present, not compliant otherwise.",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the token_endpoint_auth_methods_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.token_endpoint_auth_methods_supported,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_methods_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-token_endpoint_auth_methods_supported-supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_methods_supported claim is present and contains the value 'one_of': ['private_key_jwt'], not compliant otherwise.",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the AA metadata contain the token_endpoint_auth_methods_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked. It must contain the key-value pair 'one_of': ['private_key_jwt'],AA,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.token_endpoint_auth_methods_supported.one_of | [""private_key_jwt""]",The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_methods_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-token_endpoint_auth_signing_alg_values_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the AA metadata contain the token_endpoint_auth_signing_alg_values_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.token_endpoint_auth_signing_alg_values_supported,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-token_endpoint_auth_signing_alg_values_supported-not_supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the AA metadata contain incorrect token_endpoint_auth_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",AA,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.token_endpoint_auth_signing_alg_values_supported.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-metadata-token_endpoint_auth_signing_alg_values_supported-supported,AA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim is 'one_of': ['RS256', 'RS512'], not compliant if it is empty or is missing",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the AA metadata contain correct token_endpoint_auth_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked to be 'one_of': ['RS256', 'RS512'].",AA,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.oauth_authorization_server.token_endpoint_auth_signing_alg_values_supported.one_of | [""RS256"", ""RS512""]",The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,ALL-Entity Configuration response-metadata-value,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if each key in metadata is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the metadata parameter contain only allowed types,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",ALL,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata | {""type"": ""object"",""anyOf"": [{""required"": [""openid_relying_party""]},{""required"": [""openid_provider""]},{""required"": [""federation_entity""]},{""required"": [""oauth_authorization_server""]},{""required"": [""oauth_resource""]}],""properties"": {""openid_relying_party"":{""type"":""object""},""openid_provider"":{""type"":""object""},""federation_entity"":{""type"":""object""},""oauth_authorization_server"":{""type"":""object""},""oauth_resource"":{""type"":""object""}}, ""additionalProperties"": false}","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,ALL-Entity Configuration response-metadata-openid_relying_party-once,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', not compliant otherwise",JWT parameter not in,Wrong Input,Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",ALL,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata | openid_relying_party.*(\n.*)+""openid_relying_party""","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,,,,P,passed,
x,ALL-Entity Configuration response-metadata-openid_provider-once,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', not compliant otherwise",JWT parameter not in,Wrong Input,Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",ALL,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata | openid_provider.*(\n.*)+""openid_provider""","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,,,,P,passed,
x,ALL-Entity Configuration response-metadata-federation_entity-once,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', not compliant otherwise",JWT parameter not in,Wrong Input,Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",ALL,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata | federation_entity.*(\n.*)+""federation_entity""","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,,,,P,passed,
x,ALL-Entity Configuration response-metadata-oauth_authorization_server-once,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', not compliant otherwise",JWT parameter not in,Wrong Input,Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",ALL,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata | oauth_authorization_server.*(\n.*)+""oauth_authorization_server""","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,,,,P,passed,
x,ALL-Entity Configuration response-metadata-oauth_resource-once,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', not compliant otherwise",JWT parameter not in,Wrong Input,Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",ALL,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata | oauth_resource.*(\n.*)+""oauth_resource""","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,,,,P,passed,
x,AA-Entity Configuration response-trust_marks,AA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the AA's entity configuration contain the trust_marks parameter,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.",AA,,Entity Configuration response | body | [^\r\n]* | payload | trust_marks,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
x,AA-Entity Configuration response-trust_marks-type,AA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks parameter present in the payload is a JSON array, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the AA's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the type of the trust_marks parameter is checked. It must be an array",AA,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""trust_marks"": {""type"": ""object"", ""additionalProperties"": {""type"": ""array""}}}, ""required"": [""trust_marks""]}",Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,AA non presente,not_applicable,
o,ALL-Entity Configuration response-correct-content-type,,Entity Configuration response,Entity Configuration request,"Compliant if the Content-Type of the response is application/entity-statement+jwt, not compliant otherwise",HTTP parameter value_1,Correct Input,Entity Configuration response,Does the entity return a correct Content-Type in the EC response,In this test a correct request to the entity's /.well-known/openid-federation endpoint is made and the response is analyzed. It must have a Content-Type parameter set to application/entity-statement+jwt,ALL,,Entity Configuration response | head | Content-Type | application/entity-statement+jwt,,SPID_CIE_OIDC#Entity-Configuration-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,,,,yes,s1,E,,P,P,passed,
o,ALL-Entity Configuration response-correct-http-code,,Entity Configuration response,Entity Configuration request,"Compliant if the response is an HTTP 200 OK, not compliant otherwise",HTTP Status,Correct Input,Entity Configuration response,Does the entity return a correct HTTP code in the EC response,In this test a correct request to the entity's /.well-known/openid-federation endpoint is made and the response is analyzed. It must be an HTTP 200 OK response,ALL,,Entity Configuration response | head | 200,,SPID_CIE_OIDC#Entity-Configuration-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html,OIDC Federation,Passive,L,Wrong handling of status code,,,,,,,,,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-exp,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the exp parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does entity configuration contain the exp parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked",ALL,,Entity Configuration response | body | [^\r\n]* | payload | exp,The exp parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-exp-type,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the exp parameter is timestamp, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does entity configuration contain a correct exp parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked",ALL,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""exp"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""exp""]}",The exp parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-exposed,/.well-known/openid-federation endpoint response,Entity Configuration Response,Trigger Entity Configuration response,"Compliant if the response is an HTTP 200 OK response, not compliant otherwise",HTTP Status,Correct Input,Entity Configuration response,Does the Entity expose the /.well-known/openid-federation endpoint,"In order to check the presence and correctness of the /.well-known/openid-federation endpoint, an HTTP GET request to the entity's endpoint is done and its entity configuration is expected as response.",ALL,,Entity Configuration response | head | 200,All the Entities MUST contain the /.well-known/openid-federation endpoint. It gives the Entity Configuration,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Wrong handling of status code,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-iat,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the iat parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does entity configuration contain the iat parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked",ALL,,Entity Configuration response | body | [^\r\n]* | payload | iat,The iat parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-iat-type,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the iat parameter is timestamp, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does entity configuration contain a correct iat parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked",ALL,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""iat"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""iat""]}",The iat parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-iss,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the iss parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does entity configuration contain the iss parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iss parameter is checked",ALL,,Entity Configuration response | body | [^\r\n]* | payload | iss,The iss parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-issue,Entity Configuration Response,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the response is the Entity Configuration of the entity, not compliant otherwise",HTTP parameter type,Correct Input,Entity Configuration response,Does the entity configuration of a considered entity return a Federation Metadata in JOSE format when an HTTP GET request is made to its .well-known/openid-federation endpoint,"The considered entity must have published its entity configuration in the .well-known/openid-federation endpoint. So in this test, an HTTP GET request is made to the entity's .well-known/openid-federation endpoint (appended to the URL which identifies the entity) and the response is analyzed. This response has to be the entity configuration of the entity and therefore a Federation Metadata in JOSE format (Content-Type: application/entity-statement+jwt)",ALL,,Entity Configuration response | body | ([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"An Entity Configuration (EC) is a Federation Metadata in Jose format, signed by its issuing subject and regarding itself, published at the web endpoint .well-known/openid-federation.",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,Passive,L,Type mismatch,,,,,,"1.1.1, 1.1.2",,TRUE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-jwks,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the jwks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does entity configuration contain the jwks parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the jwks parameter is checked",ALL,,Entity Configuration response | body | [^\r\n]* | payload | jwks,The jwks parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-metadata,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the metadata parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does entity configuration contain the metadata parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the metadata parameter is checked",ALL,,Entity Configuration response | body | [^\r\n]* | payload | metadata,The metadata parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-metadata-type,Entity's Entity Configuration's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if 'metadata' parameter is a JSON Object, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the metadata parameter contain a JSON Object,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object.",ALL,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""metadata"": {""type"": ""object""}}, ""required"": [""metadata""]}","Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,ALL-Entity Configuration response-sub,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the sub parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does entity configuration contain the sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the sub parameter is checked",ALL,,Entity Configuration response | body | [^\r\n]* | payload | sub,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-nbf-value,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the nbf claim set to the timestamp equal to the 'iat' parameter, not Compliant otherwise",/ not to do,Correct Input,Token response,Does the issued JWT ID Token contain the 'nbf' parameter in the Payload set to 'iat' value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'nbf' parameter in the Payload must be a timestamp equal to the 'iat' parameter",OP,,,The JWT ID Token Payload requires the nbf parameter and it has to be equal to iat,External: solo SPID | SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,,,,,,,,,,FALSE,x,,,,,,,,,
x,ALL-Resolve Entity Statement endpoint response-exposed,Resolve Entity Statement endpoint response,Resolve Entity Statement endpoint response,Trigger Resolve Entity Statement endpoint response,"Compliant if the Response contains a JWT, not compliant otherwise",HTTP parameter type,Correct Input,Resolve Entity Statement endpoint response,Does the Entity expose the resolve entity statement endpoint,"In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request containing the parameters 'sub', 'anchor' and 'type' is made to the entity's endpoint and an HTTP 200 OK response containing the resolved metadata for the entity in the request's sub claim is expected.",ALL,,"Resolve Entity Statement response | body | [\s*""[^""]*""(?:,\s*""[^""]*"")*\s*\]$","All the Entities MUST contain the resolve entity statement endpoint. It gives the final Metadata, the Trust Chain and the Trust Marks regarding another subject.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Manuali da definire per la prossima versione,N_A,N_A,not_applicable,Resolve Entity Statement response
x,OP-Authentication response-code-type,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri and adds the code parameter in the query parameters as a UUID, not compliant otherwise",HTTP parameter type,Correct Input,Authentication response,Does the OP contain the correct type of code parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter and it must be a UUID.",OP,,Authentication response | head | (?<=code=)[a-zA-Z0-9]+(?=&),If the authentication is successful the OpenID Provider (OP) redirects the user by adding code parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
o,OP-Authentication response-consent-page,Authentication response,Authentication response,Authentication request,"Compliant if the OP shows the consent page, not compiant otherwise",/ manual: check flow,Correct Input,Authentication response,Does the OP show the consent view,"In this test an authentication request is accomplished and, when the correct login credentials are inserted, the presence of the consent view shown to the user is checked. If it is not the case, the OP is not compliant",OP,,,"If the prompt parameter is set to consent login, the OP forces an authentication request to the user. Then it asks permission to transfer the claims. If the prompt parameter is set to consent, if a Single Sign On session is not yet active, the OP makes an Authentication Request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authentication-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Incorrect handling,,,,,,,,,,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-error,Authentication Error response,Authentication response,Trigger Authentication response,"Compliant if the Authentication Response contains the error parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Authentication response,Does the Authentication error response contain the error parameter,The Authentication error response is analyzed and the presence of the error parameter is checked,OP,,,"In case of errors, the response must contain the error and error_description parameters",SPID_CIE_OIDC#Authentication-Error-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#gestione-degli-errori,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-error_description,Autentication Error response,Authentication response,Trigger Authentication response,"Compliant if the Authentication Response has the error_description parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Authentication response,Does the Authentication error response contain the error_description parameter,The Authentication error response is analyzed and the presence of the error_description is checked,OP,,,"In case of errors, the response must contain the error and error_description parameters",SPID_CIE_OIDC#Authentication-Error-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#gestione-degli-errori,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-error-value,Authentication Error response,Authentication response,Trigger Authentication response,"Compliant if the Authentication Response has the error parameter and it is set to a value among 'invalid_request', 'unauthorized_client', 'access_denied', 'invalid_scope', 'server_error', 'temporarily_unavailable', 'unsupported_response_type', 'login_required', 'consent_required', 'request_uri_not_supported', 'registration_not_supported', or 'invalid_request_object'. Not Compliant otherwise",/ manual: wrong parameter,Correct Input,Authentication response,Does the Authentication error response contain a correct error parameter,"The Authentication error response is analyzed and error parameter in it is checked. It must have a value among 'invalid_request', 'unauthorized_client', 'access_denied', 'invalid_scope', 'server_error', 'temporarily_unavailable', 'unsupported_response_type', 'login_required', 'consent_required', 'request_uri_not_supported', 'registration_not_supported', or 'invalid_request_object'",OP,,"Authentication response | body | error | [""invalid_request"", ""unauthorized_client"", ""access_denied"", ""invalid_scope"", ""server_error"", ""temporarily_unavailable"", ""unsupported_response_type"", ""login_required"", ""consent_required"", ""request_uri_not_supported"", ""registration_not_supported"", ""invalid_request_object""]","In case of errors, the response must contain the error and error_description parameters",SPID_CIE_OIDC#Authentication-Error-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#gestione-degli-errori,OIDC Core,Active,M,Presence of wrong parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-get-with-query_string_serialization,Trigger Authentication Response to a Request done with the HTTP GET method and the Query String serialization method,Authentication Response to a Request done with the HTTP GET method and the Query String serialization method,Authentication Request done with the HTTP GET method and the Query String serialization method,"Client redirect to the redirect uri with correct query parameters (scope, code_challenge, code_challenge_method and request) insterted in the URL",/ manual: check flow,Correct Input,Authentication response,Does the OP accept GET requests and the Query String serialization method,"An authentication request is sent with the GET method and the parameters (scope, code_challenge, code_challenge_method and request) are set as query components of the request, using the application/x-www-form-urlencoded format",OP,,Authentication response | head | scope | code_challenge | code_challenge_method | request | request,"For conveying the request, the RP MAY use the methods POST and GET. With the method POST the parameters MUST be sent using the Form Serialization. With the method GET the parameters MUST be sent using the Query String Serialization. For more details see",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Incorrect handling,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-get-wrong-serialization,Authentication Response to a Request done with the HTTP GET method and a wrong serialization method,Authentication Response to a Request done with the HTTP GET method and a wrong serialization method,"Authentication Request done with the HTTP GET method and scope, code_challenge, code_challenge_method and request parameters inserted in the body of the request using the application/x-www-form-urlencoded format","Compliant if the Authentication response is HTTP 302 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Authentication response,Does the OP accept GET requests with a wrong serialization method,"An authentication request is sent with the GET method and the parameters (scope, code_challenge, code_challenge_method and request) are inserted in the body of the request, using the application/x-www-form-urlencoded format",OP,,,"For conveying the request, the RP MAY use the methods POST and GET. With the method GET the parameters MUST be sent using the Query String Serialization",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400
x,OP-Authentication response-JWT-aud-wrong-id,Authentication Response to a request without the OP's identifier in the aud parameter,Authentication Response to a request without the OP's identifier in the aud parameter,Authentication Request without the OP's identifier in the aud parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with an aud parameter that does not contain its identifier,The aud parameter identifies subjects of that request. An entity whose identifier is not in the audience of the request should refuse that request. In this test an authorization request is sent to the OP with an aud parameter in the JWT that does not contains its identifier and the response of the OP is analyzed,OP,Authentication request | url | request | payload | iss | https://www.example.com/ | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the aud parameter and it must contain the OP's identifier (issuer parameter in OP's metadata),SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-missing-client_id,Authentication Response to a request without the client_id parameter,Authentication Response to a request without the client_id parameter,Authentication request without the client_id parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the client_id parameter,"The 'client_id' parameter in an authentication request's JWT identifies the RP sending the request. In order to test if the OP checks this parameter, an authorization request is sent without the client_id in the JWT and the answer is analyzed",OP,Authentication request | url | request | payload | client_id |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the client_id parameter and its value must be an HTTPS URL identifying the RP,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Authentication request, no client id",,,,Check error code in the test (is changed),TRUE,x,,yes,s1,E,,P,P,passed,
o,OP-Authentication response-JWT-missing-code_challenge,Authentication Response to a request without the code_challenge parameter,Authentication Response to a request without the code_challenge parameter,Authentication Request without the code_challenge parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the code_challenge parameter,"The 'code_challenge' parameter in an authentication request is part of the PKCE protocol and is useful against various attacks. In order to test if the OP checks this parameter, an authorization request is sent without the client_id in the JWT and the answer is analyzed",OP,Authentication request | url | request | payload | code_challenge |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the code_challenge parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Does the server require PKCE (IsPkceRequired),,"Authentication request, no code_challenge",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-missing-code_challenge_method,Authentication Response to a request without the code_challenge_method parameter,Authentication Response to a request without the code_challenge_method parameter,Authentication Request without the code_challenge_method parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the code_challenge_method parameter,"The 'code_challenge_method' parameter in an authentication request says to the OP how to verify the code_challenge when receiving the token request. If one request has a wrong code_challenge_method, than the OP will not be able to verify this parameter. In order to test the OP's behavior, an Authenticaton request is sent without code_challenge_method and the answer is analyzed",OP,Authentication request | url | request | payload | code_challenge_method |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the code_challenge_method parameter and its value must be in the code_challenge_methods_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is PKCE implemented (IsPkceImplemented),,"Authentication request, no code_challenge_method",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-missing-nonce,Authentication Response to a request without the nonce parameter,Authentication Response to a request without the nonce parameter,Authentication request without the nonce parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the nonce parameter,"If the nonce in the request is missing, than a control about the freshness of the request/response is missing. In this test an authorization request without the nonce parameter in the JWT is sent and the response analyzed.",OP,Authentication request | url | request | payload | nonce |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the nonce parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is the nonce parameter required (NonceRequired),,"Auth request, no nonce",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-jwt-missing-scope,Authentication Response to a request without the scope parameter,Authentication Response to a request without the scope parameter,Authentication Request without the scope parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the scope parameter,An Authentication Request is sent without the scope parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | scope |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the scope parameter and its value must be contained in the scopes_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-missing-state,Authentication Response to a request without the state parameter,Authentication Response to a request without the state parameter,Authentication request without the state parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the state parameter,"The state parameter identifies the session in the RP side, if this value is missing, than no control about the session is done. In this test an authorization request without the state parameter in the JWT is sent and the response analyzed.",OP,Authentication request | url | request | payload | state |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the state parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no state",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-require-pkce,Authentication Response to a Request without the code_challenge and code_challenge_method parameter in the request,Authentication Response to a Request without the code_challenge and code_challenge_method parameter in the request,Authentication Request without the code_challenge and code_challenge_method parameter in the request,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Authentication response,Does the OP require PKCE,"An authentication request with empty code_challenge and code_challenge_method parameter is sent and the response analyzed. If the OP accepts the request, than plain PKCE is accepted and a protection against attacks like CSRF and authorization code injection attacks is missing",OP,,,The JWT payload must contain the code_challenge parameter. The JWT payload must contain the code_challenge_method parameter and its value must be in the code_challenge_methods_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.","Does the server require PKCE (IsPkceRequired), Does the server support plain PKCE (PlainPkce)",,"authentication request, no correct code_challenge_method",,,,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-acr_values,Authentication Response to a request with wrong acr_values parameter,Authentication Response to a request with wrong acr_values parameter,Authentication Request with wrong acr_values parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a value of the acr_values parameter wrong or not present in its metadata,In this test an authorization request is sent with a acr_values parameter wrongly set in the JWT and the response is analyzed,OP,Authentication request | url | request | payload | acr_values | example | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the acr_values parameter and its value must be contained in the acr_values_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no correct acr_values",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
o,OP-Authentication response-JWT-wrong-claims,Authentication Response to a request with wrong claims parameter,Authentication Response to a request with wrong claims parameter,Authentication Request with a wrong claims parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a wrong claims parameter,In this test an authorization request is sent with a claims parameter in the JWT which contains not supported values and the response is analyzed,OP,Authentication request | url | request | payload | claims | example | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the claims parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Authentication request, no correct claims",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-code_chalenge_mehod,Authentication Response to a request with wrong code_challenge_method parameter,Authentication Response to a request with wrong code_challenge_method parameter,Authentication Request with wrong code_challenge_method parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a value of the code_challenge_method parameter wrong or not present in its metadata,"The 'code_challenge_method' parameter in the JWT of an authentication request says to the OP how to verify the code_challenge when receiving the token request. If one request has a wrong code_challenge_method, than the OP will not be able to verify this parameter. In order to test the OP's behavior, an Authenticaton request is sent with a wrong code_challenge_method (a method not present in the OP's metadata) and the answer is analyzed",OP,Authentication request | url | request | payload | code_challenge_method | example | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the code_challenge_method parameter and its value must be in the code_challenge_methods_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
o,OP-Authentication response-JWT-wrong-code_challenge,Authentication Response to a request with wrong code_challenge parameter,Authentication Response to a request with wrong code_challenge parameter,Authentication Request with wrong code_challenge parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with wrong code_challenge parameter,"The 'code_challenge' parameter in an authentication request is part of the PKCE protocol and is useful against various attacks. In order to test if the OP checks this parameter, an authorization request is sent with wrong code_challenge in the JWT and the answer is analyzed",OP,Authentication request | url | request | payload | code_challenge | example | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the code_challenge parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Does the server require PKCE (IsPkceRequired),,"Authentication request, no code_challenge",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-exp,Authentication Response to a request with wrong exp parameter,Authentication Response to a request with wrong exp parameter,Authentication Request with wrong exp parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a wrong exp parameter,In this test an authorization request with the exp parameter expired in the JWT is sent and the response analyzed.,OP,Authentication request | url | request | payload | exp | 1681723540 | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the exp parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is JWT expiration checked (IsExpirationChecked),,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
openid e exp expired nella
login",,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-iat,Authentication Response to a request with wrong iat parameter,Authentication Response to a request with wrong iat parameter,Authentication Request with wrong iat parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a wrong iat parameter,In this test an authorization request with the iat parameter in the JWT set after the current time is sent and the response analyzed.,OP,Authentication request | url | request | payload | iat | 1681723540 | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the iat parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-nonce,Authentication Response to a request with a nonce parameter shorter than 32 alphanumeric characters,Authentication Response to a request with a nonce parameter shorter than 32 alphanumeric characters,Authentication Request with a nonce parameter shorter than 32 alphanumeric characters in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a nonce parameter shorter than 32 alphanumeric characters,In this test an authorization request with a nonce parameter in the JWT of a length less than 32 alphanumeric characters is sent and the response analyzed.,OP,Authentication request | url | request | payload | nonce | 19az | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the nonce parameter. It must be a casual string with at least 32 alphanumeric characters.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no correct nonce",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-prompt,Authentication Response to a request with wrong prompt parameter,Authentication Response to a request with wrong prompt parameter,Authentication Request with a wrong prompt parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a wrong prompt parameter,An Authenticaton request is sent with a wrong prompt parameter in the JWT (a value different from 'consent' and 'consent login') and the answer is analyzed,OP,Authentication request | url | request | payload | prompt | example | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the prompt parameter and its value must be 'consent' or 'consent login',SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no correct prompt",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-JWT-wrong-response_type,Authentication Response to a request with wrong response_type parameter,Authentication Response to a request with wrong response_type parameter,Authentication Request with wrong response_type parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of unsupported_response_type, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a value of the response_type parameter wrong or not present in its metadata,"An Authentication Request is sent with a response_type parameter in the JWT wrong or not present in the RP's metadata. If the OP refuses the request, than it checks the parameter, otherwise it is not checking it.",OP,Authentication request | url | request | payload | response_type | example | X_key_RP,Authentication error response | head | 302 | head | unsupported_response_type,The JWT payload must contain the response_type parameter and its value must be contained in the response_types_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Does the authorization server check the response type (IsResponseTypeChecked),,"Auth request, no correct response_type",,,,,TRUE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 302 invalid_request
x,OP-Authentication response-JWT-wrong-scope,Authentication Response to a request with wrong scope parameter,Authentication Response to a request with wrong scope parameter,Authentication Request with wrong scope parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_scope, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a value of the scope parameter wrong or not present in its metadata,"The scope parameter is used by the OP to check which claims to send in the ID Token and/or at the Introspection endpoint. The allowed values are openid, offline_access, profile and email (and combination of them), different values must trigger an error response. So in this test a request with a wrong scope parameter in the JWT is sent and the response analyzed",OP,Authentication request | url | request | payload | scope | example | X_key_RP,Authentication error response | head | 302 | head | invalid_scope,The JWT payload must contain the scope parameter and its value must be contained in the scopes_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 302 invalid_request
x,OP-Authentication response-JWT-wrong-state,Authentication Response to a request with a state parameter shorter than 32 alphanumeric characters,Authentication Response to a request with a state parameter shorter than 32 alphanumeric characters,Authentication Request with a state parameter shorter than 32 alphanumeric characters in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a state parameter shorter than 32 alphanumeric characters,In this test an authorization request with a state parameter in the JWT of a length less than 32 alphanumeric characters is sent and the response analyzed.,OP,Authentication request | url | request | payload | state | 19az | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the state parameter. It must be a casual string with at least 32 alphanumeric characters.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no correct state",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-acr_values,Authentication Response to a request without the acr_values parameter,Authentication Response to a request without the acr_values parameter,Authentication Request without the acr_values parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the acr_values parameter,An Authentication Request is sent without the acr_values parameter in JWT and the response analyzed.,OP,Authentication request | url | request | payload | acr_values |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the acr_values parameter and its value must be contained in the acr_values_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no acr_values",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-aud,Authentication Response to a request without the aud parameter,Authentication Response to a request without the aud parameter,Authentication Request without the aud parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the aud parameter,The aud parameter identifies subjects of that request. An entity whose identifier is not in the audience of the request should refuse that request. In this test an authorization request is sent to the OP with an aud parameter that does not contains its identifier and the response of the OP is analyzed,OP,Authentication request | url | request | payload | aud |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the aud parameter and it must contain the OP's identifier (issuer parameter in OP's metadata),SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is JWT audience checked (HasAudienceClaim),,,,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-claims,Authentication Response to a request without the claims parameter,Authentication Response to a request without the claims parameter,Authentication Request without the claims parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the claims parameter,An Authentication Request is sent without the claims parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | claims |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the claims parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-exp,Authentication Response to a request without the exp parameter,Authentication Response to a request without the exp parameter,Authentication Request without the exp parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the exp parameter,An Authentication Request is sent without the exp parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | exp |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the exp parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
openid e exp assente
nella login",,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-iat,Authentication Response to a request without the iat parameter,Authentication Response to a request without the iat parameter,Authentication Request without the iat parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the iat parameter,An Authentication Request is sent without the iat parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | iat |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the iat parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is JWT 'issued at' checked (IsIssuedAtChecked),,,,,,,TRUE,x,,yes,s1,E,,P,P,passed,
o,OP-Token response-pragma-value,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has Pragma set to 'no-cache', not Compliant otherwise",/ external,Correct Input,Token response,Does the token response have Pragma set to 'no-cache',This test verifies the presence of Pragma set to 'no-cache' in the token response.,OP,,,The error Token response must have Pragma set to 'no-cache',External,OIDC Core,Active,,,,,,,,,,TRUE,x,,,,,,,Manca parametro Pragma,,
x,OP-Authentication response-missing-iss,Authentication Response to a request without the iss parameter,Authentication Response to a request without the iss parameter,Authentication Request without the iss parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the iss parameter,An Authentication Request is sent without the iss parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | iss |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is JWT issuer checked (HasIssuerClaim),,,,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-prompt,Authentication Response to a request without the prompt parameter,Authentication Response to a request without the prompt parameter,Authentication Request without the prompt parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the prompt parameter,An Authenticaton request is sent without the prompt parameter in the JWT and the response is analyzed,OP,Authentication request | url | request | payload | prompt |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the prompt parameter and its value must be 'consent' or 'consent login',SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no prompt",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-redirect_uri,Authentication Response to a request without the redirect_uri parameter,Authentication Response to a request without the redirect_uri parameter,Authentication Request without the redirect_uri parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the redirect_uri parameter,An Authentication Request is sent without the redirect_uri parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | redirect_uri |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the redirect_uri parameter and its value must be contained in the redirect_uris parameter of the RP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,Reject request without redirect_uri when multiple registered,"Auth request, no redirect_uri",,,,I heard that sometimes it is not always checked because the address in the RP metadata is checked,TRUE,x,,yes,s1,E,,P,P,passed,
o,OP-Authentication response-missing-response_type,Authentication Response to a request without the response_type parameter,Authentication Response to a request without the response_type parameter,Authentication Request without the response_type parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the response_type parameter,An Authentication Request is sent without the response_type parameter in JWT and the response is analyzed,OP,Authentication request | url | request | payload | response_type |  | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the response_type parameter and its value must be contained in the response_types_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,Reject request without response_type,"Auth request, no response_type",,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-missing-signature,Authentication Response to a request with a request parameter being a JWT without signature,Authentication Response to a request with a request parameter being a JWT without signature,Authentication Request with the request parameter in the url being a JWT without signature,"Compliant if the Authentication response is HTTP 302 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the signature of the JWT,"This test aims to verify if the OP checks the presence of the signature in an authentication request's JWT. In particular, since the JWT is composed by three parts (header, payload and signature), an Authentication Request is sent with a JWT without the last part of it, the signature.",OP,Authentication request | url | (?<=request=\\S{90}\\.\\S{1199})\\S* | ,Authentication response | head | 302 | url | invalid_request,"The Authorization request is initiated by the user that selects the OP for the authentication. The RP redirects the user to the Authorization Endpoint of the selected OP, including in the request the parameter request that is a signed JWT containing the Authorization Request.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is a JWT signature required (IsSignatureRequired),Support request request parameter iwht unsecured request,,T1_m,,,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[PRIMA] Ritorna 403 - [ADESSO] Ritorna 302 senza invalid_request
x,OP-Authentication response-non-asymmetric-signature_no-sign-after-edit,Authentication Response to a request with a request parameter signed with a symmetric algorithm,Authentication Response to a request with a request parameter signed with a symmetric algorithm,Authentication Request with a request parameter signed with a symmetric algorithm,"Compliant if the Authentication response is an HTTP 302 because of unauthorized_client, not compliant otherwise",nested JWT edit,Wrong Input,Authentication response,Does the OP refuse Authentication Requests signed with a non-asymmetric method,"This test aims to check if the OP correctly handles the signature of the Authentication request: If the OP is not able to decrypt the signature, than the public key of the RP is wrong or, otherwise, the algorithm used is not known. If, instead, the OP is able to decrypt the signature, it can mean that the public key is correct and the algorithm known, or that the RP used a symmetric algorithm and the RP's key is the same key used to sign the JWT. In the latter case the confidentiality and integrity of the message cannot be trusted. In this case, the OP must check the 'alg' parameter in the JWT Header and, if it corresponds to a symmetric algorithm or to 'none', it must refuse the authentication request. In order to accomplish this test, a crafted RP could set in its metadata a symmetric key, use it to sign the JWT and send an Authentication Request. Another way to accomplish the test is by intercepting the request, changing the parameter and the signature.",OP,Authentication request | url | request | header | alg | none,Authentication error response | head | 302 | head | invalid_request,"The JWT Header of the request parameter in the Authentication Request must contain the 'alg' parameter, it must be set to one of the supported values for the OP metadata and must not be 'none' or a symmetric algorithm (MAC).",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,T1_i,,,Check the error response code in MIG,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-post-form_serialization,Authentication Response to a Request done with the HTTP POST method and the Form serialization method,Authentication Response to a Request done with the HTTP POST method and the Form serialization method,Authentication Request done with the HTTP POST method and the Form serialization method,"Client redirect to the redirect uri with correct query parameters (scope, code_challenge, code_challenge_method and request) inserted in the URL",/ manual: check POST,Correct Input,Authentication response,Does the OP accept POST requests and the Form serialization method,"An authentication request is sent with the POST method and the parameters (scope, code_challenge, code_challenge_method and request) are inserted in the body of the request, using the application/x-www-form-urlencoded format",OP,,Authentication response | head | scope | code_challenge | code_challenge_method | request | request,"For conveying the request, the RP MAY use the methods POST and GET. With the method POST the parameters MUST be sent using the Form Serialization. With the method GET the parameters MUST be sent using the Query String Serialization. For more details see",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,Incorrect handling,,,,,,,,FALSE,x,,no,s1_login,E,Problema implementazione,F,F,failed,"The OP accept the POST, but it returns a 403 error when the user prompt its credentials"
x,OP-Authentication response-post-wrong-serialization,Authentication Response to a Request done with the HTTP POST method and a wrong serialization method,Authentication Response to a Request done with the HTTP POST method and a wrong serialization method,"Authentication Request done with the HTTP POST method and scope, code_challenge, code_challenge_method and request parameters set as query components of the request, using the application/x-www-form-urlencoded format","Compliant if the Authentication response is HTTP 302 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Authentication response,Does the OP accept POST requests with a wrong serialization method,"An authentication request is sent with the POST method and the parameters (scope, code_challenge, code_challenge_method and request) are set as query components of the request, using the application/x-www-form-urlencoded format",OP,,,"For conveying the request, the RP MAY use the methods POST and GET. With the method POST the parameters MUST be sent using the Form Serialization",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Authentication response-prompt-consent_login-new-request,Authentication request with prompt parameter set to consent login,Authentication response to a request with prompt parameter set to consent login,Authentication request with prompt parameter set to consent login,"Compliant if the OP shows a login page to the client, not compliant otherwise",/ manual: check flow,Correct Input,Authentication response,Does the OP correctly handle the prompt parameter set to 'consent login' in the case of a new request,"In the case of the prompt parameter set to 'consent login' in an authentication request, the OP should send an authentication request to the user in any case. In order to verify this behavior, a fresh authentication request is accomplished and the action of the OP verified.",OP,,,In case of a prompt parameter set to consent login in an authentication request: The OP forces an authentication request to the user. Then it asks permission to transfer the claims.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Incorrect handling,,,,,,,JWT Response (correct check-yes) but must build custom control of output (login page),FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-prompt-consent_login-SSO,Authentication request with prompt parameter set to consent login,Authentication response to a request with prompt parameter set to consent login and SSO session active,Authentication request with prompt parameter set to consent login and SSO session active,"Compliant if the OP shows a login page to the client, not compliant otherwise",/ manual: check flow,Correct Input,Authentication response,Does the OP correctly handles the prompt parameter set to 'consent login' in the case of SSO,"In the case of the prompt parameter set to 'consent login' in an authentication request, the OP should send an authentication request to the user in any case. In order to verify this behavior, an authentication request while a SSO session is active is accomplished and the action of the OP verified. It should show a login page and ask for the credentials.",OP,,,In case of a prompt parameter set to consent login in an authentication request: The OP forces an authentication request to the user. Then it asks permission to transfer the claims.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,Incorrect handling,,,,,,,,FALSE,x,,no,s1_SSO,E,,P,P,passed,
x,OP-Authentication response-prompt-consent-new-request,Authentication request with prompt parameter set to consent,Authentication response to a request with prompt parameter set to consent,Authentication request with prompt parameter set to consent,"Compliant if the OP shows a login page to the client, not compliant otherwise",/ manual: check flow,Correct Input,Authentication response,Does the OP correctly handle the prompt parameter set to 'consent' in the case of a new request,"In the case of the prompt parameter set to 'consent' in an authentication request, the OP should send an authentication request to the user in any case. In order to verify this behavior, an authentication request while a SSO session is active is accomplished and the action of the OP verified. It should show a login page and ask for the credentials.",OP,,,"In case of a prompt parameter set to consent in an authentication request, if a Single Sign On session is not yet active, the OP makes an Authentication Request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,Incorrect handling,,,,,,,JWT Response (correct check-yes) but must build custom control of output (login page),FALSE,x,,yes,s1_SSO,E,,P,P,passed,
x,OP-Authentication response-redirect-code,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri and adds the code parameter in the query parameters, not compliant otherwise",HTTP parameter presence_1,Correct Input,Authentication response,Does the OP correctly contain the code parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter",OP,,Authentication response | head | Location | code,If the authentication is successful the OpenID Provider (OP) redirects the user by adding code parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,Is at least one grant type supported (HasSupportedFlows),Can make request with code response_type,,P2_a,"Verifica tecnica della
response del
Authentication Endpoint",,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-redirect-iss,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri and adds the iss parameter in the query parameters, not compliant otherwise",HTTP parameter presence_1,Correct Input,Authentication response,Does the OP contain iss parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter",OP,,Authentication response | head | Location | iss,If the authentication is successful the OpenID Provider (OP) redirects the user by adding iss parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,P2_c,"Verifica tecnica della
response del
Authentication Endpoint",,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Authentication response-redirect-iss-value,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri with the iss parameter set to the correct OP's identifier, not compliant otherwise",/ manual: check parameter,Correct Input,Authentication response,Does the OP contain iss set to the its identifier on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter set to the OP's identifier",OP,,,If the authentication is successful the OpenID Provider (OP) redirects the user by adding iss parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Presence of wrong parameter,,,,P2_c,"Verifica tecnica della
response del
Authentication Endpoint",,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-redirect-state,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri and contains the state parameter in the query parameters, not compliant otherwise",HTTP parameter presence_1,Correct Input,Authentication response,Does the OP contain correct state parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter",OP,,Authentication response | head | Location | state,If the authentication is successful the OpenID Provider (OP) redirects the user by adding state parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Authentication response-redirect-state-value,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri and the value of the state parameter in the query parameters corresponds to the state parameter sent in the request, not compliant otherwise",/ manual: wrong value,Correct Input,Authentication response,Does the OP contain correct state parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter. This parameter must have the same value of the 'state' parameter sent in the payload of the request parameter in the Authentication request",OP,Authentication request | url | request | payload | state,Authentication response | url | state | state,If the authentication is successful the OpenID Provider (OP) redirects the user by adding state parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Mismatch of content,Is the state parameter present in the authorization response (StatePresent),OAuth state request value returned in response,,"P2_d, P2_b","Verifica tecnica della
response del
Authentication Endpoint","2.4.2, 2.4.3",,TRUE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication response-correct-state-value,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the RP interrupts the flow, not compliant otherwise",HTTP wrong value,Wrong Input,Authentication response,Does the RP checks that the state parameter in an authentication response is the same of the authentication request,"In order to check if the RP correctly handles an authentication response, an incorrect response is sent and the behavior of the RP is analyzed. In particular, theflow should be interrupted if the value of the 'state' parameter in the Authentication response does not correspond to the one of the Authentication request.",RP,,Authentication response | head | (?<=state=)[^&]+ | incorrect_value_of_state,If the state parameter in the authentication response does not correspond to the one of the request the flow should be interrupted,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Mismatch of content,Is the state parameter present in the authorization response (StatePresent),OAuth state request value returned in response,,"P2_d, P2_b","Verifica tecnica della
response del
Authentication Endpoint","2.4.2, 2.4.3",,TRUE,x,,no,s1,E,,,P,passed,
x,OP-Authentication response-redirect-uri,Client redirection,Authentication response,Trigger Authentication response,"Compliant if the OP redirects the client to the redirect_uri, not compliant otherwise",/ manual: check flow,Correct Input,Authentication response,Does the OP correctly redirects the client,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri.",OP,Authentication request | url | request | payload | redirect_uri,Authentication response | url | redirect_uri,If the authentication is successful the OpenID Provider (OP) redirects the user to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Passive,M,Incorrect handling,Is at least one grant type supported (HasSupportedFlows),Can make request with code response_type,,P2_a,"Verifica tecnica della
response del
Authentication Endpoint",,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-require-trust-marks,OP's Authentication response,Authentication response,Entity Configuration response with trust marks not trusted,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse an RP without trusted Trust Marks,"In this test the RP sends an authentication request to the OP, which will ask for the RP's Entity Configuration. The RP must send an Entity Configuration without trusted Trust Marks (Trust Marks issued by an entity not present in the Federation Configuration or no Trust Marks) and if the OP's response is analyzed",OP,Entity Configuration response RP | body | [^\r\n]* | payload | trust_marks |  | X_key_RP,Authentication response | head | 302 | head | invalid_request,"If the RP configuration does not expose any Trust Mark that is recognizable by the RP profile, the Provider MUST refuse the authorization with an error message",SPID_CIE_OIDC#Metadata-Retrieval-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#openid-provider,OIDC Federation,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Ritorna 302 without invalid_request - NON INTERROMPE
o,OP-Authentication response-scope-different-URL-JWT,Authentication Response to a request without the scope parameter in the URL,Authentication Response to a request without the scope parameter in the URL,Authentication Request with the scope parameter in the URL that differs from the one in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with the scope parameter different in the URL and in the JWT,The Authentication Request is intercepted and the scope parameter in the URL is modified to a valid value but different from the scope parameter in the JWT payload that can be found in the request query parameter. The same parameter in the JWT's payload is left unchanged.,OP,Authentication request | url | scope | openid,Authentication error response | head | 302 | head | invalid_request,"The parameter scope MUST be sent both as a parameter in the HTTP request, and inside the request object. The two values MUST be the same.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Auth request, no correct scope",T1_e,"Accesso L2 con protocollo
OIDC e scope valorizzato
opeind e NONESISTE.
Verifica degli attributi
dell'User Info, lo scope
NONESISTE viene
ignorato.",,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200
x,OP-Authentication response-url-missing-request,Authentication Response to a request without the request parameter,Authentication Response to a request without the request parameter,Authentication Request without the request parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the request parameter,"The 'request' parameter in an authentication request is crucial to authenticate and answer correctly. If a request is missing the request parameter, than the OP should refuse it. In order to test the OP's behavior, an Authenticaton request is sent without request parameter in the URL and the answer is analyzed",OP,Authentication request | url | request | ,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the request parameter and its value must a JWT,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400
x,OP-Authentication response-URL-missing-scope,Authentication Response to a request without the scope parameter in the URL,Authentication Response to a request without the scope parameter in the URL,Authentication Request without the scope parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests without the scope parameter in the URL,An Authentication Request is sent without the scope parameter in the URL of the request (scope in the HTTP request),OP,Authentication request | url | scope | ,Authentication error response | head | 302 | head | invalid_request,"The parameter scope MUST be sent both as a parameter in the HTTP request, and inside the request object. The two values MUST be the same.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,Scope openid present in all requests,"Auth request, no scope",T1_f,,,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200
x,OP-Authentication response-url-wrong-request,Authentication Response to a request with the request parameter that is not a JWT,Authentication Response to a request with the request parameter that is not a JWT,Authentication Request with a request parameter in the URL that is not a JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with the request parameter that is not a JWT,"The 'request' parameter in an authentication request is crucial to authenticate and answer correctly. If a request has a request parameter, that is not a JWT, it means that the OP should refuse it. In order to test the OP's behavior, an Authenticaton request is sent with a random value in the request parameter in the URL and the answer is analyzed",OP,Authentication request | url | request | example,Authentication error response | head | 302 | head | invalid_request,The JWT payload must contain the request parameter and its value must a JWT,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 500
x,OP-Authentication response-wrong-acr_level-credentials,Authentication response,Authentication response,"Authentication request with prompt set to ""consent login""","Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Authentication response,Does the OP refuse credentials not allowed for that acr level,"In this test an authentication request with prompt sent to 'consent login' is accomplished and, when the user credentials are requested, credentials not authorized for that acr level are inserted. The response is then analyzed",OP,Authentication request | url | request | payload | prompt | consent login | X_key_RP,Authentication response | head | 302 | Authentication response | head | invalid_request,"If the prompt parameter is set to consent login, the OP forces an authentication request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authentication-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,,,,no,s1,E,Problema implementazione,N_A,N_A,not_applicable,Non disponibili credenziali che non hanno accesso a un livello diverso
o,OP-Authentication response-wrong-authority_hints,Authentication response,Authentication response,Entity Configuration response with wrong authority hints,"Compliant if the Authentication response is an HTTP 302 error and because of invalid_client, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP correctly validate the trust chain of an RP authentication request,"When an OP receives an authentication request, it must proceed with an Entity Configuration request toward the RP. The received Entity Configuration must be verified through the Entity Statement released by a parent entity of the RP and this process must be repeated until the Trust Anchor. In order to verify if the OP validates this trust chain, the authority_hints in the Entity Configuration of the RP could contain wrong values. If the OP validates the request anyway, it is not compliant with the specification",OP,Entity Configuration response RP | body | [^\r\n]* | payload | authority_hints | https://www.wrongsite.com/ | X_key_RP,Authentication response | head | 302 | head | invalid_client,"If the Provider successfully validates at least a Trust Mark for the RP profile contained inside the configuration of the requesting RP, it extracts the superior Entities from the claim authority_hints and starts the Federation Entity Discovery process until the Trust Chain calculation and the achievement of the final Metadata.",SPID_CIE_OIDC#Metadata-Retrieval-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#openid-provider,OIDC Federation,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 302 invalid_request
x,OP-Authentication response-wrong-client_id,Authentication Request's request parameter,Authentication Request's request parameter,Authentication Request with a wrong client_id parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP correctly reject an invalid client_id parameter in an intercepted Authentication Request,"This test aims to check if the OP checks the correctness of the client_id parameter. The client id value contained must contain an URL identifying the RP, so in this test the Authentication Request is intercepted, the request parameter is decrypted, the client_id in it modified with a random (and invalid) one, the JWT re-encrypted, the signature re-calculated and sent. The OP should check the parameter and, seen that it is an invalid one, refuse the authentication request.",OP,Authentication request | url | request | payload | client_id | https://www.example.com/ | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT content of the request parameter in the Authentication Request must contain the 'client_id' parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,T1_h,,,Not clear what the the client_id in the request must match and if it has to match something,TRUE,x,,yes,s1,E,,P,P,passed,
o,OP-Authentication response-wrong-iss,Authentication Response to a request with wrong iss parameter,Authentication Response to a request with wrong iss parameter,Authentication Request with a wrong iss parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Requests with a wrong iss parameter,"The 'iss' parameter in the JWT of an authentication request says who sent the request. If one request has a wrong iss, than it could be forwarded by a malicious user, so the iss must be checked. In order to test this behavior in the OP, an Authenticaton request is sent with a wrong iss (not the RP's client id) and the answer is analyzed",OP,Authentication request | url | request | payload | iss | https://www.example.com/ | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-wrong-redirect-uri,Authentication Request's request parameter,Authentication Request's request parameter,Authentication Request with a wrong redirect_uri parameter in the JWT in the request parameter,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Authentication response,Does the OP refuse Authentication Request with a wrong redirect URI,"Once received an Authentication Request, an OP must check if the provided redirect URI matches one of the redirect uris in the RP metadata. To verify this behavior, an authentication request is sent to the OP with a wrong redirect URI in the JWT in the request parameter ",OP,Authentication request | url | request | payload | redirect_uri | https://www.example.com/ | X_key_RP,Authentication error response | head | 302 | head | invalid_request,The redirect_uri parameter in the Authentication Request must match one of the URLs given in the RP Metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.","Does the authorization server automatically redirect the user-agent to the invalid redirection URI (InvalidRedirect), Does the authorization server exactly match the full redirect uri (RedirectUriFullyMatched)","Reject redirect_uri not matching a registered redirect_uri, Reject redirect_uri when query parameter added, Reject redirect_uri when query parameter does not match",,,,,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Authentication response-wrong-signature,Authentication Response to a request with the request parameter with a wrong signature,Authentication Response to a request with the request parameter with a wrong signature,Authentication Request with the request parameter with a wrong signature in the URL,"Compliant if the Authentication response is an HTTP 302 because of unauthorized_client, not compliant otherwise",Signature JWT Response,Wrong Input,Authentication response,Does the OP refuse wrongly signed Authentication Requests,"This test aims to check if the OP correctly handles the signature of the Authentication request: once received the request, the JWT token must be split in its 3 parts (header, payload, signature), base64url decoded and the signature must be verified. In order to test if the OP really checks the signature, the Authentication request is intercepted before arriving to the OP and the signature is changed. If the OP grants the tokens anyway, than it did not check the signature.",OP,Authentication request | url | request | X_wrong_key,Authentication error response | head | 302 | head | unauthorized_client,"The Authorization request is initiated by the user that selects the OP for the authentication. The RP redirects the user to the Authorization Endpoint of the selected OP, including in the request the parameter request that is a signed JWT containing the Authorization Request.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,L,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,Is the JWT signature checked (IsSignatureChecked),,,T1_G,,,,TRUE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 302 invalid_request
x,OP-Authentication response-wrong-user-credentials,Authentication response,Authentication response,"Authentication request with prompt set to ""consent login""","Compliant if the Authentication response is an HTTP 302 because access_denied, not compliant otherwise",/ manual: check flow,Wrong Input,Authentication response,Does the OP refuse wrong credentials,"In this test an authentication request with prompt set to 'consent login' is accomplished and, when the user credentials are requested, wrong ones are inserted. The response is then analyzed",OP,,,L’OP ha negato l’accesso a causa di credenziali non valide o non adeguate al livello SPID richiesto,SPID_CIE_OIDC#Authentication-Endpoint; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#codici-di-errore,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,,,,yes,s_CIE_wrong_credentials,E,Problema implementazione,F,F,failed,Ritorna 200
x,ALL-Entity Configuration response-signature,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the signature is correct, not compliant otherwise",JWT signature check,Correct Input,Entity Configuration response,Does the entity correctly sign the Entity Configuration,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header",ALL,,Entity Configuration response | body | [^\r\n]* | X_key_ALL,Entity Configurations must be signed,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,"JOSE format can be JWS or JWE, we assume it to be JWS in this case",FALSE,,,yes,s1,E,,P,P,passed - failed for TA,[TA] Signature non corretta
x,ALL-Entity Configuration response-sub-value,Entity's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the sub parameter is equal to the iss claim, not compliant otherwise",JWT parameter values,Correct Input,Entity Configuration response,Does entity configuration OP contain a correct sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter",ALL,,Entity Configuration response | body | [^\r\n]* | payload | sub | X_url_ALL,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-authority_hints,OP's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authority_hints parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the OP's entity configuration contain the authority_hints parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the authority_hints parameter is checked",OP,,Entity Configuration response | body | [^\r\n]* | payload | authority_hints,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-authority_hints-type,OP's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authority_hints parameter is present and is an array of URLs, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the OP's entity configuration contain a correct authority_hints parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the authority_hints parameter is checked, it must be an array",OP,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""authority_hints"": {""type"": ""array""}}, ""required"": [""authority_hints""]}",Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-jwks,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'jwks' parameter in the OP metadata ('openid_provider' type) is present,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the jwks claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'jwks' parameter in the 'openid_provider' subclaim (metadata type) is checked,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.jwks,The OP metadata of type 'openid_provider' must contain the parameter 'jwks' or the parameter 'signed_jwks_uri',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.8, 1.3.9","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-acr_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the acr_values_supported ('openid_provider' type) parameter in the OP metadata is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the acr_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.acr_values_supported,"The OP metadata of type 'openid_provider' must contain the parameter 'acr_values_supported' and it must be set to [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.12, 1.3.13","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-acr_values_supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the acr_values_supported ('openid_provider' type) parameter in the OP metadata is [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct acr_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked to be [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.acr_values_supported[0] | [""https://www.spid.gov.it/SpidL1"", ""https://www.spid.gov.it/SpidL2"", ""https://www.spid.gov.it/SpidL3""]","The OP metadata of type 'openid_provider' must contain the parameter 'acr_values_supported' and it must be set to [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.12, 1.3.13","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-authorization_endpoint,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authorization_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the authorization_endpoint parameter,In this test the OP metadata are taken and the presence of the 'authorization_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.authorization_endpoint,The OP metadata of type 'openid_provider' must contain the parameter 'authorization_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,Config has authorization_endpoint,,,,1.3.3,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-authorization_response_iss_parameter_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authorization_response_iss_parameter_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the authorization_response_iss_parameter_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the authorization_response_iss_parameter_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.authorization_response_iss_parameter_supported,The OP Metadata of type 'openid_provider' MUST contain authorization_response_iss_parameter_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,,F,failed,Missing authorization_response_iss_parameter_supported
x,OP-Entity Configuration response-metadata-authorization_response_iss_parameter_supported-value,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the authorization_response_iss_parameter_supported claim has value true, not compliant if it is empty or is missing",JWT parameter values,Correct Input,Entity Configuration response,Does the OP metadata contain the correct value of authorization_response_iss_parameter_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the authorization_response_iss_parameter_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.authorization_response_iss_parameter_supported.value | true,The OP Metadata of type 'openid_provider' MUST contain authorization_response_iss_parameter_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,,F,failed,Missing authorization_response_iss_parameter_supported
x,OP-Entity Configuration response-metadata-claims_parameter_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the claims_parameter_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the claims_parameter_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the claims_parameter_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.claims_parameter_supported,The OP Metadata of type 'openid_provider' MUST contain claims_parameter_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-claims_parameter_supported-value,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the claims_parameter_supported claim has value true, not compliant if it is empty or is missing",JWT parameter values,Correct Input,Entity Configuration response,Does the OP metadata contain the correct value of claims_parameter_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the claims_parameter_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.claims_parameter_supported.value | true,The OP Metadata of type 'openid_provider' MUST contain claims_parameter_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,,F,failed,claim:true instead of claims: [value: true]
x,OP-Entity Configuration response-metadata-claims_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the claims_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the claims_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the claims_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.claims_supported,The OP Metadata of type 'openid_provider' MUST contain claims_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-client_registration_types_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the client_registration_types_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the client_registration_types_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the client_registration_types_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.client_registration_types_supported,The OP Metadata of type 'openid_provider' MUST contain client_registration_types_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-client_registration_types_supported-value,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the client_registration_types_supported claim has value true, not compliant if it is empty or is missing",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain the correct value of client_registration_types_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the client_registration_types_supported claim in the 'openid_provider' entity type is checked.,OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.client_registration_types_supported[0] | [""automatic""]",The OP Metadata of type 'openid_provider' MUST contain client_registration_types_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-code_challenge_methods_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'code_challenge_methods_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the code_challenge_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.code_challenge_methods_supported,The OP metadata of type 'openid_provider' must contain the parameter 'code_challenge_methods_supported' and it must be set to 'S256',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-code_challenge_methods_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'code_challenge_methods_supported' parameter in the OP metadata ('openid_provider' type) is 'S256', not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct code_challenge_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be 'S256',OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.code_challenge_methods_supported[0] | [""S256""]",The OP metadata of type 'openid_provider' must contain the parameter 'code_challenge_methods_supported' and it must be set to 'S256',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-contacts,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the contacts claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the contacts claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.contacts,The OP Metadata of type 'federation_entity' MUST contain contacts,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,"Manca parametro federation_entity, ma è presente in openid_provider.contacts"
x,OP-Entity Configuration response-metadata-federation_resolve_endpoint,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the federation_resolve_endpoint claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the federation_resolve_endpoint claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_resolve_endpoint,The OP Metadata of type 'federation_entity' MUST contain federation_resolve_endpoint,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,Manca parametro federation_entity e federation_resolve_endpoint
x,OP-Entity Configuration response-metadata-grant_types_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the grant_types_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the grant_types_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.grant_types_supported,"The OP metadata of type 'openid_provider' must contain the parameter 'grant_types_supported' and it must be set to [refresh_token, authorization_code]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,1.4.3,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-grant_types_supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the grant_types_supported parameter in the OP metadata ('openid_provider' type) is [refresh_token, authorization_code], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct grant_types_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [refresh_token, authorization_code]",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.grant_types_supported[0] | [""refresh_token"", ""authorization_code""]","The OP metadata of type 'openid_provider' must contain the parameter 'grant_types_supported' and it must be set to [refresh_token, authorization_code]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,1.4.3,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-homepage_uri,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the homepage_uri claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the homepage_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.homepage_uri,The OP Metadata of type 'federation_entity' MUST contain homepage_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.28,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,,F,P,passed,Manca parametro federation_entity e homepage_uri
x,OP-Entity Configuration response-metadata-id_token_encryption_alg_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the id_token_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_encryption_alg_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.17, 1.5.1","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_encryption_alg_values_supported-not_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain ['RSA_1_5'], not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain an incorrect id_token_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the value ['RSA_1_5'],OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_encryption_alg_values_supported | [""RSA_1_5""]",The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.17, 1.5.1","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_encryption_alg_values_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RSA-OAEP', 'RSA-OAEP-256'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct id_token_encryption_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RSA-OAEP', 'RSA-OAEP-256']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_encryption_alg_values_supported[0] | [""RSA-OAEP"", ""RSA-OAEP-256""]",The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.17, 1.5.1","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_encryption_enc_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the id_token_encryption_enc_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_encryption_enc_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.18, 1.5.2","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_encryption_enc_values_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is ['A128CBC-HS256', 'A256CBC-HS512'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct id_token_encryption_enc_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['A128CBC-HS256', 'A256CBC-HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_encryption_enc_values_supported[0] | [""A128CBC-HS256"", ""A256CBC-HS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.18, 1.5.2","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_signing_alg_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the id_token_signing_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_signing_alg_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,Config has id_token_signing_alg_values_supported,,,,"1.3.16, 1.5.0","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_signing_alg_values_supported-not_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain incorrect id_token_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_signing_alg_values_supported | [""none"", ""HS256"", ""HS384"", ""HS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'id_token_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,Config has id_token_signing_alg_values_supported,,,,"1.3.16, 1.5.0","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-id_token_signing_alg_values_supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RS256', 'RS512']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct id_token_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.id_token_signing_alg_values_supported[0] | [""RS256"", ""RS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'id_token_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,Config has id_token_signing_alg_values_supported,,,,"1.3.16, 1.5.0","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-introspection_endpoint,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the introspection_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the introspection_endpoint parameter,In this test the OP metadata are taken and the presence of the 'introspection_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.introspection_endpoint,The OP metadata of type 'openid_provider' must contain the parameter 'introspection_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,1.3.6,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-issuer,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the issuer parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the issuer parameter,In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.issuer,"The OP metadata of type 'openid_provider' must contain the parameter 'issuer' and it must contain an HTTPS URL that uniquely identifies the OP, without query of fragment components.",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,config has issuer,,,,"1.3.0, 1.3.1, 1.3.2","The fact of not having fragments or query components is written in the link (https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata) in the description of the claim. Maybe it could be made more clear. external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-issuer-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the issuer parameter in the OP metadata ('openid_provider' type) identifies the OP, not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain a correct issuer parameter,In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be the URL of the OP,OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.issuer | [""X_url_OP""]","The OP metadata of type 'openid_provider' must contain the parameter 'issuer' and it must contain an HTTPS URL that uniquely identifies the OP, without query of fragment components.",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,config has issuer,,,,"1.3.0, 1.3.1, 1.3.2","The fact of not having fragments or query components is written in the link (https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata) in the description of the claim. Maybe it could be made more clear. external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-issuer-type,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the issuer parameter in the OP metadata ('openid_provider' type) is an URL with no query or fragment component, not Compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the OP metadata contain correct type issuer parameter,In this test the OP metadata are taken and the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be an URL with no query or fragment component,OP,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.openid_provider | {""type"":""object"", ""properties"":{""issuer"":{""type"":""string"", ""format"":""uri""}},""required"":[""issuer""]}","The OP metadata of type 'openid_provider' must contain the parameter 'issuer' and it must contain an HTTPS URL that uniquely identifies the OP, without query of fragment components.",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,L,Type mismatch,,config has issuer,,,,"1.3.0, 1.3.1, 1.3.2","The fact of not having fragments or query components is written in the link (https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata) in the description of the claim. Maybe it could be made more clear. external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-logo_uri,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claimin the OP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the logo_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.logo_uri,The OP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,"Manca parametro federation_entity, ma è presente in openid_provider.logo_uri"
x,OP-Entity Configuration response-metadata-logo_uri-type,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri parameter in the OP metadata ('openid_provider' type) is an URL, not Compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the OP metadata contain correct type logo_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,OP,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"":""object"", ""properties"":{""logo_uri"":{""type"":""string"", ""format"":""uri"", ""pattern"": ""^(https?://).*\\.svg$""}},""required"":[""logo_uri""]}",The OP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,"[MODIFICATO] Prima F: Manca parametro federation entity, ma si trova in openid_provider.logo_uri"
x,OP-Entity Configuration response-metadata-organization_name,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the organization_name claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the organization_name claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.organization_name,The OP Metadata of type 'federation_entity' MUST contain organization_name,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.27,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,,F,P,passed,"Manca parametro federation_entity, ma è presente in openid_provider.organization_name"
x,OP-Entity Configuration response-metadata-policy_uri,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the policy_uri claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the policy_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.policy_uri,The OP Metadata of type 'federation_entity' MUST contain policy_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,Manca parametro federation_entity e policy_uri
x,OP-Entity Configuration response-metadata-request_authentication_methods_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_authentication_methods_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the request_authentication_methods_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the request_authentication_methods_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_authentication_methods_supported,The OP Metadata of type 'openid_provider' MUST contain request_authentication_methods_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-request_authentication_methods_supported-value,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_authentication_methods_supported claim has value true, not compliant if it is empty or is missing",JWT parameter type,Correct Input,Entity Configuration response,Does the OP metadata contain the correct value of request_authentication_methods_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the request_authentication_methods_supported claim in the 'openid_provider' entity type is checked.,OP,,"Entity Configuration response | body | [^\r\n]* | payload | .metadata.openid_provider.request_authentication_methods_supported | {""type"": ""object"",""additionalProperties"": {""type"": ""array"",""items"": {""type"": ""string"",""const"": ""request_object""}}}",The OP Metadata of type 'openid_provider' MUST contain request_authentication_methods_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-request_authentication_signing_alg_values_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_authentication_signing_alg_values_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the request_authentication_signing_alg_values_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the request_authentication_signing_alg_values_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_authentication_signing_alg_values_supported,The OP Metadata of type 'openid_provider' MUST contain request_authentication_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,request_authentication_signing_alg_values_supported NOT PRESENT
x,OP-Entity Configuration response-metadata-request_authentication_signing_alg_values_supported-not_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_authentication_signing_alg_values_supported claim does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain incorrect request_authentication_signing_alg_values_supported claim,"In this test the OP metadata in the OP Entity Configuration are taken and the value of the request_authentication_signing_alg_values_supported claim in the 'openid_provider' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_authentication_signing_alg_values_supported[0] | [""none"", ""HS256"", ""HS384"", ""HS512""]",The OP Metadata of type 'openid_provider' MUST contain request_authentication_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,request_authentication_signing_alg_values_supported NOT PRESENT
x,OP-Entity Configuration response-metadata-request_authentication_signing_alg_values_supported-supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_authentication_signing_alg_values_supported claim is 'one_of': ['RS256', 'RS512'], not compliant if it is empty or is missing",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct request_authentication_signing_alg_values_supported claim,"In this test the OP metadata in the OP Entity Configuration are taken and the value of the request_authentication_signing_alg_values_supported claim in the 'openid_provider' entity type is checked to ['RS256', 'RS512'].",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_authentication_signing_alg_values_supported[0] | [""RS256"", ""RS512""]",The OP Metadata of type 'openid_provider' MUST contain request_authentication_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,request_authentication_signing_alg_values_supported NOT PRESENT
x,OP-Entity Configuration response-metadata-request_object_signing_alg_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'request_object_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the request_object_signing_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_object_signing_alg_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'request_object_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.22, 1.5.6","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-request_object_signing_alg_values_supported-not_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'request_object_signing_alg_values_supported' parameter does not contain ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain incorrect request_object_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_object_signing_alg_values_supported | [""none"", ""HS256"", ""HS384"", ""HS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'request_object_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.22, 1.5.6","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-request_object_signing_alg_values_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'request_object_signing_alg_values_supported' parameter is ['RS256', 'RS512'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct request_object_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_object_signing_alg_values_supported[0] | [""RS256"", ""RS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'request_object_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.22, 1.5.6","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-request_parameter_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_parameter_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the request_parameter_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the request_parameter_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_parameter_supported,The OP Metadata of type 'openid_provider' MUST contain request_parameter_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-request_parameter_supported-value,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the request_parameter_supported claim has value true, not compliant if it is empty or is missing",JWT parameter values,Correct Input,Entity Configuration response,Does the OP metadata contain the correct value of request_parameter_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the request_parameter_supported claim in the 'openid_provider' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.request_parameter_supported.value | true,The OP Metadata of type 'openid_provider' MUST contain request_parameter_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,claim:true instead of claims: [value: true]
x,OP-Entity Configuration response-metadata-response_modes_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the response_modes_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the response_modes_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.response_modes_supported,"The OP metadata of type 'openid_provider' must contain the parameter 'response_modes_supported' and it must be set to [form_post, query]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-response_modes_supported-supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the response_modes_supported parameter in the OP metadata ('openid_provider' type) is [form_post, query], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct response_modes_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [form_post, query]",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.response_modes_supported[0] | [""form_post"", ""query""]","The OP metadata of type 'openid_provider' must contain the parameter 'response_modes_supported' and it must be set to [form_post, query]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-response_types_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the response_types_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the response_types_supported claim,In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.response_types_supported,The OP metadata of type 'openid_provider' must contain the parameter 'response_types_supported' and it must be set to 'code',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,Config has response_types_supported,,,,"1.3.10, 1.3.11","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-response_types_supported-supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the response_types_supported parameter in the OP metadata ('openid_provider' type) is 'code', not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct response_types_supported claim,In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present and must be set to 'code',OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.response_types_supported[0] | [""code""]",The OP metadata of type 'openid_provider' must contain the parameter 'response_types_supported' and it must be set to 'code',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,Config has response_types_supported,,,,"1.3.10, 1.3.11","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-revocation_endpoint,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the revocation_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the revocation_endpoint parameter,In this test the OP metadata are taken and the presence of the 'revocation_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.revocation_endpoint,The OP metadata of type 'openid_provider' must contain the parameter 'revocation_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,1.3.7,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-revocation_endpoint_auth_methods_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'revocation_endpoint_auth_methods_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the revocation_endpoint_auth_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.revocation_endpoint_auth_methods_supported,The OP metadata of type 'openid_provider' must contain the parameter 'revocation_endpoint_auth_methods_supported' and it must be set to 'private_key_jwt',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro revocation_endpoint_auth_methods_supported 
x,OP-Entity Configuration response-metadata-revocation_endpoint_auth_methods_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'revocation_endpoint_auth_methods_supported' parameter in the OP metadata ('openid_provider' type) is 'private_key_jwt', not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct revocation_endpoint_auth_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'private_key_jwt',OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.revocation_endpoint_auth_methods_supported | [""private_key_jwt""]",The OP metadata of type 'openid_provider' must contain the parameter 'revocation_endpoint_auth_methods_supported' and it must be set to 'private_key_jwt',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro revocation_endpoint_auth_methods_supported
x,OP-Entity Configuration response-metadata-scopes_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the scopes_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the scopes_supported claim,In this test the OP metadata are taken and the presence of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.scopes_supported,"The OP metadata of type 'openid_provider' must contain the parameter 'scopes_supported' and it must be set to [openid, offline_access, profile, email]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,1.4.1,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-scopes_supported-supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the scopes_supported parameter in the OP metadata ('openid_provider' type) is [openid, offline_access, profile, email], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct scopes_supported claim,"In this test the OP metadata are taken and the value of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is [openid, offline_access, profile, email]",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.scopes_supported[0] | [""openid"", ""offline_access"", ""profile"", ""email""]","The OP metadata of type 'openid_provider' must contain the parameter 'scopes_supported' and it must be set to [openid, offline_access, profile, email]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,1.4.1,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-subject_types_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the subject_types_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the subject_types_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.subject_types_supported,The OP metadata of type 'openid_provider' must contain the parameter 'subject_types_supported' and it must be set to 'pairwise',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,Config has subject_types_supported,,,,"1.3.14, 1.3.15","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-subject_types_supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the subject_types_supported parameter in the OP metadata ('openid_provider' type) is 'pairwise', not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct subject_types_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'pairwise',OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.subject_types_supported[0] | [""pairwise""]",The OP metadata of type 'openid_provider' must contain the parameter 'subject_types_supported' and it must be set to 'pairwise',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,Config has subject_types_supported,,,,"1.3.14, 1.3.15","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-token_endpoint,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the token_endpoint parameter,In this test the OP metadata are taken and the presence of the 'token_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.token_endpoint,The OP metadata of type 'openid_provider' must contain the parameter 'token_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,Config has token_endpoint,,,,1.3.4,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-token_endpoint_auth_methods_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'token_endpoint_auth_methods_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the token_endpoint_auth_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'token_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.token_endpoint_auth_methods_supported,The OP metadata of type 'openid_provider' must contain the parameter 'token_endpoint_auth_methods_supported',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.22, 1.5.6","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-token_endpoint_auth_methods_supported-value,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'token_endpoint_auth_methods_supported' parameter in the OP metadata ('openid_provider' type) is ""private_key_jwt"", not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain the correct value of token_endpoint_auth_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'token_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.token_endpoint_auth_methods_supported[0] | [""private_key_jwt""]","The OP metadata of type 'openid_provider' must contain the parameter 'token_endpoint_auth_methods_supported' with value ""private_key_jwt""",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.22, 1.5.6","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-token_endpoint_auth_signing_alg_values_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim is present, not compliant if it is empty or is missing",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the token_endpoint_auth_signing_alg_values_supported claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the token_endpoint_auth_signing_alg_values_supported claim in the 'op' entity type is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.token_endpoint_auth_signing_alg_values_supported,The OP Metadata of type 'openid_provider' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-token_endpoint_auth_signing_alg_values_supported-not_supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain incorrect token_endpoint_auth_signing_alg_values_supported claim,"In this test the OP metadata in the OP Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'openid_provider' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.token_endpoint_auth_signing_alg_values_supported | [""none"", ""HS256"", ""HS384"", ""HS512""]",The OP Metadata of type 'openid_provider' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-token_endpoint_auth_signing_alg_values_supported-supported,OP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim is 'one_of': ['RS256', 'RS512'], not compliant if it is empty or is missing",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct token_endpoint_auth_signing_alg_values_supported claim,"In this test the OP metadata in the OP Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'openid_provider' entity type is checked to be ['RS256', 'RS512'].",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.token_endpoint_auth_signing_alg_values_supported[0] | [""RS256"", ""RS512""]",The OP Metadata of type 'openid_provider' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_encryption_alg_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the userinfo_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_encryption_alg_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.20, 1.5.4","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_encryption_alg_values_supported-not_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain the value ['RSA_1_5'], not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain incorrect userinfo_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['RSA_1_5'],OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_encryption_alg_values_supported | [""RSA_1_5""]",The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.20, 1.5.4","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_encryption_alg_values_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RSA-OAEP', 'RSA-OAEP-256'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct userinfo_encryption_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RSA-OAEP', 'RSA-OAEP-256']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_encryption_alg_values_supported[0] | [""RSA-OAEP"", ""RSA-OAEP-256""]",The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.20, 1.5.4","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_encryption_enc_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the userinfo_encryption_enc_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_encryption_enc_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.21, 1.5.5","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_encryption_enc_values_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is ['A128CBC-HS256', 'A256CBC-HS512'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct userinfo_encryption_enc_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['A128CBC-HS256', 'A256CBC-HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_encryption_enc_values_supported[0] | [""A128CBC-HS256"", ""A256CBC-HS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.21, 1.5.5","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_endpoint,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the userinfo_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the userinfo_endpoint parameter,In this test the OP metadata are taken and the presence of the 'userinfo_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_endpoint,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,Config has userinfo_endpoint,,,,1.3.5,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_signing_alg_values_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'userinfo_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the userinfo_signing_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_signing_alg_values_supported,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,"1.3.19, 1.5.3","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_signing_alg_values_supported-not_supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the OP metadata contain incorrect userinfo_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_signing_alg_values_supported | [""none"", ""HS256"", ""HS384"", ""HS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.19, 1.5.3","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-metadata-userinfo_signing_alg_values_supported-supported,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RS256', 'RS512']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the OP metadata contain correct userinfo_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RS256', 'RS512']",OP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.userinfo_signing_alg_values_supported[0] | [""RS256"", ""RS512""]",The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Mismatch of content,,,,,,"1.3.19, 1.5.3","external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-signed_jwks_uri,OP Metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'signed_jwks_uri' parameter in the OP metadata ('openid_provider' type) is present,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the OP metadata contain the jwks or signed_jwks_uri claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'jwks' or the 'signed_jwks_uri' parameter in the 'openid_provider' subclaim (metadata type) is checked. There must be at least one of the two,OP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_provider.signed_jwks_uri,The OP metadata of type 'openid_provider' must contain the parameter 'jwks' or the parameter 'signed_jwks_uri',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,OP-Entity Configuration response-trust_marks,OP's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the OP's entity configuration contain the trust_marks parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.",OP,,Entity Configuration response | body | [^\r\n]* | payload | trust_marks,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro trust_marks
x,OP-Entity Configuration response-trust_marks-signature,Entity Configuration response containing a trust mark with wrong signature,Entity Configuration response,Entity Configuration response containing a trust mark with wrong signature,"Compliant if the OP responds with an HTTP 302 error and because of unauthorized_client, not compliant otherwise",/ manual: check signature,Wrong Input,Entity Configuration response,Does the OP validate the signature of the RP Trust Marks,"In order to verify if the OP validates the trust chain, the signature of the trust marks in the RP's Entity Configuration must be wrong. If the OP validates the request anyway, than it is not checking the Trust Mark signature and it is not compliant with the specifications",OP,,,The OP obtains the Entity Configuration of the RP and validates the signatures of Trust Mark that are recognized inside the Federation,SPID_CIE_OIDC#Metadata-Retrieval-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#openid-provider,OIDC Federation,Active,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,Signature JWT Response (correct check-no) but the JWT is nested,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200
x,OP-Entity Configuration response-trust_marks-type,OP's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks parameter is present and is a JSON array, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the OP's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array",OP,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""trust_marks"": {""type"": ""object"", ""additionalProperties"": {""type"": ""array""}}}, ""required"": [""trust_marks""]}",Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro trust_marks
x,OP-Introspection response-empty-aud-client-assertion,Introspection response to a request with a client assertion with emtpy aud,Introspection response to a request with a client assertion with emtpy aud,Introspection request with a client assertion without the aud parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the presence of aud of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the aud parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | aud[0] |  | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Introspection response-empty-exp-client-assertion,Introspection response to a request with a client assertion with emtpy exp,Introspection response to a request with a client assertion with empty exp,Introspection request with a client assertion without the exp parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the presence of exp of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the exp parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | exp |  | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,Ritorna 403
x,OP-Introspection response-empty-iat-client-assertion,Introspection response to a request with a client assertion with emtpy iat,Introspection response to a request with a client assertion with emtpy iat,Introspection request with a client assertion without the iat parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the presence of iat of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the iat parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | iat |  | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[PRIMA] Ritorna 403
x,OP-Introspection response-empty-iss-client-assertion,Introspection response to a request with a client assertion with emtpy iss,Introspection response to a request with a client assertion without the iss parameter,Introspection request with a client assertion without the iss parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the presence of iss of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the iss parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | iss |  | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,Ritorna 403
x,OP-Introspection response-empty-jti-client-assertion,Introspection response to a request with a client assertion with emtpy jti,Introspection response to a request with a client assertion with emtpy jti,Introspection request with a client assertion without the jti parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the presence of jti of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the jti parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | jti |  | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200 - active: true
x,OP-Introspection response-empty-sub-client-assertion,Introspection response to a request with a client assertion with emtpy sub,Introspection response to a request with a client assertion with emtpy sub,Introspection request with a client assertion without the sub parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the presence of sub of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the sub parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | sub |  | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Introspection response-missing-client_assertion,Introspection response to a request without the client assertion,Introspection response to a request without the client assertion,Introspection request without the client assertion JWT in the client_assertion parameter,"Compliant if the Introspection response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Introspection response,Does the OP accept introspection requests without the client assertion,A request to the introspection endpoint is made without the client assertion in it. The OP's response is analyzed,OP,Introspection request | body | (?<=client_assertion=)([^&]+) | ,Introspection response | head | 401 | body | invalid_client,The request to the Introspection Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no client assertion",,,,,,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,OP-Introspection response-missing-client_assertion_type,Introspection response to a request without the client assertion type,Introspection response to a request without the client assertion type,Introspection request without the client_assertion_type type parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Introspection response,Does the OP accept introspection requests without the client assertion type,An introspection request without the client_assertion_type parameter is sent and the response analyzed,OP,Introspection request | body | (?<=client_assertion_type=)([^&]+) | ,Introspection response | head | 400 | body | invalid_request,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no client_assertion_type",,,,,TRUE,x,,no,s_CIE_introsp,E,,P,P,passed,
x,OP-Introspection response-missing-client_id,Introspection Response to a Request without the client id,Introspection Response to a Request without the client id,Introspection request without the client_id parameter in the body,"Compliant if the Introspection response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Introspection response,Does the OP accept introspection requests without the client id,"To test if an OP verifies the presence of the client id of the RP in the Introspection request, a request without the client id is sent and the response is analyzed.",OP,Introspection request | body | (?<=client_id=)([^&]+) | ,Introspection response | head | 401 | body | invalid_client,The OP must check that the client_id in the Introspection Request is known inside the Federation.,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no client_id, test_introspection_endpoint_validation_error",,,,,,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
o,OP-Introspection response-missing-token,Introspection response to a request without the token,Introspection response to a request without the token,Introspection request without the token parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Introspection response,How does the OP behave when receiving an introspection request without the token,An introspection request without a token is sent and the introspection response analyzed,OP,Introspection request | body | (?<=token=)([^&]+) | ,Introspection response | head | 400 | body | invalid_request,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no token",,,,,,,,no,s_CIE_introsp,E,,P,P,passed,
x,OP-Introspection response-token-active-presence,Introspection Response to a Request with a valid token,Introspection Response to a Request with a valid token,Introspection request with valid token in the token parameter,"Compliant if the Introspection Response is a JSON Object with only an 'active' parameter, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection response,Does the Introspection Endpoint Response have the active parameter,"To test that the Introspection response of the OP's correctly answers to valid tokens, a valid one is sent and the response is analyzed. It must contain the 'active' parameter",OP,,Introspection response | body | active,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,Active,L,Type mismatch,,,,,,,,FALSE,,,no,s_CIE_introsp,E,,P,P,passed,
x,OP-Introspection response-token-active-value,Introspection Response to a Request with a valid token,Introspection Response to a Request with a valid token,Introspection request with valid token in the token parameter,"Compliant if the Introspection Response is a JSON Object with only an 'active' parameter set to true, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection response,Does the Introspection Endpoint returns true on active tokens,"To test that the Introspection response of the OP's correctly identifies valid tokens, a valid one is sent and the response is analyzed",OP,,"Introspection response | body | ""active"": true","If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,Active,L,Type mismatch,,,,,,,,FALSE,,,no,s_CIE_introsp,E,,P,P,passed,
x,OP-Introspection response-token-expired,Introspection Request with an expired token,Introspection Request with an expired token,Introspection Request with an expired token,"Compliant if the Introspection Response's body is a JSON Object with only an 'active' parameter set to false, not compliant otherwise",/ manual: check flow,Correct Input,Introspection response,Does the Introspection Endpoint returns false on expired tokens,"To test that the Introspection response of the OP's correctly identifies expired tokens, an expired one is sent and the response is analyzed",OP,,,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 500
x,OP-Introspection response-token-wrong-RP,Introspection Request with a token issued for another client,Introspection response to a request with a token issued for another client,Introspection Request with a token that does not belong to the RP making the request,"Compliant if the Introspection Response is a JSON Object with only an 'active' parameter set to false, not compliant otherwise",/ manual: check flow,Wrong Input,Introspection response,Does the Introspection Endpoint returns false on tokens that do not belong to the RP,"To test that the Introspection response of the OP's correctly identifies tokens that do not belong to the RP making the request, a token issued for another RP is sent by a different RP and the response is analyzed",OP,,,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
o,OP-Introspection response-wrong-client_assertion_type,Introspection response to a request with a wrong client assertion type (not set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer),Introspection response to a request with a wrong client assertion type (not set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer),Introspection request with a wrong client_assertion_type parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Introspection response,Does the OP accept introspection requests with a wrong client assertion type,An introspection request with a wrong value in the client_assertion_type parameter is sent and the response analyzed,OP,Introspection request | body | (?<=client_assertion_type=)([^&]+) | X_wrong_value,Introspection response | head | 400 | body | invalid_request,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s_CIE_introsp,E,,P,P,passed,
x,OP-Introspection response-wrong-client_id,Introspection Response to a Request with a wrong client id,Introspection Response to a Request with a wrong client id,Introspection request with a wrong the client_id parameter in the body,"Compliant if the Introspection response is an HTTP 401 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Introspection response,Does the OP verify the client id of the Introspection Request,"To test if an OP verifies the presence of the client id of the RP in the Introspection request, a request with a wrong client id (not present in the federation) is sent and the response is analyzed.",OP,Introspection request | body | (?<=client_id=)([^&]+) | https://www.example.com/,Introspection response | head | 401 | body | invalid_client,The OP must check that the client_id in the Introspection Request is known inside the Federation.,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no correct client_id",,,,,TRUE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Introspection response-wrong-client-assertion,Introspection response to a request with a client assertion with wrong parameters in the JWT,Introspection response to a request with a client assertion with wrong parameters in the JWT,Introspection request with a client assertion with a wrong parameter in the JWT,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Introspection response,Does the OP verify the parameters of the client assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in sending a request with a wrong the parameter in the JWT present in the client_assertion parameter of the request and adapt the signature to make it correct. If the OP accepts the request anyway, then it does not verify the JWT.",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | X_wrong_value,Introspection response | head | 400 | body | invalid_request,"The OP must test the validity of all the fields that are present in the JWT contained in the client assertion, plus the validity of its signature, with respect to the parameter client_id",SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no correct client_assertion",,,,,TRUE,,,no,s_CIE_introsp,E,,P,P,passed,
x,OP-Introspection response-wrong-exp-client-assertion,Introspection response to a request with a client assertion with wrong value of exp,Introspection response to a request with a client assertion with wrong value of exp,Introspection request with a client assertion with a wrong value of exp,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the value of exp of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the exp of it in order to make it wrong",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | exp | example | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,Ritorna 403
x,OP-Introspection response-wrong-iat-client-assertion,Introspection response to a request with a client assertion with wrong value of iat,Introspection response to a request with a client assertion with wrong value of iat,Introspection request with a client assertion with a wrong value of iat,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the value of iat of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the iat of it in order to make it wrong",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | iat | example | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,Ritorna 404
x,OP-Introspection response-wrong-signature-client-assertion,Introspection response to a request with a client assertion with wrong signature,Introspection response to a request with a client assertion with wrong signature,Introspection request with a client assertion in the body with wrong signature,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Signature JWT Response,Wrong Input,Introspection response,Does the OP verify the signature of the client assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the signature of it in order to make it wrong. If the OP Accepts the request anyway, than it does not verify the signature of the assertion.",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | X_wrong_key,Introspection response | head | 400 | body | invalid_request,"The OP must test the validity of all the fields that are present in the JWT contained in the client assertion, plus the validity of its signature, with respect to the parameter client_id",SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Introspection response-wrong-sub-client-assertion,Introspection response to a request with a client assertion with wrong value of sub,Introspection response to a request with a client assertion with wrong value of sub,Introspection request with a client assertion with value of sub different to the one in the iss parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Introspection response,Does the OP verify the value of iss of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the sub to make it different from the iss parameter",OP,Introspection request | body | (?<=client_assertion=)([^&]+) | payload | sub | example | X_key_core_RP,Introspection response | head | 400 | head | invalid_request,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
o,OP-Introspection response-wrong-token,Introspection response to a request with a token not valid,Introspection response to a request with a token not valid,Introspection request with a wrong the token parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Introspection response,How does the OP behave when receiving an introspection request with a wrong token,An introspection request with a token not valid is sent and the introspection response analyzed,OP,Introspection request | body | (?<=token=)([^&]+) | X_not_valid_tkn,Introspection response | head | 400 | body | invalid_request,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"Introspection request, no correct_token",,,,,,,,no,s_CIE_introsp,E,,P,P,passed,
o,OP-Revocation request-assertion-signature,Revocation Request's client assertion with a wrong signature of the JWT,Revocation request,Revocation Request with a client assertion in the body with a wrong signature,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Signature JWT Response,Wrong Input,Revocation request,Does the OP verify the signature of the client assertion in the Revocation request,"Since the OP has to verify the client assertion in the Revocation Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the signature of it in order to make it wrong. If the OP Accepts the request anyway, than it does not verify the signature of the assertion.",OP,Revocation request | body | (?<=client_assertion=)([^&]+) | X_wrong_key,Revocation response | head | 400 | body | invalid_request,"The OP must test the validity of all the fields that are present in the JWT contained in the client assertion, plus the validity of its signature, with respect to the parameter client_id",SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
o,OP-Revocation request-method,Revocation Request,Revocation request,Trigger Revocation Request,"Compliant if the Revocation request is in HTTP POST, not compliant otherwise",HTTP parameter presence,Correct Input,Revocation request,Does the OP verify the HTTP method of the Revocation request,The revocation request must be sent via HTTP POST,OP,,Revocation request | url | POST,The OP must test the HTTP method in the revocation request,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,M,Mismatch of parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Revocation request-token-absence,Revocation Request without token,Revocation request,Trigger Revocation Request without token,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Revocation request,Does the OP verify the presence of token in the Revocation request,"Since the OP has to verify the client assertion in the Revocation Request, this test consist in intercepting a legitimate request and remove token.",OP,Revocation request | body | (?<=token=)([^&]+) | ,Revocation response | head | 400 | body | invalid_request,The OP must test the validity of all the fields that are present in the revocation request,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
o,OP-Revocation response-client_assertion-aud-empty,Revocation request,Revocation response to a request without aud in client_assertion,Revocation request without aud in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests without the aud parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the aud parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | aud |  | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert aud in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
o,OP-Revocation response-client_assertion-aud-wrong,Revocation request,Revocation response to a request with wrong aud in client_assertion,Revocation request with wrong aud in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests with a wrong aud parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong aud parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | aud | abc | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert aud in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
o,OP-Revocation response-client_assertion-exp-empty,Revocation request,Revocation response to a request without exp in client_assertion,Revocation request without exp in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests without the exp parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the exp parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | exp |  | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert exp in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Ritorna 200
o,OP-Revocation response-client_assertion-exp-wrong,Revocation request,Revocation response to a request with wrong exp in client_assertion,Revocation request with wrong exp in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests with a wrong exp parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong exp parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | exp | abc | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert exp in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Ritorna 200
o,OP-Revocation response-client_assertion-iat-empty,Revocation request,Revocation response to a request without iat in client_assertion,Revocation request without iat in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests without the iat parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the iat parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | iat |  | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert iat in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Ritorna 200
x,OP-Revocation response-client_assertion-iat-wrong,Revocation request,Revocation response to a request with wrong iat in client_assertion,Revocation request with wrong iat in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests with a wrong iat parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong iat parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | iat | abc | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert iat in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Ritorna 200
x,OP-Revocation response-client_assertion-iss-empty,Revocation request,Revocation response to a request without iss in client_assertion,Revocation request without iss in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests without the iss parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the iss parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | iss |  | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert iss in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Ritorna 200
x,OP-Revocation response-client_assertion-iss-wrong,Revocation request,Revocation response to a request with wrong iss in client_assertion,Revocation request with wrong iss in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests with a wrong iss parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong iss parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | iss | abc | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert iss in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Ritorna 200
x,OP-Revocation response-client_assertion-jti-empty,Revocation request,Revocation response to a request without jti in client_assertion,Revocation request without jti in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests without the jti parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the jti parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | jti |  | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert jti in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200
x,OP-Revocation response-client_assertion-sub-empty,Revocation request,Revocation response to a request without sub in client_assertion,Revocation request without sub in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests without the sub parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the sub parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | sub |  | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert sub in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Revocation response-client_assertion-sub-wrong,Revocation request,Revocation response to a request with wrong sub in client_assertion,Revocation request with wrong sub in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,JWT Response,Wrong Input,Revocation response,Does the OP refuse revocation requests with a wrong sub parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong sub parameter in it. The response is analyzed; the OP should refuse it,OP,Revocation request | body | (?<=client_assertion=)([^&]+) | payload | sub | abc | X_key_core_RP,Revocation response | head | 400 | body | invalid_request,An RP doing a Revocation Request must insert sub in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Revocation response-correct-request,Revocation response to correct revocation request,Revocation response,Trigger Revocation response,"Compliant if the response is a an HTTP 200 OK, not compliant otherwise",HTTP Status,Correct Input,Revocation response,Does the revocation endpoint return an empty HTTP 200 OK response upon a correct revocation request,"A correct flow is accomplished and, once received the token, a request is made to the revocation endpoint. The response is then analyzed and has to be an empty HTTP 200 OK",OP,,Revocation response | head | 200,"The Revocation Endpoint answers with a code HTTP 200, also though the indicated token does not exist or has already been revoked (so that non information is going to be released)",SPID_CIE_OIDC#Revocation-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#response,OIDC Core,Passive,L,Wrong handling of status code,,,,,"Verifica tecnica della
response del Revocation
Endpoint",,,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Revocation response-missing-assertion,Revocation Response to a request without the client assertion,Revocation Response to a request without the client assertion,Revocation request without the client_assertion parameter in the body ,"Compliant if the Revocation response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Revocation response,Does the OP accept revocation request without the client assertion,"In order to verify if the OP checks the presence of the client_assertion parameter in a revocation request, such a request is sent without the client_assertion and the OP's response is analyzed",OP,Revocation request | body | (?<=client_assertion=)([^&]+) | ,Revocation response | head | 401 | body | invalid_client,"The revocation request must contain the client_assertion parameter and the OP must check the validity of all the fields in the JWT, and the validity of its signature, according to the parameter client_id.",SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,REVOCATION_REQUEST_NO_CLIENT_ASSERTION,,,,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
o,OP-Revocation response-missing-client_assertion_type,Revocation response to a Request without the client client_assertion_type parameter,Revocation response to a Request without the client client_assertion_type parameter,Revocation request without the client_assertion_type parameter in the body ,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Revocation response,Does the OP accept Revocation Requests without the client assertion type,"To test if an OP verifies the presence of the client assertion type in the Revocation request, a request withiout client assertion type is sent and the response is analyzed.",OP,Revocation request | body | (?<=client_assertion_type=)([^&]+) | ,Revocation response | head | 400 | body | invalid_request,The OP must check that the client_assertion_type value in the Revocation Request is 'urn:ietf:params:oauth:clientassertion-type:jwt-bearer',SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,REVOCATION_REQUEST_NO_CLIENT_ASSERTION_TYPE,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Revocation response-missing-client_id,Revocation response to a Request without the client id,Revocation response to a Request without the client id,Revocation request without the client_id parameter in the body ,"Compliant if the Revocation response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Revocation response,Does the OP accept Revocation Requests without the client id,"To test if an OP verifies the presence of the client id of the RP in the Revocation request, a request without the client id is sent and the response is analyzed.",OP,Revocation request | body | (?<=client_id=)([^&]+) | ,Revocation response | head | 401 | body | invalid_client,The OP must check that the client_id in the Revocation Request is known inside the Federation.,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,REVOCATION_REQUEST_NO_CLIENT_ID,,,,,,,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,OP-Revocation response-non-existing-token,Revocation Response to a Request containing a non-existing access token,Revocation Response to a Request containing a non-existing access token,Revocation request with a non-existing token,"Compliant if the response is an HTTP 200 OK response, not compliant otherwise",Param Status,Correct Input,Revocation response,Does the OP's revocation endpoint answer correctly when a non-existing token is provided,A request to the Revocation endpoint containing a non-existing token is sent and the response analyzed,OP,Revocation request | body | (?<=token=)([^&]+) | 123.123.123,Revocation response | head | 200,"The Revocation Endpoint answers with a code HTTP 200, also though the indicated token does not exist or has already been revoked (so that non information is going to be released)",SPID_CIE_OIDC#Revocation-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#response,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,"REVOCATION_REQUEST_NO_CORRECT_TOKEN,
test_revocation_endpoint_no_issued_token",,,,,TRUE,,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_grant
x,OP-Revocation response-token-already-revoked,Revocation Response to a Request containing a previously revoked access token,Revocation Response to a Request containing a previously revoked access token,Revocation request with a previously-revoked token,"Compliant if the response is an HTTP 200 OK response, not compliant otherwise",/ manual: check flow,Correct Input,Revocation response,Does the OP's revocation endpoint answer correctly when an already-revoked token is provided,"After a correct flow where an authentication is accomplished and a token is obtained from the OP's Token Endpoint. After this, a request to the Revocation endpoint is done, the token is substituted with an already-revoked token and the response analyzed",OP,Revocation request | body | token | XXX,Revocation response | head | 200,"The Revocation Endpoint responds with an HTTP 200 code, even if the indicated token does not exist or has already been revoked (so as not to release information).",SPID_CIE_OIDC#Revocation-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#response,OIDC Core,Active,L,Return wrong status code,,,,,,,"If an already-revoked token is not held, an ad-hoc session must be created with two revocation requests",FALSE,,,no,"s1, s1_revoked",E,,P,P,passed,
o,OP-Revocation response-wrong-client_assertion_type,Revocation response to a Request with a wrong client_assertion_type parameter,Revocation response to a Request with a wrong client_assertion_type parameter,Revocation Request with a wrong client_assertion_type parameter in the body,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Revocation response,Does the OP verify the client assertion type of the Revocation Request,"To test if an OP verifies the client assertion type in the Revocation request, a request with a wrong client_assertion_type parameter is sent and the response is analyzed.",OP,Revocation request | body | (?<=client_assertion_type=)([^&]+) | urn-ietf,Revocation response | head | 400 | body | invalid_request,The OP must check that the client_assertion_type value in the Revocation Request is 'urn:ietf:params:oauth:clientassertion-type:jwt-bearer',SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,REVOCATION_REQUEST_NO_CORRECT_CLIENT_ASSERTION_TYPE,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Revocation response-wrong-client_id,Revocation response to a Request with a wrong client id,Revocation response to a Request with a wrong client id,Revocation Request with a wrong client_id parameter in the body,"Compliant if the Revocation response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Revocation response,Does the OP verify the client id of the Revocation Request,"To test if an OP verifies the presence of the client id of the RP in the Revocation request, a request with a wrong client id (not present in the federation) is sent and the response is analyzed.",OP,Revocation request | body | (?<=client_id=)([^&]+) | https://www.example.com/,Revocation response | head | 401 | body | invalid_client,The OP must check that the client_id in the Revocation Request is known inside the Federation.,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,REVOCATION_REQUEST_NO_CORRECT_CLIENT_ID,,,,,TRUE,,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,OP-Token response-access_token,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has the access_token parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token response,Does the successful token response contain access token,The Token response is analyzed and the presence of the access token is checked,OP,,Token response | body | access_token,"If the Token request is correct, the succesful response sent by the OP must contain the access_token parameter, containing the issued access token",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,Are access token supported (HasAccessTokens) Are JWT access token used (HasJwtAccessTokens),,,P4_A,,"3.2.4, 3.2.5",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-correctly-issued,Access Token,Token response,Trigger Token response,"Compliant if the token response has the access_token parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token response,Does the OP issue the access tokens when requested,"In this test an authentication request with scope 'openid' is made. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the access token.",OP,,Token response | body | access_token,The Access Token must be formed according to the standard iGov,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-header-alg,Access Token Header,Token response,Trigger Token response,"Compliant if the alg parameter in the Access Token Header is present, not compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'alg' parameter in the Header,"In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | header | alg",The JWT Access Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,3.4.0,Not present in the description but present in the example. I assumed the signature values,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-header-alg-value-correct,Access Token Header,Token response,Trigger Token response,"Compliant if the alg parameter in the Access Token Header contains a value among RS256 and RS512, not compliant otherwise ",JWT list values,Correct Input,Token response,Does the issued JWT Access Token contain a correct 'alg' parameter in the Header,"In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be a supported asymmetric algorithm between ['RS256', 'RS512']",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | header | alg | [""RS256"", ""RS512""]",The JWT Access Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Mismatch of content,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-header-alg-value-wrong,Access Token Header,Token response,Trigger Token response,"Compliant if the alg parameter in the Access Token Header contains a value among RS256 and RS512, not Compliant if it contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",JWT parameter not in value,Correct Input,Token response,Does the issued JWT Access Token contain a wrong 'alg' parameter in the Header,"In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Access Token is not compliant.",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | header | alg | [""none"", ""HS256"", ""HS384"", ""HS512""]",The JWT Access Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-header-kid,Access Token Header,Token response,Trigger Token response,"Compliant if the JWT Access Token Header has the kid parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'kid' parameter in the Header,"The Access Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the Access Token is not compliant.",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | header | kid",The JWT Access Token Header requires the kid parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,3.4.2,Not present in the description but present in the example,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-header-typ,Access Token Header,Token response,Trigger Token response,"Compliant if the JWT Access Token Header has the typ parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'typ' parameter in the Header,The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | header | typ",The JWT Access Token Header requires the typ parameter and it must be set to 'at+jwt',SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,,Not present in the description but present in the example,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-header-typ-value,Access Token Header,Token response,Trigger Token response,"Compliant if the Access Token Header has the typ parameter and it is set to 'at+jwt', not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Access Token contain the 'typ' parameter valid in the Header,"The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked. Moreover, its value must be set to 'at+jwt', if it is not, than the Access Token is not compliant",OP,,"Token Reponse | head | (?<=""access_token"": "")[^""]+ | header | typ | ""at+jwt""",The JWT Access Token Header requires the typ parameter and it must be set to 'at+jwt',SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Mismatch of parameter,,,,,,,Not present in the description but present in the example,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-aud,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the aud parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'aud' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | aud",The JWT Access Token Payload requires the aud parameter and it must contain the identifier of the resource server,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,"3.4.6, 3.4.7",,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-aud-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the aud parameter set to the identifier of the intended resource server, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT Access Token contain a correct 'aud' parameter,The Access Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload is the identifier of the resource server,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload |  | {""type"":""object"", ""properties"":{""aud"":{""type"":""array""}},""required"":[""aud""]}",The JWT Access Token Payload requires the aud parameter and it must contain the identifier of the resource server,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,L,Type mismatch,,,,,,"3.4.6, 3.4.7",,TRUE,,,yes,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-aud-value,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the aud parameter set to the UserInfo endpoint, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Access Token contain a correct 'aud' parameter,The Access Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload should contain the UserInfo endpoint.,OP,,"Token response | body | (?<=\""access_token\"": \"")[^\""]+ | payload | aud[?(@ =~ /.*\/userinfo.*/)]",The JWT Access Token Payload requires the aud parameter and it must contain the UserInfo endpoint.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Active,M,Missing parameter,,,,,,"3.4.6, 3.4.7",,TRUE,,,yes,s1,E,Problema implementazione,P,F,failed,"Non è presente il path completo, solo /oidc/op/userinfo"
x,OP-Token response-access_token-payload-client_id,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the client_id parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'client_id' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'client_id' parameter in the Payload is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | client_id",The JWT Access Token Payload requires the client_id parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-client_id-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the client_id parameter as an HTTPS URL, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT Access Token contain the 'client_id' parameter in the Payload as an HTTPS url,The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must be an HTTPS URL.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""client_id"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""client_id""]}",The JWT Access Token Payload requires the client_id parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,,,,,,,,FALSE,,,no,s1,E,Problema implementazione,P,F,failed,URL è HTTP non HTTPS
x,OP-Token response-access_token-payload-client_id-value,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the client_id parameter and its value identifies the RP, not Compliant otherwise",Param Check-Save to JWT,Correct Input,Token response,Does the issued JWT Access Token contain the 'client_id' parameter in the Payload and identify the client,The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must identify the client issuing the request,OP,Authentication request | url | client_id | auth_client_id,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | client_id",The JWT Access Token Payload requires the client_id parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-exp,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the exp parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'exp' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | exp",The JWT Access Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,"3.4.11, 3.4.12",,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-exp-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the exp parameter and its value is a timestamp, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT Access Token contain a timestamp as the 'exp' parameter in the Payload,"The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked. In particular, this parameter must be a valid timestamp",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""exp"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""exp""]}",The JWT Access Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,L,Type mismatch,,,,,,"3.4.11, 3.4.12",,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-iat,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the iat claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'iat' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | iat",The JWT Access Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,"3.4.8, 3.4.9, 3.4.10",,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-iat-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the iat claim and its value is a timestamp, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT Access Token contain a correct 'iat' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is a timestamp.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""iat"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""iat""]}",The JWT Access Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,L,Type mismatch,,,,,,"3.4.8, 3.4.9, 3.4.10",,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-iss,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the iss parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'iss' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | iss",The JWT Access Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,"3.4.3, 3.4.4, 3.4.5",,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-iss-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the iss parameter and it is an HTTPS URL, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT Access Token's 'iss' parameter contain an URL,"The Access Token present in the Token Response is analyzed and the 'iss' parameter in the Payload is checked, in particular, its value must be an HTTPS URL",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""iss"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""iss""]}",The JWT Access Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,,,,,,,,FALSE,,,no,s1,E,Problema implementazione,P,F,failed,URL è HTTP non HTTPS
x,OP-Token response-access_token-payload-iss-value,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the iss parameter equals to the URL of the OP, not Compliant otherwise",/ manual: wrong value,Correct Input,Token response,Does the issued JWT Access Token contain the 'iss' parameter in the Payload equals to the URL of the OP,The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter equals to the URL of the OP in the Payload is checked,OP,,,The JWT Access Token Payload requires the iss parameter equals to the URL of the OP,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Mismatch of content,,,,,,"3.4.3, 3.4.4, 3.4.5",,TRUE,,,yes,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-jti,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the jti parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'jti' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | jti",The JWT Access Token Payload requires the jti parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,3.4.14,,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-jti-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the jti parameter in uuid4 format, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT Access Token contain the 'jti' parameter in the Payload in uuid4 format,The Access Token present in the Token Response is analyzed and the value of the 'jti' parameter in the Payload must be based on uuid4 format.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""jti"": {""type"": ""string"", ""pattern"": ""^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$""}}, ""required"": [""jti""]}",The JWT Access Token Payload requires the jti parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,L,Type mismatch,,,,,,3.4.14,,TRUE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-scope,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload contains the scope parameter and its value matches the value in the authentication request, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'scope' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'scope' parameter in the Payload is checked,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | scope",The JWT Access Token Payload requires the scope parameter. It MUST match the value in the authentication request.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-scope-value,Access Token Payload,Token response,Trigger Token response,"Compliant if the scope parameter value in the JWT Access Token Payload matches the value in the authentication request, not Compliant otherwise",Param Check-Save to JWT,Correct Input,Token response,Does the issued JWT Access Token contain a correct 'scope' parameter in the Payload,"The Access Token present in the Token Response is analyzed and the 'scope' parameter in the Payload is checked, in particular, its value MUST match the value in the authentication request.",OP,Authentication request | url | scope | auth_scope,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | scope",The JWT Access Token Payload requires the scope parameter. It MUST match the value in the authentication request.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-payload-sub,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the sub parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT Access Token contain the 'sub' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'sub' parameter in the Payload is checked.,OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | payload | sub",The JWT Access Token Payload requires the sub parameter and it must be 'pairwise',SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-signature,Access Token,Token response,Trigger Token response,"Compliant if the signature of the Access Token is correctly verified using the OP's public key, not compliant otherwise",JWT signature check,Correct Input,Token response,Does the OP correctly sign the Access Token,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained Access Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the access token is passed to a signature verifier correctly configured",OP,,"Token response | body | (?<=""access_token"": "")[^""]+ | X_key_core_OP",The Access Token must be formed according to the standard iGov,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,"3.2.5, 3.2.6",,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Token response-access_token-type,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has a valid JWT access_token parameter, not Compliant otherwise",HTTP parameter type,Correct Input,Token response,Does the successful token response contain a valid access token,In this test a correct Token request is sent and the response is analyzed. It must contain the access token parameter and its value must be a JWT,OP,,"Token response | body | (?<=""access_token"":\s?)""([\w\-]+\.[\w\-]+\.[\w\-]+)""","If the Token request is correct, the succesful response sent by the OP must contain the access_token parameter, containing the issued access token",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,L,Type mismatch,Are access token supported (HasAccessTokens) Are JWT access token used (HasJwtAccessTokens),,,P4_A,,"3.2.4, 3.2.5",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-access_token-with-refresh-request,Token response to a request with grant_type set to refresh_token and a valid refresh_token ,Token response to a request with grant_type set to refresh_token and a valid refresh_token ,Token request with grant_type set to refresh_token and a valid refresh_token,"Compliant if the Token Response contains the Access Token, not compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the OP release Access Tokens with the use of refresh tokens,"In this test the offline_access flow is accomplished and a refresh token is obtained. After this, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The response must include the Access Token",OP,,,"The Refresh Token MUST NOT allow the requesting RP to obtain an ID Token, neither the one previously issued during authentication nor a new ID Token",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Mismatch of parameter,,,,,,,,FALSE,x,,no,"s1, s1.1",E,,P,P,passed,
o,OP-Token response-cache-control-value,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has Cache-Control set to 'no-store', not Compliant otherwise",HTTP parameter presence_1,Correct Input,Token response,Does the token response have Cache-Control set to 'no-store',This test verifies the presence of Cache-Control set to 'no-store' in the token response.,OP,,Token response | head | Cache-Control | no-store,The error Token response must have Cache-Control set to 'no-store',SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,M,Presence of wrong parameter,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro Cache-Control
o,OP-Token response-content_type-if_error,Successful error Token response,Token response,Trigger error Token response,"Compliant if the error token response has application/json set in Content-Type, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the Content-Type in a error token response set correctly?,This test verifies the head Content-Type set to application/json in the error token response.,OP,,,The error Token response must have the Content-Type head set to application/json.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-content_type-value,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has application/json set in Content-Type, not Compliant otherwise",HTTP parameter value,Correct Input,Token response,Does the Content-Type in a token response set correctly?,This test verifies the head Content-Type set to application/json in the token response.,OP,,Token response | head | Content-Type | application/json,The Token response must have the Content-Type head set to application/json.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-correct-request,Correct token response,Token response,Trigger Token response,"Compliant if the response is a an HTTP 200 OK, not compliant otherwise",HTTP Status,Correct Input,Token response,Does the OP handle a correct token request,In this test a normal flow is accomplished and is tried to obtain an Access Token. All requests are well-formed and the Responses of the OP are analyzed.,OP,,Token response | head | 200,Response example,SPID_CIE_OIDC#Token-response https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,L,Wrong handling of status code,,,,,,"3.0.0, 3.2.1",,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-error_description-if_error_grant_type,Successful error Token response,Token response,Trigger error Token response,"Compliant if the error token response has error_description parameter, not Compliant otherwise",/ manual: check type,Correct Input,Token response,Does the error token response have error_description parameter,This test verifies the presence of error_description parameter in the error token response.,OP,,,The error Token response must have error_description parameter,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-error-if_error,Successful error Token response,Token response,Trigger error Token response,"Compliant if the error token response has error parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the error token response have error parameter,This test verifies the presence of error parameter in the error token response.,OP,,,The error Token response must have error parameter,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-error-value,Token Error response,Token response,Trigger Token response,"Compliant if the Token Response has the error parameter and it is set to a value among 'invalid_request', 'invalid_client', 'unsupported_grant_type', 'invalid_grant', 'server_error', or 'temporarily_unavailable'. Not Compliant otherwise",/ manual: wrong parameter,Correct Input,Token response,Does the Token error response contain a correct error parameter,"The Token error response is analyzed and the the error parameter in it is checked. It must have a value among 'invalid_request', 'invalid_client', 'unsupported_grant_type', 'invalid_grant', 'server_error', or 'temporarily_unavailable'",OP,,"Token response | body | error | [""invalid_request"", ""invalid_client"", ""unsupported_grant_type"", ""invalid_grant"", ""server_error"", ""temporarily_unavailable""]","If the Token Request (both ID Token and Refresh Token) is invalid or unauthorized, the OP constructs the error response. This response needs to have the error parameter with the error code ('invalid_request' or 'unauthorized_client')",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,M,Presence of wrong parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-expires_in,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has the expires_in parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token response,Does the OP issue the expires_in in a token response,"In this test an RP makes a correct authentication request and, once received the code, the RP tries to exchange it in the token endpoint. The response is then analyzed and it must contain the expires_in parameter",OP,,Token response | body | expires_in,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,Are refresh tokens supported (HasRefreshTokens),,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
openid profile email
offline_access","3.2.9, 3.2.10",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-grant_type-refresh,Token request,Token response,Token request with grant_type refresh token but missing the necessary refresh token in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Token response,Does the OP accept a token request using the grant_type set to 'refresh_token' but without the necessary refresh token,"When an RP sends a token request using the refresh token, the OP must check the presence of the grant_type parameter in the request but also the presence of the refresh token. In order to check whether the OP accomplish this control, a token request without a refresh token is sent and the response analyzed",OP,,,An RP doing a Token Request using a refresh token must insert the grant_type parameter in the request with the value 'refresh_token' and the refresh_token parameter,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
o,OP-Token response-HTTP_status-value,Successful Token response,Token response,Trigger Token response,"Compliant if the HTTP status code of a token response is 200, not Compliant otherwise",HTTP Status,Correct Input,Token response,Does the HTTP status of a token response correct?,This test verifies whether the HTTP status of a token response is 200.,OP,,Token response | head | 200,The Token response must be an HTTP 200.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,L,Wrong handling of status code,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has the id_token parameter containing a value in JWT format, not Compliant otherwise",HTTP parameter presence,Correct Input,Token response,Does the successful token response contain the ID token,The RP receiving the Token response and that sent a correct token request must check the presence of the ID token,OP,,Token response | body | id_token,"If the authorization request is correct, the succesfull response sent by the OP must contain the id_token parameter, containing the ID Token value in JWT format",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,,,"3.2.14, 3.2.15",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-encryption,ID Token,Token response,Trigger Token response,"Compliant if the ID Token obtained in the Token Response is a nested signed and encrypted JWT, not compliant otherwise",/ manual: check signature,Correct Input,Token response,Does the OP encrypt the ID Token when the 'id_token_encrypted_response_alg' parameter is exposed in the RP's metadata,"To test this OP functionality, a flow is started using an RP that exposes the 'id_token_encrypted_response_alg' parameter. Once received the ID Token, it has to be not only signed but also encrypted",OP,,,If the RP exposes in its metadata the parameter id_token_encrypted_response_alg the OP MUST encrypt the ID Token. In this case the ID Token MUST be a nested signed and encrypted JWT,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro id_token_encrypted_response_alg
x,OP-Token response-id_token-header-alg,ID Token Header,Token response,Trigger Token response,"Compliant if the ID Token Header has the alg parameter, not compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain a correct 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | header | alg",The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-header-alg-value-correct,ID Token Header,Token response,Trigger Token response,"Compliant if the ID Token Header has the alg parameter and contains one of the values in the OP's metadata, not compliant otherwise",/ manual: wrong value,Correct Input,Token response,Does the issued JWT ID Token contain a correct 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be an asymmetric algorithm between those defined in the 'id_token_signing_alg_values_supported' parameter of the OP's metadata",OP,OP's EC,,The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Mismatch of content,,Asymmetric ID Token signature with RS256,,,,3.3.0,Not present in the description of the ID Token but present in the example. I assumed the signature values,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Token response-id_token-header-alg-value-wrong,ID Token Header,Token response,Trigger Token response,"Not compliant if the alg parameter in the ID Token contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",JWT parameter not in value,Correct Input,Token response,Does the issued JWT ID Token contain a wrong 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the ID Token is not compliant.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | header | alg | [""none"", ""HS256"", ""HS384"", ""HS512""]",The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-header-kid,ID Token Header,Token response,Trigger Token response,"Compliant if the JWT ID Token Header has the kid parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'kid' parameter in the Header,"The ID Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the ID Token is not compliant.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | header | kid",The JWT ID Token Header requires the kid parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,M,Missing parameter,Are all required required claims present (HasRequiredClaims),ID Token has kid claim,,,,3.3.2,Not present in the description but present in the example,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-acr,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the acr_value claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'acr' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | acr",The JWT ID Token Payload requires the acr parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,,Support acr_values request parameter,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
opeind, profile e
offline_access. Verifica
degli attributi dell'User
Info","3.3.9, 3.3.11",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-acr-value,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the acr claim equal or higher than acr_values requested within the authorization request, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT ID Token contain the 'acr' parameter valid in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked. It must be equal or superior to the acr send from the RP in the Authentication Request.",OP,,,The JWT ID Token Payload requires the acr parameter and must be set to the 'acr_value' that is satisfied by the OP in the Authentication Request,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Mismatch of parameter,,Support acr_values request parameter,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
opeind, profile e
offline_access. Verifica
degli attributi dell'User
Info","3.3.9, 3.3.11",,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-id_token-payload-acr-value-correct,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the acr claim and its value is one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Token response,Does the issued JWT ID Token contain correct value of 'acr' parameter valid in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked. Its value is one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']. It must be equal or superior to the acr send from the RP in the Authentication Request.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | acr | [""https://www.spid.gov.it/SpidL1"", ""https://www.spid.gov.it/SpidL2"", ""https://www.spid.gov.it/SpidL3""]","The JWT ID Token Payload requires the acr parameter and must be one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']",SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-at_hash,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the at_hash parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does ID token payload contain the 'at_hash' parameter,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'at_hash' parameter in the Payload is checked",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | at_hash",The JWT ID Token Payload requires the at_hash parameter and its value must match the Access Token returned with the Token ID,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,Is the at_hash claim present (IsAccessTokenHashPresent),,,,,"3.3.12, 3.3.13",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-at_hash-value,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token's at_hash parameter value matches the Access Token returned with the Token ID, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does ID token payload contain a correct 'at_hash' parameter,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'at_hash' parameter in the Payload is checked. In particular, its value must match the base64url encoding of the left-most half of the hash of the octets of the ASCII representation of the access_token value the Access Token returned with the Token ID",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | at_hash",The JWT ID Token Payload requires the at_hash parameter and its value must match the Access Token returned with the Token ID. Its value is the base64url encoding of the left-most half of the hash of the octets of the ASCII representation of the access_token value,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Mismatch of parameter,,,,,,"3.3.12, 3.3.13",,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-aud,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the aud parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'aud' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'aud' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | aud",The JWT ID Token Payload requires the aud parameter and it must contain the RP's client_id,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,Is the token audience set (HasCorrectAudience),ID Token has aud claim,,,,"3.3.7, 3.3.8",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-exp,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the exp claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'exp' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'exp' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | exp",The JWT ID Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,,,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
opeind, profile e
offline_access. Verifica
degli attributi dell'User
Info","3.3.19, 3.3.20",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-exp-type,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the exp claim and its value is a timestamp, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT ID Token contain a correct 'exp' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the type of the 'exp' parameter in the Payload is checked. In particular, its value must be a timestamp",OP,,"Token response | body | (?<=id_token: "")([^""]+) | payload |  | {""type"": ""object"", ""properties"": {""exp"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""exp""]}",The JWT ID Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,L,Type mismatch,,,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
opeind, profile e
offline_access. Verifica
degli attributi dell'User
Info","3.3.19, 3.3.20",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-iat,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the iat claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'iat' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | iat",The JWT ID Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,Are all required required claims present (HasRequiredClaims),ID Token has iat claim,,,,"3.3.14, 3.3.15, 3.3.16",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-iat-type,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the iat claim and its value is a timestamp, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT ID Token contain a correct 'iat' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked. In particular, its value must be a timestamp",OP,,"Token response | body | (?<=id_token: "")([^""]+) | payload |  | {""type"": ""object"", ""properties"": {""iat"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""iat""]}",The JWT ID Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,L,Type mismatch,Are all required required claims present (HasRequiredClaims),ID Token has iat claim,,,,"3.3.14, 3.3.15, 3.3.16",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-iss,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the iss parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'iss' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | iss",The JWT ID Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,Is the token issuer set (HasCorrectIssuer),ID Token has iss claim,,,,"3.3.3, 3.3.4, 3.3.5",,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-id_token-payload-iss-type,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the iss parameter as an HTTPS URL that identifies the OP, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT ID Token contain the 'iss' parameter in the Payload as an HTTPS URL,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter has to be an HTTPS URL identifying the OP",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""iss"": {""type"": ""string"", ""const"": ""X_https_OP""}}, ""required"":[""iss""]})",The JWT ID Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,Is the token issuer set (HasCorrectIssuer),ID Token has iss claim,,,,"3.3.3, 3.3.4, 3.3.5",,TRUE,x,,no,s1,E,Problema implementazione,P,F,failed,URL è HTTP non HTTPS
o,OP-Token response-id_token-payload-iss-value,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the iss parameter equals to the URL of the OP, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Token response,Does the issued JWT ID Token contain the 'iss' parameter in the Payload equals to the URL of the OP,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'iss' parameter is checked equals to the URL of the OP",OP,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | iss",Entity Configuration response OP | body | [^\r\n]* | payload | iss | saved_iss,The JWT ID Token Payload requires the iss parameter and it must be equal to the URL of the OP,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-jti,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the jti claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'jti' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'jti' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | jti",The JWT ID Token Payload requires the jti parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,,,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
opeind, profile e
offline_access. Verifica
degli attributi dell'User
Info",3.3.23,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-nonce,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the nonce claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'nonce' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | nonce",The JWT ID Token Payload requires the nonce parameter and it must be set to the nonce value sent in the Authentication Request,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,Is the nonce present in the ID token (NoncePresentInToken),ID Token has nonce when requested for code flow,,,,"3.3.24, 3.3.25",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-nonce-value,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the nonce claim and its value is the same as the nonce in the Authentication Request made before, not Compliant otherwise",/ manual: wrong parameter,Correct Input,Token response,Does the issued JWT ID Token contain the 'nonce' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked. In particular, its value must be set to the 'nonce' value set in the Authentication Request",OP,,,The JWT ID Token Payload requires the nonce parameter and it must be set to the nonce value sent in the Authentication Request,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Presence of wrong parameter,Is the nonce present in the ID token (NoncePresentInToken),ID Token has nonce when requested for code flow,,,,"3.3.24, 3.3.25",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-payload-sub,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the sub parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Token response,Does the issued JWT ID Token contain the 'sub' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'sub' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | sub",The JWT ID Token Payload requires the sub parameter and it must be 'pairwise',SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,M,Missing parameter,Are all required required claims present (HasRequiredClaims),ID Token has sub claim,,,,3.3.6,,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-id_token-payload-sub-type,ID Token Payload,Token response,Trigger Token response,"Compliant if the sub parameter in the ID Token is a string, not Compliant otherwise",JWT parameter type,Correct Input,Token response,Does the issued JWT ID Token contain a correct 'sub' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the 'sub' parameter is checked to be a string",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload |  | {""type"": ""object"", ""properties"": {""sub"": {""type"": ""string"", ""pattern"": ""^[0-9a-f]{64}$""}}, ""required"": [""sub""]}",The JWT ID Token Payload requires the sub parameter and it must be a string of type pairwise,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,L,Type mismatch,Are all required required claims present (HasRequiredClaims),ID Token has sub claim,,,,3.3.6,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-signature,ID Token,Token response,Trigger Token response,"Compliant if the signature part of the ID Token is correctly verified using the OP's public key, not compliant otherwise",JWT signature check,Correct Input,Token response,Does the OP correctly sign the ID Token,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained ID Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the third part of the string is taken and passed to a signature verifier correctly configured",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | X_key_core_OP",The ID Token is a JSON Web Token (JWT) that contains information on the user that has executed the authentication.,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,Is the ID token signed (IsSigned),Does the OP sign the ID Token and with what,,,,3.2.16,,TRUE,x,,yes,s1,E,,P,P,passed,
x,OP-Token response-id_token-type,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has a valid JWT id_token parameter, not Compliant otherwise",HTTP parameter type,Correct Input,Token response,Does the successful token response contain a valid ID token,The RP receiving the Token response and that sent a correct token request must check the presence of a valid ID token,OP,,"Token response | body | (?<=""id_token"":\s?)""([\w\-]+\.[\w\-]+\.[\w\-]+)""","If the authorization request is correct, the succesfull response sent by the OP must contain the id_token parameter, containing the ID Token value in JWT format",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,L,Type mismatch,,,,,,"3.2.14, 3.2.15",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-id_token-with-refresh-request,Token Response containing refresh_token,Token Response,Token request with grant_type set to refresh_token and a valid refresh_token ,"Compliant if the Token Response does not contain the ID Token, not compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the OP release ID Tokens with the use of refresh tokens,"In this test the offline_access flow is accomplished and a refresh token is obtained. After this, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The response must not include the ID Token",OP,,,"The Refresh Token MUST NOT allow the requesting RP to obtain an ID Token, neither the one previously issued during authentication nor a new ID Token",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Mismatch of parameter,,,,,,,,FALSE,x,,no,"s1, s1.1",E,,F,P,passed,id_token è presente
x,OP-Token response-refresh_token_signature,Refresh token,Token response,Authentication request with scope offline_access and prompt contains consent,"Compliant if the signature of the Refresh token is correctly verified using the OP's public key, not compliant otherwise",/ manual: check signature,Correct Input,Token response,Does the OP correctly sign the Refresh Token,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test an offline_access flow is performed and the obtained Refresh token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the Refresh token is passed to a signature verifier correctly configured",OP,,Token response | body | refresh_token | XXX,The Refresh Token MUST be a signed JWT,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,3.2.11,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token_wrongly_issued,Token Response without refresh_token,Token Response,Authentication request with scope profile and prompt contains consent,"Compliant if the token response does not contain the refresh_token parameter, not Compliant otherwise",HTTP parameter not present,Correct Input,Token response,Does the OP issue refresh tokens even when it is not supposed to,"In this test an RP makes an authentication request with an arbitrary scope that differs from 'offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must not contain the refresh token.",OP,,Token response | body | refresh_token,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access and prompt=consent)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,M,Presence of wrong parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-after-access_token-revocation,Token Response,Token Response to a request with refresh token ,Token request with grant_type set to refresh_token and a refresh_token whose corresponding access_token was revoked,"Compliant if the OP sends a successful token response, not compliant otherwise",/ manual: check flow,Correct Input,Token response,Does the OP revoke the Refresh Token when revoking an Access Token,"In order to test if the OP revokes a refresh token together with the access token revocation, a classic authentication flow is computed and, once obtained the access token and the refresh token, the access token is used to login. Finally, a logout is performed (thus revocating the access token), a token request using the refresh token is accomplished and the OP's response analyzed.",OP,,,The Access Token revocation MUST NOT imply revoking all the Refresh Tokens linked to it.,SPID_CIE_OIDC#revocation-endpoint; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html,OIDC Core,Passive,L,Incorrect handling,Are refresh tokens revoked after access token revocation (AccessRevokesRefresh),,,,,,"The OAuch outcome is in contrast with ours and with the one in the specification: for OAuch if the related refresh token is revoked, than this is compliant, in the CIE scenario it is not",TRUE,x,,yes,"s1, s1.1",E,,P,P,passed,
x,OP-Token response-refresh_token-already-used,Token Response,Token Response to a request with an already-used refresh token ,Token request with offline_access grant type and an already-used refresh token in it,"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Token response,Does the OP invalidate already-used refresh tokens,"A Token Request with the grant_type=refresh_token and the refresh token in it is sent. Even if the response will contain a new access token and a new refresh token, the next step is trying to refresh again the access token with the already-used refresh token and analyze the response",OP,,,"For security reasons, an OP MUST return, along with a new Access Token, also a new Refresh Token, invalidating all previously issued tokens (refresh token rotation) to the RP and related to the end-user",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is the active refresh token revoked after a multi-exchange (InvalidatedRefreshToken),,test_grant_refresh_token_two_times,,,,,TRUE,x,,yes,"s1, s1.1, s1.2",E,,P,P,passed,
x,OP-Token response-refresh_token-correct-signature,Successful Token response,Token response,Authentication request with scope offline_access and prompt contains consent,"Compliant if the refresh_token obtained in the token response is a valid JWT, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the OP issue valid refresh tokens,"In this test an RP makes an authentication request with scope offline_access and the parameter prompt set to consent. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain a valid refresh token. Once obtained, the token must be validated with the proper validation algorithm and public key",OP,Authentication request | url | scope | openid offline_access | prompt | consent,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | XXX","The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access and prompt=consent)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,L,Type mismatch,Are refresh tokens supported (HasRefreshTokens),,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
openid profile email
offline_access","3.2.9, 3.2.10",,TRUE,x,,yes,s1,E,,P,P,passed,
o,OP-Token response-refresh_token-header-alg,Refresh Token Header,Token response,Trigger Token response,"Compliant if the alg parameter in the Refresh Token Header is present, not compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain the 'alg' parameter in the Header,"In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | header | alg",The JWT Refresh Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Refresh-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
o,OP-Token response-refresh_token-header-alg-value-correct,Refresh Token Header,Token response,Trigger Token response,"Compliant if the alg parameter in the Refresh Token Header contains a value among RS256 and RS512, not compliant otherwise ",/ manual: check content,Correct Input,Token response,Does the issued JWT Refresh Token contain a correct 'alg' parameter in the Header,"In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be a supported asymmetric algorithm between ['RS256', 'RS512']",OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | header | alg | [""RS256"", ""RS512""]",The JWT Refresh Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Refresh-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,H,Mismatch of content,,,,,,,,,,,no,s1,E,,P,P,passed,
o,OP-Token response-refresh_token-header-alg-value-wrong,Refresh Token Header,Token response,Trigger Token response,"Compliant if the alg parameter in the Refresh Token Header contains a value among RS256 and RS512, not Compliant if it contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",/ manual: wrong parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain a wrong 'alg' parameter in the Header,"In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.",OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | header | alg | [""none"", ""HS256"", ""HS384"", ""HS512""]",The JWT Refresh Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Refresh-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,H,Presence of a wrong parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-aud-presence,Refresh Token Payload,Token response,Trigger Token response,"Compliant if the JWT Refresh Token Payload has the aud parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain the 'aud' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | payload | aud",The Refresh Token MUST contain the aud parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-aud-type,Access Token Payload,Token response,Trigger Token response,"Compliant if the JWT Access Token Payload has the aud parameter set to a list, not Compliant otherwise",/ manual: check type,Correct Input,Token response,Does the issued JWT Access Token contain a correct type of 'aud' parameter,The Access Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload is a list.,OP,,"Token response | body | (?<=""refresh_token"": "")[^""]+ | payload | aud | ^\[\s*""[^""]*""(?:,\s*""[^""]*"")*\s*\]$",The JWT Access Token Payload requires the aud parameter and it must contain the identifier of the resource server and at least the UserInfo endpoint.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Passive,L,Type mismatch,,,,,,"3.4.6, 3.4.7",,TRUE,,,yes,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-aud-value,Refresh Token,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload has the aud parameter set to the Token Endpoint, not Compliant otherwise",/ manual: wrong parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain correct 'aud' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload set to the Token Endpoint taken from the Entity Configuration OP.,OP,,"Token response | head | (?<=\""refresh_token\"": \"")[^\""]+ | payload | aud[?(@ =~ /.*\/userinfo.*/)]",The JWT Refresh Token Payload requires the aud parameter and it must contain the Token Endpoint.,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,"il valore salvato del token_endpoint è ""http://cie-provider.org:8002/oidc/op/token"", mentre quello in aud è ""http://relying-party.org:8001"""
x,OP-Token response-refresh_token-payload-exp-presence,Refresh Token Payload,Token response,Trigger Token response,"Compliant if the JWT Refresh Token Payload contains the exp parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain correct 'exp' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked,OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | payload | exp",The Refresh Token MUST contain the exp parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-exp-type,Refresh Token,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload contains the exp parameter which is a timestamp, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain correct type of 'exp' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the value of the 'exp' parameter in the Payload is a timestamp,OP,,"Token response | head | (?<=\""refresh_token\"": \"")[^\""]+ | payload | exp | timestamp",The Refresh Token MUST contain the exp parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-iat-presence,Refresh Token Payload,Token response,Trigger Token response,"Compliant if the JWT Refresh Token Payload contains the iat claim, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain 'iat' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked,OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | payload | iat",The Refresh Token MUST contain the iat parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-iat-type,Refresh Token,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload contains the iat claim and its value is a timestamp, not Compliant otherwise",/ manual: check type,Correct Input,Token response,Does the issued JWT Refresh Token contain 'iat' parameter in the Payload,"The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked. In particular, its value must be a timestamp",OP,,"Token response | head | (?<=\""refresh_token\"": \"")[^\""]+ | payload | iat | timestamp",The Refresh Token MUST contain the iat parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-iss-presence,Refresh Token Payload,Token response,Trigger Token response,"Compliant if the JWT Refresh Token Payload has the iss parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain the 'iss' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked.,OP,,"Token response | body | (?<=\""refresh_token\"": \"")[^\""]+ | payload | iss",The Refresh Token MUST contain the iss parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-iss-type,Refresh Token,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the iss parameter in the JWT Refresh Token Payload contains an HTTPS URL identifying the OP, not Compliant otherwise",/ manual: check type,Correct Input,Token response,Does the issued JWT Refresh Token contain correct 'iss' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the value of the 'iss' parameter is an HTTPS URL.,OP,,"Token response | head | (?<=\""refresh_token\"": \"")[^\""]+ | payload | iss | url",The Refresh Token MUST contain the iss parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-iss-value,Refresh Token Payload,Token response,Trigger Token response,"Compliant if the JWT Refresh Token Payload has the iss parameter equal to the URL of the OP, not Compliant otherwise",/ manual: wrong parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain the 'iss' parameter in the Payload equal to the URL of the OP,The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked equal to the URL of the OP,OP,,,The Refresh Token MUST contain the iss parameter equal to the URL of the OP,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-jti-presence,Refresh Token Payload,Token response,Trigger Token response,"Compliant if the JWT Refresh Token Payload contains the jti parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the issued JWT Refresh Token contain 'jti' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked,OP,,Token response | body | refresh_token | payload | jti,The Refresh Token MUST contain the jti parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Token response-refresh_token-payload-jti-type,Refresh Token,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload contains the jti parameter and it is in uuid4 format, not Compliant otherwise",/ manual: check type,Correct Input,Token response,Does the issued JWT Refresh Token contain a correct 'jti' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked. Its value (unique identifier of Refresh Token) must be based on uuid4 format,OP,,Token response | head | refresh_token | payload | jti | uuid4,The Refresh Token MUST contain the jti parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
o,OP-Token response-refresh_token-presence,Successful Token response,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the token response has the refresh_token parameter, not Compliant otherwise",/ manual: check parameter,Correct Input,Token response,Does the OP issue the refresh tokens when requested,"In this test an RP makes an authentication request with scope 'offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the refresh token.",OP,Authentication request | url | scope | openid offline_access | prompt | consent,Token response | body | refresh_token,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,M,Missing parameter,Are refresh tokens supported (HasRefreshTokens),,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
openid profile email
offline_access","3.2.9, 3.2.10",,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-refresh_token-type,Successful Token response,Token response,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the refresh_token is a JWT, not Compliant otherwise",/ manual: check type,Correct Input,Token response,Does the OP issue a correct type of refresh tokens when requested,"In this test an RP makes an authentication request with scope 'openid offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain a JWT refresh token.",OP,Authentication request | url | scope | openid offline_access | prompt | consent,Token response | body | refresh_token | JWT,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Active,L,Type mismatch,Are refresh tokens supported (HasRefreshTokens),,,,"Accesso L1 con protocollo
OIDC e scope valorizzato
openid profile email
offline_access","3.2.9, 3.2.10",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-require-assertion-iss,Token response,Token response,Token request with a client assertion without iss claim,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter not containing iss claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the iss claim is missing.,OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | iss |  | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,Ritorna 403 unauthorized_client
x,OP-Token response-require-assertion-sub,Token response,Token response,Token request with a client assertion without sub claim,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion field not containing sub claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the sub claim is missing,OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | sub |  | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403 unauthorized_client
x,OP-Token response-require-client_assertion,Token request without the client_assertion parameter,Token response to a request without the client_assertion,Token request without the client_assertion parameter in the body,"Compliant if the Token response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made without the client_assertion parameter return a Token Error response,This test consists in sending a token request without the client_assertion parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=client_assertion=)([^&]+) | ,Token response | head | 401 | body | invalid_client,An RP doing a Token Request must insert the client_assertion parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is JWT authentication implemented (SupportsJwtClientAuthentication),,,,,,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,OP-Token response-require-client_assertion_type,Token request without the client_assertion_type parameter,Token response to a request without the client_assertion_type parameter,Token request without the client_assertion_type parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made without the client_assertion_type parameter return a Token Error response,This test consists in sending a token request without the client_assertion_type parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=client_assertion_type=)([^&]+) | ,Token response | head | 400 | body | invalid_request,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-require-client_id,Token request without the client_id parameter,Token response to a request without the client_id parameter,Token request without the client_id parameter in the body,"Compliant if the Token response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Token response,Does the OP require the client_id in the token request,This test consists in sending a token request without the client_id parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=client_id=)([^&]+) | ,Token response | head | 401 | body | invalid_client,An RP doing a Token Request must insert the client_id parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is client id required (IsClientIdRequired),,test_token_endpoint_no_client_id,,,,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,OP-Token response-require-code,Token request without the code parameter,Token response to a request without the code parameter,Token request without the code parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_grant, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made without the code parameter return a Token Error response,This test consists in sending a token request without the code parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=code=)([^&]+) | ,Token response | head | 400 | body | invalid_grant,An RP doing a Token Request must insert the code parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400
x,OP-Token response-require-code_verifier,Token request without the code_verifier parameter,Token response request without the code_verifier parameter,Token request without the code_verifier parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_grant, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made without the code_verifier parameter return a Token Error response,This test consists in sending a token request without the code_verifier parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=code_verifier=)([^&]+) | ,Token response | head | 400 | body | invalid_grant,An RP doing a Token Request must insert the code_verifier parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Token response-require-grant_type,Token request without the grant_type parameter,Token response to a request without the grant_type parameter,Token request without the grant_type parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made without the grant_type parameter return a Token Error response,This test consists in sending a token request without the grant_type parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=grant_type=)([^&]+) | ,Token response | head | 400 | body | invalid_request,An RP doing a Token Request must insert the grant_type parameter in the request with the value 'authorization_code',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-token_type,Successful Token response,Token response,Trigger Token response,"Compliant if the token response has the token_type parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token response,Does the successful token response contain the token type,The RP receiving the Token response and that sent a correct token request must check the presence of the token type,OP,,Token response | body | token_type,"If the authorization request is correct, the succesfull response sent by the OP must contain the token_type parameter set to 'Bearer'",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,,,"3.2.7, 3.2.8",,TRUE,x,,no,s1,E,,P,P,passed,
o,OP-Token response-token_type-value,Successful Token response,Token response,Trigger Token response,"Compliant if the token_type value in token response is Bearer, not Compliant otherwise",HTTP parameter value,Correct Input,Token response,Does the token_type of a token response set correctly?,This test verifies whether the token_type of a token response is Bearer.,OP,,Token response | body | token_type | Bearer,The token_type of a Token response must be Bearer.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-token-rotation,Token Response,Token Response to a request with refresh token ,Token request with offline_access grant type and a valid refresh token in it,"Compliant if the response has a new refresh token, not compliant otherwise",/ manual: check content,Correct Input,Token response,Does the OP use token rotation,A Token Request with the grant_type=refresh_token and the refresh token in it is sent. The response must contain a new refresh token.,OP,,,"For security reasons, an OP MUST return, along with a new Access Token, also a new Refresh Token, invalidating all previously issued tokens (refresh token rotation) to the RP and related to the end-user",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Active,M,Mismatch of content,Is refresh token rotation used (UsesTokenRotation),,,,Accesso L1 con protocollo OIDC e scope valorizzato openid e offline_access. Verifica della Refresh Token Rotation,,,TRUE,x,,yes,"s1, s1.1",E,,P,P,passed,
x,OP-Token response-url-missing-client_id,Token response,Token response,Token request without the client_id parameter in the URL,"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Token response,Does the OP check the client_id in the request,In this test the client_id parameter in the URL of the token request is removed and the response analyzed,OP,Token request | body | (?<=client_id=)([^&]+) | ,Token response | head | 400 | body | invalid_request,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Token response-wrong-assertion-aud,Token response,Token response,Token request with a client assertion without the URL of the OP's token endpoint in the aud claim,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong aud claim not containing the OP's Token endpoint in JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the aud claim does not contain the OP's Token endpoint,OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | aud | https://www.example.com | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the aud claim. This claim must be set to the URL of the OP’s Token Endpoint.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403 unauthorized_client
x,OP-Token response-wrong-assertion-exp,Token response,Token response,Token request with a client assertion with an expiration time (exp) set before the request,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong exp claim in the JWT return a Token Error response,"In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular, the exp claim is wrong",OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | exp | 1681716340 | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the exp claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,Ritorna 403 unauthorized_client
x,OP-Token response-wrong-assertion-iat,Token response,Token response,Token request with a client assertion with an issued time (iat) set after the request,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong iat claim in the JWT return a Token Error response,"In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular, the iat claim is wrong",OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | iat | 1681716340 | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iat claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200
x,OP-Token response-wrong-assertion-iss,Token response,Token response,Token request with a client assertion with the iss claim not set to the RP's client ID,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong iss claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the iss claim is not set to the RP's client ID,OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | iss | https://www.example.com/ | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,Ritorna 403 unauthorized_client
x,OP-Token response-wrong-assertion-jti,Token response to a request with a client assertion with a jti already used,Token response to a request with a client assertion with a jti already used,Token request with a client assertion with a jti already used in the life time of the JWT (JWT replay),"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",/ manual: check flow,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter containing an already used jti in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the jti has already been used.,OP,,Token response | head | 400 | Token response | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the jti claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,"s1_revoked, s1",E,Problema implementazione,F,F,failed,[SAME] Ritorna 200
x,OP-Token response-wrong-assertion-signature,Token request with a wrong signature,Token response to a request with a client_assertion with a wrong signature,Token request with a client_assertion parameter in the body with a wrong signature,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Signature JWT Response,Wrong Input,Token response,Does the token response to a token request made with a wrong signature return a Token Error response,"In this test a classic flow is accomplished and, when exchanging the code for an access token, the client_assertion parameter is taken and the signature is substitute with a wrong one. The OP's response is analyzed",OP,Token request | body | (?<=client_assertion=)([^&]+) | X_wrong_key,Token response | head | 400 | body | invalid_request,The client assertion parameter is a JWT signed with the Relying Party's private key,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403 unauthorized_client
x,OP-Token response-wrong-assertion-signature-key,Token response to a request with a client assertion signed with a wrong key,Token response to a request with a client assertion signed with a wrong key,Token Request with the client_assertion parameter in the url being a JWT with a wrongly signed signature,"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",Signature JWT Response,Wrong Input,Token response,Does the OP's token endpoint refuse assertions signed with a wrong key,"In this test a classic flow is accomplished and, when exchanging the code for an access token, the signature is done with a wrong key. The OP's response is analyzed",OP,Token request | body | (?<=client_assertion=)([^&]+) | X_wrong_key,Token response | head | 400 | body | invalid_request,The client assertion parameter is a JWT signed with the Relying Party's private key,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403 unauthorized_client
x,OP-Token response-wrong-assertion-sub,Token response,Token response,Token request with a client assertion with sub claim not set to the RP's client ID,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",JWT Response,Wrong Input,Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong sub claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the sub claim is not set to the RP's client ID,OP,Token request | body | (?<=client_assertion=)([^&]+) | payload | sub | https://www.example.com | X_key_core_RP,Token response | head | 400 | body | invalid_request,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403 unauthorized_client
x,OP-Token response-wrong-client_assertion_type,Token request with a wrong client_assertion_type parameter,Token response to a request with a wrong client_assertion_type parameter,Token request with a wrong client_assertion_type parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made with an incorrect client_assertion_type parameter return a Token Error response,This test consists in sending a token request with a wrong client_assertion_type parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=client_assertion_type=)([^&]+) | urn-aert,Token response | head | 400 | body | invalid_request,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Token response-wrong-code,Token request with a wrong code parameter,Token response to a request with a wrong code parameter,Token request with a wrong code parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_grant, not compliant otherwise",Param Response,Wrong Input,Token response,"Does the token response to a token request made with an incorrect code parameter (i.e., not belonging to that client ID or a random code) return a Token Error response",This test consists in sending a token request with a wrong code parameter (thus not for that client ID or a random code) and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=code=)([^&]+) | X_wrong_code,Token response | head | 400 | body | invalid_grant,An RP doing a Token Request must insert the code parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is the authorization code bound to the client (IsCodeBoundToClient),,,,,,Is it bound or not?,TRUE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400
x,OP-Token response-wrong-code_verifier,Token request with a wrong code_verifier parameter,Token response to a request with a wrong code_verifier parameter,Token request with a wrong code_verifier parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Token response,Does the token response to a token request made with an incorrect code_verifier parameter return a Token Error response,This test consists in sending a token request with a wrong code_verifier parameter and analyzing the token response. The response must be a Token Error response.,OP,Token request | body | (?<=code_verifier=)([^&]+) | X_wrong_code,Token response | head | 400 | body | invalid_request,An RP doing a Token Request must insert the code_verifier parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Token response-wrong-grant_type-value,Token response,Token response to a request with a wrong grant_type parameter,Token request with the grant_type parameter in the body set to example,"Compliant if the Token response is an HTTP 400 because of unsupported_grant_type, not compliant otherwise",Param Response,Wrong Input,Token response,Does the OP checks that the token request contains the grant_type parameter set correctly,"In order to validate if the OP checks the token request sent by the RP, in this test we send the grant_type parameter in the request set to and invalid value, just like 'example' and analyze the response",OP,Token request | body | (?<=grant_type=)([^&]+) | example,Token response | head | 400 | body | unsupported_grant_type,"An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code', than it must contain the code and the code_verifier",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,OP-Userinfo response-access_token-wrong-payload,UserInfo request with errors,Userinfo response to a request with an Access Token with a wrong payload,Userinfo request with an Access Token with a wrong payload,"Compliant if the Userinfo Response is an HTTP 401 because of invalid_client, not compliant otherwise",/ manual: check flow,Wrong Input,Userinfo response,Does the OP correctly validate the Access Tokens,"In order to test if the OP's UserInfo endpoint correctly validates the Access Tokens, a UserInfo Request with an Access Token with a wrong payload, wrong client_id is sent and the OP's response analyzed",OP,,,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,test_userinfo_endpoint_no_issued_token_session,,,,,TRUE,x,,,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
o,OP-Userinfo response-content_type,UserInfo response,Userinfo response,Trigger Userinfo response,"Compliant if the Content-Type is 'application/jwt', not compliant otherwise",HTTP parameter value_1,Correct Input,Userinfo response,Does the Content-Type of the UserInfo response set to 'application/jwt',The Content-Type of the UserInfo response must be set to 'application/jwt' ,OP,,UserInfo response | head | Content-Type | application/jwt,Tthe Content-Type of the UserInfo response must be set to 'application/jwt',SPID_CIE_OIDC#UserInfo Response#response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Mismatch of content,,,,,,,ONLY FOR SPID,FALSE,x,,no,s1,E,,F,P,passed,application/jose https://openid.net/specs/openid-connect-core-1_0.html#UserInfoResponse
x,OP-Userinfo response-correct-release,UserInfo response to a refreshed access token,Userinfo response to a request with a refreshed Access token,Trigger Userinfo response to a refreshed access token,"Compliant if the claim issued by the two UserInfo response are the same, not compliant otherwise",/ manual: check content,Correct Input,Userinfo response,Does the OP release only previously accepted information when presenting a refresh token,"In this test the offline_access flow is accomplished, obtaining a refresh token and an access token. After this, a UserInfo request is sent with the access token and the released information saved. Once obtained the information, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The access token included in the latter response is then taken, a UserInfo Request is made with it and the results compared. The last UserInfo Response must contain exactly the claims issued with the previous one",OP,,,The Refresh Token MAY be used as a mechanism to obtain from the UserInfo endpoint only the same set of user attributes requested at the initial authentication phase and for which the user has given explicit consent,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,"s1, s1.1",E,,F,F,failed,"Mancano iss e aud, peròsono uguali"
x,OP-Userinfo response-GET-request,UserInfo request via HTTP GET,Userinfo response,"UserInfo request via HTTP GET with scope ""openid profile""",Compliant if the JWT in the body of the response contains the claim 'given_name'. Not compliant otherwise,/ manual: check content,Correct Input,Userinfo response,Does the OP give the correct claims through HTTP GET at the userinfo endpoint,"After a successful Authentication Request with a scope 'openid profile' and only paramter given_name for userinfo, a valid Access Token obtained from the OP is sent to the OP's userinfo endpoint using an HTTP GET request. If the userinfo endpoint returns a signed and encrypted JWT containing the claims 'given_name', the OP is compliant with the specification.",OP,,,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Active,M,Mismatch of content,Is JWT authentication implemented (SupportsJwtClientAuthentication),"Has userinfo endpoint, Userinfo Endpoint access with header method",,,,,,TRUE,x,,yes,s1,E,,F,F,failed,"[SAME] Manca parametro birthdate, iss e aud e ha email"
o,OP-Userinfo response-http_status_code,UserInfo response,Userinfo response,Trigger Userinfo response,"Compliant if the HTTP status code is 200, not compliant otherwise",HTTP parameter presence,Correct Input,Userinfo response,Does the HTTP status code of the UserInfo response is 200,A correct UserInfo request is made to the UserInfo endpoint (it must contain the parameter Authorization: Bearer <token> in the header) and the response analyzed. The HTTP code must be 200,OP,,UserInfo response | head | HTTP/?\d?\.?\d?\s200,The HTTP status code of the UserInfo response is 200,SPID_CIE_OIDC#UserInfo Response#response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,L,Return wrong status code,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWE,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if the response contains a signed and encrypted JWT, not compliant otherwise",HTTP parameter type,Correct Input,Userinfo response,Does the UserInfo Endpoint create a signed and encrypted JWT,The UserInfo response is taken and the presence of a signed and encrypted JWE in the body of the response is checked.,OP,,UserInfo response | body | [\w\-]+\.[\w\-]+\.[\w\-]+\.[\w\-]+\.[\w\-]+$,The content of the Response body MUST be a signed and encrypted JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,"4.2.1, 4.2.2, 4.3.7",Must understand how to check encryption of the JWT,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWE-correct-signature,UserInfo response to a correct request,Userinfo response,Trigger Userinfo response,"Compliant if the signature verification of the JWE in the payload of the response is valid using the OP's public key, not compliant otherwise",/ manual: check signature,Correct Input,Userinfo response,Does Userinfo endpoint sign the JWE in the response with the OP's private key,"In order to guarantee integrity, the Userinfo Response's JWE must be signed with the OP's private key, so that everyone in possess of the OP's public key can decrypt it and verify that it was issued by the OP. In this test a correct request is made and the correctness of the signature of the JWE is checked using the OP's public key",OP,,,The content of the Response body MUST be a signed and encrypted JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Active,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,4.4.3,,TRUE,x,,,s1,E,Problema implementazione,F,F,failed,[SAME] Decryptare il JWE e controllare la signature del jwt contenuto (OP)
o,OP-Userinfo response-JWE-header-alg,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the alg parameter, not compliant otherwise",JWE parameter presence,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain the alg parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification",OP,,UserInfo response | body | [^\r\n]* | header | alg,The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
o,OP-Userinfo response-JWE-header-alg-value,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the alg parameter containing a value among ['RSA-OAEP', 'RSA-OAEP-256', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A256KW'], not compliant otherwise",JWE list values,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain a correct alg parameter in the JOSE Header,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RSA-OAEP', 'RSA-OAEP-256', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A256KW'] in the JOSE header, then it is compliant with the specification",OP,,"UserInfo response | body | [^\r\n]* | header | alg | [""RSA-OAEP"", ""RSA-OAEP-256"", ""ECDH-ES"", ""ECDH-ES+A128KW"", ""ECDH-ES+A256KW""]",The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,4.3.0,,TRUE,,,no,s1,E,,P,P,passed,
,OP-Userinfo response-JWE-header-alg-value-wrong,,Userinfo response,Trigger Userinfo response,"Compliant if the alg parameter in the JOSE Header of the JWE in the body of the response contains a value among RS256 and RS512, not Compliant if it contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",JWE parameter not in value,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain a correct alg parameter in the JOSE Header,"In this test, the JWE is taken from the Userinfo Response's body, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.",OP,,"UserInfo response | body | [^\r\n]* | header | alg | [""none"", ""HS256"", ""HS384"", ""HS512""]",The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#Userinfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWE-header-cty,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the cty parameter, not compliant otherwise",JWE parameter presence,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain the cty parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification",OP,,UserInfo response | body | [^\r\n]* | header | cty,The JOSE header MUST contain the cty parameter (Content Type) configured to JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWE-header-cty-value,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the cty parameter set to 'JWT', not compliant otherwise",JWE parameter values,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain a correct cty parameter in the JOSE Header,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification",OP,,UserInfo response | body | [^\r\n]* | header | cty | JWT,The JOSE header MUST contain the cty parameter (Content Type) configured to JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWE-header-enc,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the enc parameter, not compliant otherwise",JWE parameter presence,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain the enc parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification",OP,,UserInfo response | body | [^\r\n]* | header | enc,The JOSE header MUST contain the enc parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWE-header-enc-value,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the enc parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWE list values,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain a correct enc parameter in the JOSE Header,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification",OP,,"UserInfo response | body | [^\r\n]* | header | enc | [""A128CBC-HS256"", ""A256CBC-HS512""]",The JOSE header MUST contain the enc parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
,OP-Userinfo response-JWE-header-kid,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the JOSE Header of the JWE in the body of the response there is the kid parameter, not compliant otherwise",JWE parameter presence,Correct Input,Userinfo response,Does the UserInfo Response's JWE contain the kid parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification",OP,,UserInfo response | body | [^\r\n]* | header | kid,The JOSE header MUST contain the kid parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWS-payload-aud-value,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the aud parameter set to the RP's identifier, not compliant otherwise",/ manual: wrong parameter,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain a correct aud parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'aud' parameter in the payload is set to the RP's identifier, then it is compliant with the specification",OP,,,"The JWT payload is a JSON containing the aud parameter, which must be the RP's identifier",SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,,,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro aud
o,OP-Userinfo response-JWS-payload-exp-presence,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the exp parameter, not compliant otherwise",/ manual: check parameter,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain exp parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'exp' parameter in the payload, then it is compliant with the specification",OP,,,The JWS header is a JSON containing the exp parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro exp
o,OP-Userinfo response-JWS-payload-exp-type,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if the exp parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is a valid unix time, not compliant otherwise",/ manual: check type,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain a correct exp parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'exp' parameter in the payload is a UNIX time, then it is compliant with the specification",OP,,,The JWS header is a JSON containing the exp parameter as a valid unix time,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro exp
o,OP-Userinfo response-JWS-payload-iat-presence,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the iat parameter, not compliant otherwise",/ manual: check parameter,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain iat parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iat' parameter in the payload, then it is compliant with the specification",OP,,,The JWS header is a JSON containing the iat parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro iat
o,OP-Userinfo response-JWS-payload-iat-type,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if the iat parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is a valid unix time, not compliant otherwise",/ manual: check type,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain a correct iat parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iat' parameter in the payload is a UNIX time, then it is compliant with the specification",OP,,,The JWS header is a JSON containing the iat parameter as a valid unix time,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro iat
x,OP-Userinfo response-JWS-payload-iss,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the iss parameter, not compliant otherwise",/ manual: check content,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain the iss parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iss' parameter in the payload, then it is compliant with the specification",OP,,,The JWT payload is a JSON containing the iss parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Mismatch of content,,,,,,"4.4.4, 4.4.5",,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro iss
x,OP-Userinfo response-JWS-payload-iss-value,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if the value of the iss parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is an URL identifying the OP, not compliant otherwise",/ manual: wrong parameter,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain a correct iss parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iss' parameter in the payload is set to the OP's identifier, then it is compliant with the specification",OP,,,The JWT payload is a JSON containing the iss parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro iss
x,OP-Userinfo response-JWS-payload-sub,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the sub parameter, not compliant otherwise",/ manual: check parameter,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain the sub parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'sub' parameter in the payload, then it is compliant with the specification",OP,,,The JWT payload is a JSON containing the sub parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Passive,M,Missing parameter,,Userinfo has sub claim,,,,"4.4.15, 4.4.16",,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-JWS-payload-sub-value,UserInfo Response,Userinfo response,Trigger Userinfo response,"Compliant if the value of the sub parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is the same as the one sent in the ID Token, not compliant otherwise",/ manual: wrong parameter,Correct Input,Userinfo response,Does the UserInfo Response's JWS contain a correct sub parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'sub' parameter in the payload is set to the same value set in the ID Token, then it is compliant with the specification",OP,,,The JWT payload is a JSON containing the sub parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Active,M,Presence of wrong parameter,,Userinfo has sub claim,,,,"4.4.15, 4.4.16",,TRUE,x,,no,s1,E,,F,P,passed,"[PRIMA] Non vedo il jwe, quindi non è possibile analizzare l'errore. Ufficialmente il parametro sub non è corretto."
x,OP-Userinfo response-JWT-correct-encryption,UserInfo response to a correct request,Userinfo response,Trigger Userinfo response,Compliant if the JWT in the payload of the response can be decrypted with the RP's private key,/ manual: check signature,Correct Input,Userinfo response,Does Userinfo endpoint encrypt the JWE in the response with the RP's public key,"In order to guarantee confidentiality, the Userinfo Response's JWE must be encrypted with the RP's public key, so that only the intended RP is able to decrypt it. In this test a correct request is made and the correctness of the encryption of the JWT is checked by trying to decrypt the payload with the RP's private key",OP,,,The content of the Response body MUST be a signed and encrypted JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,Active,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,4.3.6,,TRUE,x,,,s1,E,,P,P,passed,Decrypt il JWE con chiave RP
x,OP-Userinfo response-missing-token,UserInfo response to a request without the Token,UserInfo response to a request without the Token,UserInfo request without the Token in Authorization parameter in the head,"Compliant if the Userinfo response is an HTTP 400 because of invalid_request, not compliant otherwise",Param Response,Wrong Input,Userinfo response,How does the OP behave when the token in the userinfo request is missing,A userinfo request without the 'Authorization: Bearer ...' field is made and the response analyzed,OP,UserInfo request | head | Authorization | ,UserInfo response | head | 400 | body | invalid_request,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,test_userinfo_endpoint_no_header,,,,,TRUE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,OP-Userinfo response-POST-request,UserInfo request via HTTP POST,Userinfo response,"UserInfo request via HTTP POST with scope ""openid profile""","Compliant if the JWT in the body of the response contains the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier). Not compliant otherwise",/ manual: check content,Correct Input,Userinfo response,Does the OP gives the correct claims through HTTP POST at the userinfo endpoint,"After a successful Authentication Request with a scope 'openid profile' , a valid Access Token obtained from the OP is sent to the OP's userinfo endpoint using an HTTP POST request. If the userinfo endpoint returns a signed and encrypted JWT containing the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier), the OP is compliant with the specification.",OP,,,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Active,M,Mismatch of content,,,,,,,,,,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Authentication request failed con openid profile - UserInfo request funziona solo in GET
x,OP-Userinfo response-scope-openid,UserInfo response,Userinfo response,Authentication request with scope openid and claims parameter empty in the request,"Compliant if the payload of the issued JWT contains the sub claim and no user attributes, not compliant otherwise",/ manual: check content,Correct Input,Userinfo response,Does the OP leak information when the scope is only openid,"In this test an authorization request is made without the claims parameter and inserting in the scope parameter only the 'openid' value. The OP must return a code that will be exchanged for an access token. Once obtained the access token, the UserInfo endpoint is queried and the response must contain a signed JWT which contains (in the payload) the sub claim and no user attributes.",OP,,,"If in the scope parameter there was only the openid value and the claims parameter was not present or valued, the response of the userinfo endpoint would not have any user attributes but only the claim sub.",SPID_CIE_OIDC#scope-and-claims-parameters; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#parametri-scope-claims,OIDC Core,Active,M,Mismatch of content,,Support openid scope,,,,,,TRUE,x,,no,s1,E,,P,P,passed,
x,OP-Userinfo response-tokens-really-revoked,Userinfo response to a request with revoked token,Userinfo response to a request with revoked token,Userinfo request with a revoked token,"Compliant if the Userinfo response is an HTTP 400 because of invalid_grant, not compliant otherwise",/ manual: check flow,Wrong Input,Userinfo response,Does the OP really revoke the Token after a request,"Once obtained a token, it is directly sent to the revocation endpoint. In order to verify that the token is really revoked, a new request to the UserInfo endpoint can be made. If the response contains the claims requested, than the token is still valid.",OP,UserInfo request | head | Authorization | Bearer XXX,UserInfo response | head | 400 | body | invalid_grant,"The OP will have to revoke the token specified in the request and will have to end the Single Sign-On session, if it is still active",SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.","Can access tokens be revoked (CanAccessTokensBeRevoked), Can refresh tokens be revoked (CanRefreshTokensBeRevoked), Does the server support RFC7009 (token revocation)",,,,,,,TRUE,,,no,"s1, s1_revoked",E,Problema implementazione,F,F,failed,[SAME] Ritorna 403
x,RP-Authentication request-code_challenge,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if code_challenge is present, not Compliant if it is not",HTTP parameter presence,Correct Input,Authentication request,Does the RP's Authentication Request contain the 'code_challenge' parameter,"The Authentication request is taken and the presence of the 'code_challenge' parameter is checked. If it is present, than the Authentication Request is using PKCE and is compliant with the specifications, otherwise it is not compliant.",RP,,Authentication request | url | code_challenge,The HTTP Authentication Request must contain the 'code_challenge' parameter.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,Correctness in the OP is checked with the code_verifier,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-code_challenge_method,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the code_challenge_method parameter is present, not Compliant otherwise",HTTP parameter presence,Correct Input,Authentication request,Does the RP's Authentication Request contain the 'code_challenge_method' parameter,"The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is not present, then the RP is not compliant with the specifications",RP,,Authentication request | url | code_challenge_method,The HTTP Authentication Request must contain the 'code_challenge_method' parameter and it must be set to on of the value of the code_challenge_methods_supported parameter in the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,Create OP test on code_challenge,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-code_challenge_method-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the code_challenge_method parameter is present and set to a correct value, not Compliant otherwise",/ manual: wrong parameter,Correct Input,Authentication request,Does the RP's Authentication Request contain a correct 'code_challenge_method' parameter,"The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is present, than it has to be set to one of the value of the code_challenge_methods_supported parameter in the OP's metadata. If it is not present or contains any other value, then the RP is not compliant with the specifications",RP,,,The HTTP Authentication Request must contain the 'code_challenge_method' parameter and it must be set to on of the value of the code_challenge_methods_supported parameter in the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,M,Presence of wrong parameter,,,,,,,Create OP test on code_challenge,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-acr_values,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the acr_values parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'acr_values' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,,Authentication request | url | request | payload | acr_values,"The JWT payload of the request parameter in the Authentication Request must contain the 'acr_values' parameter and It MUST be a string with the requested 'acr' values, each of them separated by a single space, appearing in order of preference. The supported values 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
o,RP-Authentication request-JWT-acr_values-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the acr_values parameter is present, it is a string with the requested 'acr' values separated by a single space and the values are among 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'. Not compliant otherwise",JWT list values,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain a correct 'acr_values' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is present, than it must be a string with the requested 'acr' values, each of them separated by a single space. The supported values are 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'. If it contains other values or it is missing, than the RP is not compliant with the specifications",RP,,"Authentication request | url | request | payload | acr_values | [""https://www.spid.gov.it/SpidL1"", ""https://www.spid.gov.it/SpidL2"", ""https://www.spid.gov.it/SpidL3"", ""https://www.spid.gov.it/SpidL1 https://www.spid.gov.it/SpidL2"", ""https://www.spid.gov.it/SpidL1 https://www.spid.gov.it/SpidL3"", ""https://www.spid.gov.it/SpidL2 https://www.spid.gov.it/SpidL3"", ""https://www.spid.gov.it/SpidL1 https://www.spid.gov.it/SpidL2 https://www.spid.gov.it/SpidL3""]","The JWT payload of the request parameter in the Authentication Request must contain the 'acr_values' parameter and It MUST be a string with the requested 'acr' values, each of them separated by a single space, appearing in order of preference. The supported values 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-aud,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the aud parameter is present, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'aud' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'aud' parameter is checked. If it missing, than the RP is not compliant with the specifications",RP,,Authentication request | url | request | payload | aud,The JWT content of the request parameter in the Authentication Request must contain the 'aud' parameter and it must be the OP identifier,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-exp,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if present and before the current time, not compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'exp' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'exp' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,,Authentication request | url | request | payload | exp,The JWT content of the request parameter in the Authentication Request must contain the 'exp' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-header-alg-not_in_value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT Header of the request parameter contains the alg parameter and its value does not corresponds to one among ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",JWT parameter not in value,Correct Input,Authentication request,Does the RP use an asymmetric algorithm to sign the JWT in the request parameter of the Authentication Request,"In this test the Authentication Request is taken and the alg parameter in the JWT Header is checked. If it corresponds to a symmetric algorithm or it is none, than the RP is not compliant with the specifications.",RP,,"Authentication request | url | request | header | alg | [""none"", ""HS256"", ""HS384"", ""HS512""]","The JWT Header of the request parameter in the Authentication Request must contain the 'alg' parameter, it must be set to one of the supported values for the OP metadata and must not be 'none' or a symmetric algorithm (MAC).",SPID_CIE_OIDC; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,"If it is not an alg supported by the OP, than it cannot verify the signature and there are 3 cases: 1. It is a algorithm not supported and the OP even trying to use the correct RP's public key cannot decrypt it, or
2. It is a symmetric algorithm and the public key of the RP won't decrypt the signature
3. It is a symmetric algorithm and the public key of the RP is the correct key used to encrypt it
In the first 2 cases the parameter is meaningless because the OP won't be able to decrypt the signature, in the latter we cannot rely on the secrecy of the process. The only interesting case is the third one",FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-header-client_id,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'client_id' parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'client_id' parameter,"In this test the request parameter of the Authentication Request is taken, the payload decrypted and the presence of the 'client_id' parameter is checked.",RP,,Authentication request | url | request | payload | client_id,The JWT content of the request parameter in the Authentication Request must contain the 'client_id' parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-header-client_id-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT in the request parameter contains the 'client_id' parameter identifying the RP, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'client_id' parameter identifying the RP,"In this test the request parameter of the Authentication Request is taken, the payload decrypted and the value of the 'client_id' parameter correspond to the one that can be found in the EC of the RP",RP,Entity Configuration response RP | body | [^\r\n]* | payload | metadata.openid_relying_party.client_id,Authentication request | url | request | payload | client_id | client_id,The JWT content of the request parameter in the Authentication Request must contain the 'client_id' parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,M,Mismatch of parameter,,,,,,,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-header-kid,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'kid' parameter in the header, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the JWT header of the Authentication Request contain the kid parameter,"In this test the request parameter of the Authentication Request is taken, and the presence of the 'kid' parameter is checked.",RP,,Authentication request | url | request | header | kid,The JWT Header of the request parameter in the Authentication Request must contain the 'kid' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-header-kid-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'kid' parameter in the header and its value corresponds to the one that can be found in the jwks parameter of the RP metadata where use is sig, not Compliant otherwise",/ manual: check parameter,Correct Input,Authentication request,Does the JWT header of the Authentication Request contain the kid parameter correspond to the jwks parameter in RP metadata,"In this test the request parameter of the Authentication Request is taken, and the value of the 'kid' parameter must correspond with jwks parameter of the RP metadata where ""use"" is ""sig"", not Compliant otherwise",RP,,,The JWT Header of the request parameter in the Authentication Request must contain the 'kid' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,M,Presence of wrong parameter,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] I parametri kid sono diversi
x,RP-Authentication request-JWT-iat,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'iat' parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'iat' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iat' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,,Authentication request | url | request | payload | iat,The JWT content of the request parameter in the Authentication Request must contain the 'iat' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-iss,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'iss' parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'iss' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iss' parameter is checked.",RP,,Authentication request | url | request | payload | iss,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-iss-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the iss parameter corresponds to the RP's client_id, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'iss' parameter set to the RP's client_id,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'iss' parameter has to be the client_id of the RP. If it is another value or is missing, than the RP is not compliant with the specifications",RP,Entity Configuration response RP | body | [^\r\n]* | payload | metadata.openid_relying_party.client_id,Authentication request | url | request | payload | iss | iss,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Authentication request-jwt-nonce,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'nonce' parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'nonce' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'nonce' parameter is checked.",RP,,Authentication request | url | request | payload | nonce,The JWT payload of the request parameter in the Authentication Request must contain the 'nonce' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-jwt-prompt,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'prompt' parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'prompt' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'prompt' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,,Authentication request | url | request | payload | prompt,The JWT payload of the request parameter in the Authentication Request must contain the 'prompt' parameter. It can contain the 'consent' or the 'consent login' value,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-jwt-redirect_uri,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the redirect_uri parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'redirect_uri' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'redirect_uri' parameter",RP,,Authentication request | url | request | payload | redirect_uri,The JWT payload of the request parameter in the Authentication Request must contain the 'redirect_uri' parameter. It must match one of the URLs given in the RP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-jwt-response_type,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the response_type parameter is present, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'response_type' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked",RP,,Authentication request | url | request | payload | response_type,The JWT payload of the request parameter in the Authentication Request must contain the 'response_type' parameter and it must contain the value in 'response_types_supported' parameter of the OP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-jwt-scope,Authentication Request,Authentication request,Trigger Authentication request,Compliant if the scope parameter is present in the JWT payload. Not compliant otherwise,JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request contain the 'scope' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'scope' parameter is checked.",RP,,Authentication request | url | request | payload | scope,"The JWT payload of the request parameter in the Authentication Request must contain the 'scope' parameter and the supported values are 'profile' and 'email'. The parameter scope MUST be sent both as a parameter in the HTTP call, and inside the request object. The two values MUST be the same",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,"Not clear in the new specification, check if the offline access can be used this way",FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-state,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'state parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'state' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'state' parameter is checked.",RP,,Authentication request | url | request | payload | state,The JWT payload of the request parameter in the Authentication Request must contain the 'state' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-JWT-state-type,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the state parameter is present and longer than 32 characters, not Compliant otherwise",JWT parameter type,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'state' parameter greater than 32 characters,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'state' parameter must be at least 32 alphanumeric characters long. If it is not present or its length is less than 32 alphanumeric characters, then the RP is not compliant with the specifications",RP,,"Authentication request | url | request | payload |  | {""type"": ""object"", ""properties"": {""state"": {""type"": ""string"", ""pattern"": ""^[\u0020-\u007E]{32,}$""}}, ""required"": [""state""]}",The JWT payload of the request parameter in the Authentication Request must contain the 'state' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-jwt-ui_locales,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the JWT of the request parameter contains the 'ui_locales' parameter, not Compliant otherwise",JWT parameter presence,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'ui_locales' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'ui_locales' parameter is checked. If it is missing, the RP is not compliant with the specifications",RP,,Authentication request | url | request | payload | ui_locales,The JWT content of the request parameter in the Authentication Request must contain the 'ui_locales' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro ui_locales
x,RP-Authentication request-nonce-type,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the nonce parameter is longer than 32 characters, not Compliant otherwise",JWT parameter type,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'nonce' parameter longer than 32 characters,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'nonce' parameter must be at least 32 alphanumeric characters long.",RP,,"Authentication request | url | request | payload |  | {""type"": ""object"", ""properties"": {""nonce"": {""type"": ""string"", ""pattern"": ""^[\u0020-\u007E]{32,}$""}}, ""required"": [""nonce""]}",The JWT payload of the request parameter in the Authentication Request must contain the 'nonce' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
o,RP-Authentication request-prompt-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the prompt parameter is present and is set to 'consent' or to 'consent login', not Compliant otherwise",JWT list values,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'prompt' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'prompt' parameter is checked. It must be set to the value 'consent' or 'consent login'. If it contains other values or it is missing, than the RP is not compliant with the specifications",RP,,"Authentication request | url | request | payload | prompt | [""consent"", ""consent login""]",The JWT payload of the request parameter in the Authentication Request must contain the 'prompt' parameter. It can contain the 'consent' or the 'consent login' value,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-redirect_uri-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the redirect_uri parameter value matches one of the URLs given in the RP metadata, not compliant otherwise",JWT Check-Save to JWT,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain the 'redirect_uri' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'redirect_uri' parameter matches one of the URLs given in the RP metadata.",RP,Entity Configuration response RP | body | [^\r\n]* | payload | metadata.openid_relying_party.redirect_uris,Authentication request | url | request | payload | redirect_uri | redirect_uris,The JWT payload of the request parameter in the Authentication Request must contain the 'redirect_uri' parameter. It must match one of the URLs given in the RP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Authentication request-response_type-value,Authentication Request's request parameter,Authentication request,Trigger Authentication request,"Compliant if the response_type parameter is present and equal to the 'response_types_supported' parameter in the OP metadata, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Authentication request,Does the RP Authentication Request's JWT contain a correct 'response_type' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked. This parameter's value must be the same of the 'response_types_supported' parameter in the OP metadata",RP,Entity Configuration response RP | body | [^\r\n]* | payload | metadata.openid_relying_party.response_types[0],Authentication request | url | request | payload | response_type | response_types_supported,The JWT payload of the request parameter in the Authentication Request must contain the 'response_type' parameter and it must contain the value in 'response_types_supported' parameter of the OP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Authentication request-scope-value,Authentication Request,Authentication request,Trigger Authentication request,"Compliant if the value of the scope parameter in the JWT payload is set to 'openid'. Optionally to 'openid profile', 'openid email', 'openid offline_access', 'openid offline_access profile' and 'openid offline_access email'. Not compliant otherwise",JWT list values,Correct Input,Authentication request,Does the RP Authentication Request contain a correct value in 'scope' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'scope' parameter must be set to the value 'openid' then it can (optionally) have the values 'offline_access', 'profile' or 'email' appended.",RP,,"Authentication request | url | request | payload | scope | [""openid"", ""openid profile"", ""openid email"", ""openid offline_access"", ""openid offline_access profile"", ""openid offline_access email""]","The JWT payload of the request parameter in the Authentication Request must contain the 'scope' parameter and the supported values are 'profile' and 'email'. The parameter scope MUST be sent both as a parameter in the HTTP call, and inside the request object. The two values MUST be the same",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,"Not clear in the new specification, check if the offline access can be used this way",FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Authentication request-url-client_id,Authentication Request,Authentication request,Trigger Authentication request,Compliant if the url contains the client_id parameter,HTTP parameter presence,Correct Input,Authentication request,Does the RP insert the client ID in the url of the request,In this test the Authentication Request is taken and the presence of the client_id parameter in the URL is checked,RP,,Authentication request | url | client_id,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,RP-Authentication request-url-response_type,Authentication Request,Authentication request,Trigger Authentication request,Compliant if the url contains the response_type parameter,HTTP parameter presence,Correct Input,Authentication request,Does the RP insert the response type in the url of the request,In this test the Authentication Request is taken and the presence of the response_type parameter in the URL is checked,RP,,Authentication request | url | response_type,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,,,,no,s1,E,,P,P,passed,
x,RP-Authentication response-Entity_Statement-wrong-jwks,OP's Entity Configuration and TA's Entity Statement for the OP with a public key that differs from the one in the EC of the OP,Authentication response,Entity Statement response regarding the OP and with a wrong jwks parameter and Authentication request,"Compliant if the authentication response does not contain the code parameter, not compliant otherwise",/ manual: check signature,Wrong Input,Authentication response,Does the RP request the OP's Entity Statement to validate the OP's Entity Configuration,"In order to check if the RP verifies the OP's Entity Configuration with the keys sent in the ES, once the RP asks for the Entity Statement, the TA's Entity Statement in response could have a (wrong) public key that is different from the one that can be found in the OP's EC (ES keys should be wrong). After this, an authentication request with that OP is made and, if the response contains the code parameter, the RP is either using the public keys present in the Entity Configuration (not reliable) or not checking the signature at all.",RP,,,"For each EC of the OPs, the RP validates the signature by using the public key obtained in the Entity Statement released by the Trust Anchor.",SPID_CIE_OIDC#Metadata-Retrieval-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#relying-party,OIDC Federation,Active,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,"The test fails if a correct flow is accomplished by the RP. It is similar to JWT response (correct check-no) but since we are checking the RP's flow, we do not except an HTTP Error code",FALSE,,,no,s1,E,,P,P,passed,
x,RP-Entity Configuration response-Entity_Configuration-wrong-signature,Wrongly signed OP's Entity Configuration,Entity Configuration response,Entity Configuration response containing a wrongly-signed Entity Configuration,"Compliant if the Authentication response does not contain the code parameter, not compliant otherwise",/ manual: check signature,Wrong Input,Entity Configuration response,Does the RP check the signature in the OP Entity Configuration,"In order to check if the RP correctly verifies the signature of an OP's Entity Configuration and does not trust arbitrary OP, the latter sends as the Entity Configuration response a wrongly signed Entity Configuration and waits for the RP. After this an authentication request is sent and, if the response contains the code, the RP is not checking the authenticity of the EC",RP,,,"For each EC of the OPs, the RP validates the signature by using the public key obtained in the Entity Statement released by the Trust Anchor.",SPID_CIE_OIDC#Metadata-Retrieval-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#relying-party,OIDC Federation,Active,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] code è presente
x,RP-Entity Configuration response-metadata-client_id,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'client_id' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'client_id' parameter,In this test the RP metadata are taken and the presence of the 'client_id' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.client_id,The RP metadata of type 'openid_relying_party' must contain the parameter client_id and it must contain an HTTPS URL that uniquely identifies the RP,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-client_id-type,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'client_id' parameter in the RP metadata is an HTTPS URL, not Compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the RP metadata contain correct type of 'client_id' parameter,In this test the RP metadata are taken and the value of the 'client_id' parameter is an HTTPS URL,RP,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.openid_relying_party | {""type"":""object"", ""properties"":{""client_id"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://""}},""required"":[""client_id""]}",The RP metadata of type 'openid_relying_party' must contain the parameter client_id and it must contain an HTTPS URL that uniquely identifies the RP,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] HTTP non HTTPS
x,RP-Entity Configuration response-metadata-client_id-value,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'client_id' parameter in the RP metadata uniquely identifies the RP, not Compliant otherwise",JWT parameter values,Correct Input,Entity Configuration response,Does the RP metadata contain correct value of 'client_id' parameter,In this test the RP metadata are taken and the value of the 'client_id' parameter is an HTTPS URL  that uniquely identifies the RP,RP,,Entity Configuration response | body | [^\n\r]* | payload | metadata.openid_relying_party.client_id | x_https_RP,The RP metadata of type 'openid_relying_party' must contain the parameter client_id and it must contain an HTTPS URL that uniquely identifies the RP,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] HTTP non HTTPS
x,RP-Entity Configuration response-metadata-client_registration_types,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'client_registration_types' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'client_registration_types' parameter,In this test the RP metadata are taken and the presence of the 'client_registration_types' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.client_registration_types,The RP metadata of type 'openid_relying_party' must contain the parameter client_registration_types and it has to be set to 'automatic'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-client_registration_types-value,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'client_registration_types' parameter in the RP metadata is 'automatic'. Not Compliant otherwise,JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'client_registration_types' parameter,In this test the RP metadata are taken and the value of the 'client_registration_types' parameter is 'automatic',RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.client_registration_types[0] | [""automatic""]",The RP metadata of type 'openid_relying_party' must contain the parameter client_registration_types and it has to be set to 'automatic'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-contacts,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the contacts claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the contacts claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.contacts,The RP Metadata of type 'federation_entity' MUST contain contacts,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,"[PRIMA] Manca parametro federation_entity, ma è presente in openid_relying_party.contacts"
x,RP-Entity Configuration response-metadata-federation_resolve_endpoint,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the federation_resolve_endpoint claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the federation_resolve_endpoint claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_resolve_endpoint,The RP Metadata of type 'federation_entity' MUST contain federation_resolve_endpoint,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro federation_entity e federation_resolve_endpoint
x,RP-Entity Configuration response-metadata-grant_types,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'grant_types' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the grant_types claim,In this test the RP metadata are taken and the presence of the 'grant_types' parameter is checked,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.grant_types,The RP metadata of type 'openid_relying_party' must contain the parameter grant_types and it must be a JSON array containing 'authorization_code' and 'refresh_token',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-grant_types,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'grant_types' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'grant_types' parameter,In this test the RP metadata are taken and the presence of the 'grant_types' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.grant_types,The RP metadata of type 'openid_relying_party' must contain the parameter grant_types,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,,P,passed,
x,RP-Entity Configuration response-metadata-grant_types-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'grant_types' parameter in the RP metadata is ['authorization_code', 'refresh_token'], not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct grant_types claim,In this test the RP metadata are taken and the value of the 'grant_types' parameter contains 'authorization_code' and 'refresh_token',RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.grant_types[0] | [""authorization_code"", ""refresh_token""]",The RP metadata of type 'openid_relying_party' must contain the parameter grant_types and it must be a JSON array containing 'authorization_code' and 'refresh_token',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-grant_types-type,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'grant_types' parameter in the RP metadata is a JSON, not Compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the RP metadata contain correct type grant_types claim,In this test the RP metadata are taken and the 'grant_types' parameter is a JSON array,RP,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.openid_relying_party | {""type"":""object"", ""properties"":{""grant_types"":{""type"":""array""}}, ""requirement"":[""grant_type""]}",The RP metadata of type 'openid_relying_party' must contain the parameter grant_types and it must be a JSON array containing 'authorization_code' and 'refresh_token',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-grant_types-value,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'grant_types' parameter in the RP metadata ('openid_relying_party' type) contains authorization_code or refresh_token. Not Compliant otherwise,JWT parameter type,Correct Input,Entity Configuration response,Does the RP metadata contain 'grant_types' parameter with value of authorization_code or refresh_token,In this test the RP metadata are taken and the type of the 'grant_types' parameter is checked.,RP,,"Entity Configuration response | body | [^\r\n]* | payload | .metadata.openid_relying_party | {""type"": ""object"",""properties"": {""grant_types"": {""type"": ""array"",""items"": {""type"": ""string"",""enum"": [""authorization_code"", ""refresh_token""]}}},""required"": [""grant_types""]}",The RP metadata of type 'openid_relying_party' must contain the correct parameter grant_types,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,,P,passed,
x,RP-Entity Configuration response-metadata-homepage_uri,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the homepage_uri claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the homepage_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.homepage_uri,The RP Metadata of type 'federation_entity' MUST contain homepage_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.28,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro federation_entity e homepage_uri
x,RP-Entity Configuration response-metadata-id_token_encrypted_response_alg,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'id_token_encrypted_response_alg' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'id_token_encrypted_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_alg' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_encrypted_response_alg,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro id_token_encrypted_response_alg
x,RP-Entity Configuration response-metadata-id_token_encrypted_response_alg-not_supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'id_token_encrypted_response_alg' parameter in the RP metadata does not contain the value ['RSA_1_5']. Not Compliant otherwise,JWT list parameter does not contain,Correct Input,Entity Configuration response,Does the RP metadata contain incorrect 'id_token_encrypted_response_alg' parameter,In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_encrypted_response_alg | [""RSA_1_5""]",The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro id_token_encrypted_response_alg 
x,RP-Entity Configuration response-metadata-id_token_encrypted_response_alg-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encrypted_response_alg' parameter in the RP metadata is ['RSA-OAEP', 'RSA-OAEP-256']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'id_token_encrypted_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_encrypted_response_alg | [""RSA-OAEP"", ""RSA-OAEP-256""]",The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro id_token_encrypted_response_alg 
x,RP-Entity Configuration response-metadata-id_token_encrypted_response_enc,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'id_token_encrypted_response_enc' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'id_token_encrypted_response_enc' parameter,In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_enc' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_encrypted_response_enc,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_enc and it has to contain the content encryption algorithms. This parameter is required only if the id_token_encrypted_response_alg is given,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,This parameter is required only if the id_token_encrypted_response_alg is given,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro id_token_encrypted_response_enc
x,RP-Entity Configuration response-metadata-id_token_encrypted_response_enc-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_encrypted_response_enc' parameter in the RP metadata is ['A128CBC-HS256', 'A256CBC-HS512']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'id_token_encrypted_response_enc' parameter,"In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_encrypted_response_enc | [""A128CBC-HS256"", ""A256CBC-HS512""]",The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_enc and it has to contain the content encryption algorithms. This parameter is required only if the id_token_encrypted_response_alg is given,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,This parameter is required only if the id_token_encrypted_response_alg is given,FALSE,x,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro id_token_encrypted_response_enc
x,RP-Entity Configuration response-metadata-id_token_signed_response_alg,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'id_token_signed_response_alg' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'id_token_signed_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'id_token_signed_response_alg' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_signed_response_alg,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-id_token_signed_response_alg-not_supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_signed_response_alg' parameter in the RP metadata does not contain ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",JWT parameter not in JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain incorrect 'id_token_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_signed_response_alg | [""none"", ""HS256"", ""HS384"", ""HS512""]",The RP metadata of type 'openid_relying_party' must contain the parameter id_token_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-id_token_signed_response_alg-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'id_token_signed_response_alg' parameter in the RP metadata is ['RS256', 'RS512']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'id_token_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is ['RS256', 'RS512']",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.id_token_signed_response_alg | [""RS256"", ""RS512""]",The RP metadata of type 'openid_relying_party' must contain the parameter id_token_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-jwks,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'jwks' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'jwks' parameter,In this test the RP metadata are taken and the presence of the 'jwks' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.jwks,The RP metadata of type 'openid_relying_party' must contain the parameter jwks,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,,P,passed,
x,RP-Entity Configuration response-metadata-jwks,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'jwks' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant if is absent",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'jwks' parameter,"In this test the RP metadata are taken and the presence of the 'jwks' parameter is checked. If it is absent, than the RP is not compliant with the specification",RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.jwks,The RP metadata of type 'openid_relying_party' must contain the parameter jwks,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-logo_uri,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the logo_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.logo_uri,The RP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro federation_entity e logo_uri
x,RP-Entity Configuration response-metadata-logo_uri-type,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim is an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the RP metadata contain correct type logo_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,RP,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"":""object"", ""properties"":{""logo_uri"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^(https?://).*\\.svg$""}},""required"":[""logo_uri""]}",The RP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,P,passed,[MODIFICATO] Prima: Manca parametro federation_entity e logo_uri - [PRIMA] HTTP non HTTPS
x,RP-Entity Configuration response-metadata-organization_name,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the organization_name claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the organization_name claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.organization_name,The RP Metadata of type 'federation_entity' MUST contain organization_name,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.27,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro federation_entity e organization_name
x,RP-Entity Configuration response-metadata-policy_uri,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the policy_uri claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the policy_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.policy_uri,The RP Metadata of type 'federation_entity' MUST contain policy_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro federation_entity e policy_uri
x,RP-Entity Configuration response-metadata-redirect_uris,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'redirect_uris' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'redirect_uris' parameter,In this test the RP metadata are taken and the presence of the 'redirect_uris' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.redirect_uris,The RP metadata of type 'openid_relying_party' must contain the parameter redirect_uris,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,,P,passed,
x,RP-Entity Configuration response-metadata-redirect_uris-value,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'redirect_uris' parameter in the RP metadata ('openid_relying_party' type) contains an HTTPS. Not Compliant otherwise,JWT parameter type,Correct Input,Entity Configuration response,Does the RP metadata contain an HTTPS 'redirect_uris' parameter,In this test the RP metadata are taken and the type of the 'redirect_uris' parameter is checked.,RP,,"Entity Configuration response | body | [^\r\n]* | payload | .metadata.openid_relying_party | {""type"": ""object"",""properties"": {""redirect_uris"": {""type"": ""array"",""items"": {""type"": ""string"",""format"": ""uri"",""pattern"": ""^https://.*$""}}},""required"": [""redirect_uris""]}",The RP metadata of type 'openid_relying_party' must contain the parameter redirect_uris of type HTTPS,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,,F,failed,HTTP non HTTPS
x,RP-Entity Configuration response-metadata-signed_jwks_uri,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'signed_jwks_uri' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'signed_jwks_uri' parameter,In this test the RP metadata are taken and the presence of the 'signed_jwks_uri' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.signed_jwks_uri,The RP metadata of type 'openid_relying_party' must contain the parameter signed_jwks_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,,P,passed,
x,RP-Entity Configuration response-metadata-token_endpoint_auth_method,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'token_endpoint_auth_method' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'token_endpoint_auth_method' parameter,In this test the RP metadata are taken and the presence of the 'token_endpoint_auth_method' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.token_endpoint_auth_method,The RP metadata of type 'openid_relying_party' must contain the parameter token_endpoint_auth_method and it has to be set to 'private_key_jwt'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-token_endpoint_auth_method-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'token_endpoint_auth_method' parameter in the RP metadata is 'one_of': 'private_key_jwt'. Not Compliant otherwise,JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'token_endpoint_auth_method' parameter,In this test the RP metadata are taken and the value of the 'token_endpoint_auth_method' parameter is 'one_of': 'private_key_jwt',RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.token_endpoint_auth_method | [""private_key_jwt""]",The RP metadata of type 'openid_relying_party' must contain the parameter token_endpoint_auth_method and it has to be set to 'private_key_jwt'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_encrypted_response_alg,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encrypted_response_alg' parameter in the RP metadata ('openid_relying_party' type) is present, Not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'userinfo_encrypted_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_alg' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_encrypted_response_alg,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_encrypted_response_alg-not_supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'userinfo_encrypted_response_alg' parameter in the RP metadata does not contain the value ['RSA_1_5']. Not Compliant otherwise,JWT parameter not in JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain incorrect 'userinfo_encrypted_response_alg' parameter,In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_encrypted_response_alg | [""RSA_1_5""]",The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_encrypted_response_alg-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encrypted_response_alg' parameter in the RP metadata is ['RSA-OAEP', 'RSA-OAEP-256']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'userinfo_encrypted_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_encrypted_response_alg | [""RSA-OAEP"", ""RSA-OAEP-256""]",The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_encrypted_response_enc,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'userinfo_encrypted_response_enc' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'userinfo_encrypted_response_enc' parameter,In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_encrypted_response_enc,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_enc and it has to contain the content encryption algorithms.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_encrypted_response_enc-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_encrypted_response_enc' parameter in the RP metadata is ['A128CBC-HS256', 'A256CBC-HS512']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'userinfo_encrypted_response_enc' parameter,"In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_encrypted_response_enc | [""A128CBC-HS256"", ""A256CBC-HS512""]",The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_enc and it has to contain the content encryption algorithms.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_signed_response_alg,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'userinfo_signed_response_alg' parameter in the RP metadata is present. Not Compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'userinfo_signed_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'userinfo_signed_response_alg' parameter is checked.,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_signed_response_alg,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_signed_response_alg-not_supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_signed_response_alg' parameter in the RP metadata does not contain the values ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",JWT parameter not in JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain incorrect 'userinfo_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_signed_response_alg | [""none"", ""HS256"", ""HS384"", ""HS512""]",The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-metadata-userinfo_signed_response_alg-supported,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'userinfo_signed_response_alg' parameter in the RP metadata is ['RS256', 'RS512']. Not Compliant otherwise",JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain correct 'userinfo_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is ['RS256', 'RS512']",RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.userinfo_signed_response_alg | [""RS256"", ""RS512""]",The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-response_types,RP metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'response_types' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the RP metadata contain the 'response_types' parameter,In this test the RP metadata are taken and the presence of the 'response_types' parameter in the 'openid_relying_party' metadata type is checked,RP,,Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.response_types,The RP metadata of type 'openid_relying_party' must contain the parameter response_types and it has to be a JSON array containing the value 'code',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-response_types-type,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'response_types' parameter in the RP metadata is a JSON Array. Not Compliant otherwise,JWT parameter type,Correct Input,Entity Configuration response,Does the RP metadata contain the 'response_types' parameter as a json,In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' is a JSON array,RP,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.openid_relying_party | {""type"": ""object"", ""properties"": {""response_types"": {""type"": ""array""}}, ""required"": [""response_types""]}",The RP metadata of type 'openid_relying_party' must contain the parameter response_types and it has to be a JSON array containing the value 'code',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-response_types-value,RP metadata,Entity Configuration response,Trigger Entity Configuration response,Compliant if the 'response_types' parameter in the RP metadata contains the value 'code'. Not Compliant otherwise,JWT parameter JSON value,Correct Input,Entity Configuration response,Does the RP metadata contain in the 'response_types' the value 'code',In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' contains the value 'code',RP,,"Entity Configuration response | body | [^\r\n]* | payload | metadata.openid_relying_party.response_types[0] | [""code""]",The RP metadata of type 'openid_relying_party' must contain the parameter response_types and it has to be a JSON array containing the value 'code',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-trust_marks,RP's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the RP's entity configuration contain the trust_marks parameter,"To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.",RP,,Entity Configuration response | body | [^\r\n]* | payload | trust_marks,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,RP-Entity Configuration response-trust_marks-type,RP's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks parameter is a JSON array, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the RP's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array",RP,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""trust_marks"": {""type"": ""array""}}, ""required"": [""trust_marks""]}",Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,RP-Introspection request-client_assertion,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_assertion parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection request,Does the Introspection Request contain the client_assertion,The Introspection request made by the RP is taken and the presence of the client_assertion parameter is checked.,RP,,Introspection request | body | client_assertion,The request to the Introspection Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-client_assertion_type,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_assertion_type parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection request,Does the Introspection Request contain the client_assertion_type,The Introspection request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,RP,,Introspection request | body | client_assertion_type,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-client_assertion_type-type,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_assertion_type parameter in the request is urn:ietf:params:oauth:clientassertion-type:jwt-bearer, not compliant otherwise",HTTP parameter value,Correct Input,Introspection request,Does the Introspection Request contain correct type of client_assertion_type,The Introspection request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,RP,,Introspection request | body | client_assertion_type | urn:ietf:params:oauth:client-assertion-type:jwt-bearer,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-client_assertion-type,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_assertion parameter in the request is a signed JWT, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection request,Does the Introspection Request contain the client_assertion as a valid JWT,The Introspection request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,RP,,Introspection request | body | client_assertion,The request to the Introspection Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-client_id,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_id parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection request,Does the Introspection Request contain the client id of the RP making the request,The Introspection request made by the RP is taken and the presence of the client_id parameter is checked.,RP,,Introspection request | body | client_id,The request to the Introspection Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-client_id-type,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_id parameter in the request is an URI, not compliant otherwise",JSON parameter type,Correct Input,Introspection request,Does the Introspection Request contain correct type of client id of the RP making the request,The Introspection request made by the RP is taken and the value of the client_id parameter is an URI,RP,,"Introspection request | body |  | {""type"":""object"", ""properties"":{""client_id"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://""}},""required"":[""client_id""]}",The request to the Introspection Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,,,,,,,,FALSE,x,,no,s_CIE_introsp,E,Problema implementazione,F,F,failed,URL è HTTP non HTTPS
x,RP-Introspection request-client_id-value,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the client_id parameter in the request identifies the RP, not compliant otherwise",HTTP parameter value,Correct Input,Introspection request,Does the Introspection Request contain correct client id of the RP making the request,The Introspection request made by the RP is taken and the value of the client_id parameter identifies the RP,RP,,Introspection request | body | client_id | X_url_RP,The request to the Introspection Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s_CIE_introsp,E,,P,P,passed,
o,RP-Introspection request-method-correct,Introspection Request,Introspection request,Trigger Introspection request,"Compliant if the introspection request is sent via HTTP POST, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection request,Does the Introspection Request use HTTP POST,The Introspection request made by the RP use HTTP POST,RP,,Introspection request | url | POST,The request to the Introspection Endpoint must use HTTP POST,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,L,Incorrect handling,,,,,,,,FALSE,x,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-token,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the token parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Introspection request,Does the Introspection Request contain the token,The Introspection request made by the RP is taken and the presence of the token parameter is checked.,RP,,Introspection request | body | token,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Introspection request-token-type,Introspection Request's parameters,Introspection request,Trigger Introspection request,"Compliant if the token parameter in the request is a valid JWT, not compliant otherwise",HTTP parameter type,Correct Input,Introspection request,Does the Introspection Request contain correct type token,The Introspection request made by the RP is taken and the type of the token parameter is a JWT,RP,,Introspection request | body | token=([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*)(?:&|$),The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s_CIE_introsp,E,,P,P,passed,
x,RP-Revocation request-client_assertion,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the client_assertion parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Revocation request,Does the Revocation Request contain the client assertion,The Revocation request made by the RP is taken and the presence of the client_assertion parameter is checked.,RP,,Revocation request | body | client_assertion,The request to the Revocation Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Revocation request-client_assertion_type,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the client_assertion_type parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Revocation request,Does the Revocation Request contain the client_assertion_type,The Revocation request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,RP,,Revocation request | body | client_assertion_type,The request to the Revocation Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Revocation request-client_assertion_type-value,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the client_assertion_type parameter in the request is urn:ietf:params:oauth:clientassertion-type:jwt-bearer, not compliant otherwise",HTTP parameter value,Correct Input,Revocation request,Does the Revocation Request contain correct client_assertion_type,The Revocation request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,RP,,Revocation request | body | client_assertion_type | urn:ietf:params:oauth:client-assertion-type:jwt-bearer,The request to the Revocation Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Revocation request-client_assertion-type,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the client_assertion parameter in the request is a valid JWT, not compliant otherwise",HTTP parameter type,Correct Input,Revocation request,Does the Revocation Request contain correct type of client assertion,The Revocation request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,RP,,Revocation request | body | client_assertion=([\w]+)\.([\w]+)\.([\w\-]*)(?:&|$),The request to the Revocation Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Revocation request-client_id,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the client_id parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Revocation request,Does the Revocation Request contain the client_id of the RP making the request,The Revocation request made by the RP is taken and the presence of the client_id parameter is checked.,RP,,Revocation request | body | client_id,The request to the Revocation Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,Is revocation bound to a specific client (IsBoundToClient),,,,,,,TRUE,,,no,s1,E,,P,P,passed,
x,RP-Revocation request-client_id-different-value,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the Revocation response is an HTTP 401 because of invalid_client, not compliant otherwise",Param Response,Wrong Input,Revocation request,Does the Revocation Request contain correct client_id of the RP making the request,The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,RP,Revocation request | body | (?<=client_id=)([^&]+) | https://example.com,Revocation response | head | 401 | body | invalid_client,The request to the Revocation Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Active,L,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",Is revocation bound to a specific client (IsBoundToClient),,,,,,,TRUE,,,no,s1,E,Problema implementazione,F,F,failed,[SAME] Ritorna 400 invalid_request
x,RP-Revocation request-client_id-value,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the client_id parameter in the request is an URI, not compliant otherwise",JSON parameter type,Correct Input,Revocation request,Does the Revocation Request contain correct type of client_id of the RP making the request,The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,RP,,"Revocation request | body |  | {""type"":""object"", ""properties"":{""client_id"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://""}},""required"":[""client_id""]}",The request to the Revocation Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,Is revocation bound to a specific client (IsBoundToClient),,,,,,,TRUE,,,no,s1,E,Problema implementazione,F,F,failed,URL è HTTP non HTTPS
x,RP-Revocation request-token,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the token parameter in the request is present, not compliant otherwise",HTTP parameter presence,Correct Input,Revocation request,Does the Revocation Request contain the token for which the request is made,The Revocation request made by the RP is taken and the presence of the token parameter is checked.,RP,,Revocation request | body | token,The request to the Revocation Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Revocation request-token-type,Revocation Request's parameters,Revocation request,Trigger Revocation request,"Compliant if the token parameter in the request is a valid JWT, not compliant otherwise",HTTP parameter type,Correct Input,Revocation request,Does the Revocation Request contain correct type of token for which the request is made,The Revocation request made by the RP is taken and the value of the token parameter is a JWT.,RP,,Revocation request | body | token=([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*)(?:&|$),The request to the Revocation Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-aud,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the aud claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token request,Does the signed JWT assertion contain the aud claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the aud claim is present.",RP,,Token request | body | (?<=client_assertion=)([^&]+) | payload | aud,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the aud claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-aud-type,Token request's client assertion,Token request,Trigger Token request,"Compliant if the aud claim in the client assertion JWT is set to an URL, not Compliant otherwise",JWT parameter type,Correct Input,Token request,Does the signed JWT assertion contain a correct aud claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the aud. Its value must be an URL",RP,,"Token request | body | (?<=client_assertion=)([^&]+) | payload |  | {""type"": ""object"", ""properties"": {""aud"": {""type"": ""array"", ""format"": ""uri-reference""}}, ""required"": [""aud""]}","The client assertion parameter contains a single (signed) JWT which must contain, among others, the aud claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-exp,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the exp claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token request,Does the signed JWT assertion contain the exp claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the exp claim is present",RP,,Token request | body | (?<=client_assertion=)([^&]+) | payload | exp,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the exp claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-exp-type,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the exp claim and its value is a timestamp, not Compliant otherwise",JWT parameter type,Correct Input,Token request,Does the signed JWT assertion contain a correct exp claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the exp claim. Its value must be a timestap",RP,,"Token request | body | (?<=client_assertion=)([^&]+) | payload |  | {""type"": ""object"", ""properties"": {""exp"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""exp""]}","The client assertion parameter contains a single (signed) JWT which must contain, among others, the exp claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-iat,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the iat claim and its value is a timestamp before the current one, not Compliant otherwise",JWT parameter presence,Correct Input,Token request,Does the signed JWT assertion contain the iat claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the iat claim is present.",RP,,Token request | body | (?<=client_assertion=)([^&]+) | payload | iat,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iat claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-iat-type,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the iat claim and its value is a timestamp, not Compliant otherwise",JWT parameter type,Correct Input,Token request,Does the signed JWT assertion contain a correct iat claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the iat claim. Its value must be a timestap",RP,,"Token request | body | (?<=client_assertion=)([^&]+) | payload |  | {""type"": ""object"", ""properties"": {""iat"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""iat""]}","The client assertion parameter contains a single (signed) JWT which must contain, among others, the iat claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-iss,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the iss claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token request,Does the JWT payload contain 'iss' claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the iss claim is present.",RP,,Token request | body | (?<=client_assertion=)([^&]+) | payload | iss,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-iss-value,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the iss claim and it is set to the client ID of the RP making the request, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Token request,Does the JWT payload contain a correct 'iss' claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the RP",RP,Token request | body | (?<=client_assertion=)([^&]+) | payload | iss,Entity Configuration response RP | body | [^\r\n]* | payload | metadata.openid_relying_party.client_id | client_id,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Token request-Assertion-jti,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the jti claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token request,Does the signed JWT assertion contain the jti claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the jti claim is present.",RP,,Token request | body | (?<=client_assertion=)([^&]+) | payload | jti,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the jti claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-sub,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the sub claim, not Compliant otherwise",JWT parameter presence,Correct Input,Token request,Does the signed JWT assertion contain the sub claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the sub claim is present.",RP,,Token request | body | (?<=client_assertion=)([^&]+) | payload | sub,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-Assertion-sub-value,Token request's client assertion,Token request,Trigger Token request,"Compliant if the client assertion JWT contains the sub claim and it is set to the same value of the iss claim, not Compliant otherwise",JWT Check-Save to JWT_same message,Correct Input,Token request,Does the JWT payload contain a correct sub claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the sub claim. Its value must be the same of the iss value",RP,Token request | body | (?<=client_assertion=)([^&]+) | payload | iss,payload | sub | saved_iss,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the same value of iss",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Active,M,Mismatch of parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-client_assertion,Token request,Token request,Trigger Token request,"Compliant if the Token request contains the client_assertion parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token request,Does the token request contain the client_assertion,The token request sent by the RP must contain client_assertion parameter in the URL,RP,,Token request | body | client_assertion,An RP doing a Token Request must insert the client_assertion parameter in the request and it is a signed JWT,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-client_assertion_type,Token request,Token request,Trigger Token request,"Compliant if the Token Request contains the client_assertion_type parameter,not Compliant otherwise",HTTP parameter presence,Correct Input,Token request,Does the token request contain the client_assertion_type,The token request sent by the RP must contain client_assertion_type parameter in the URL,RP,,Token request | body | client_assertion_type,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-client_assertion_type-value,Token request,Token request,Trigger Token request,"Compliant if the client_assertion_type parameter in the request is urn:ietf:params:oauth:clientassertion-type:jwt-bearer, not compliant otherwise",HTTP parameter value,Correct Input,Token request,Does the client_assertion_type parameter in the token request contain the correct type,The client_assertion_type parameter in the URL of the token request sent by the RP must be set to urn:ietf:params:oauth:client-assertion-type:jwtbearer,RP,,Token request | body | client_assertion_type | urn:ietf:params:oauth:client-assertion-type:jwt-bearer,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-client_assertion-signature,Token request's client assertion,Token request,Trigger Token request,"Compliant if the signature of the client_assertion parameter in the token request is valid, not Compliant otherwise",JWT signature check,Correct Input,Token request,Does the client_assertion in the token request have a correct signature,The client_assertion parameter in the token request sent by the RP must be a JWT with a signature,RP,,Token request | body | (?<=client_assertion=)([^&]+) | X_key_core_RP,An RP doing a Token Request must insert the client_assertion parameter in the request and it is a signed JWT,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Token request-client_assertion-type,Token request,Token request,Trigger Token request,"Compliant if the client_assertion parameter in the token request is a valid JWT, not Compliant otherwise",HTTP parameter type,Correct Input,Token request,Does the client_assertion in the token request contain a JWT,The client_assertion parameter in the token request sent by the RP must be a JWT,RP,,Token request | body | client_assertion=([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*)(?:&|$),An RP doing a Token Request must insert the client_assertion parameter in the request and it is a signed JWT,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-client_id,Token request,Token request,Trigger Token request,"Compliant if the token request contains the client_id parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token request,Does the token request contain the client_id,The token request sent by the RP must contain client_id parameter in the URL,RP,,Token request | body | client_id,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-code,Token request,Token request,Trigger Token request,"Compliant if the Token Request contains the code parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token request,Does the token request contain the code parameter,The token request sent by the RP must contain code parameter in the URL,RP,,Token request | body | code,"An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code', than it must contain the code and the code_verifier",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-code_verifier,Token request,Token request,Trigger Token request,"Compliant if the Token Request contains the code_verifier parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token request,Does the token request contain the code_verifier parameter,The token request sent by the RP must contain code_verifier parameter in the URL,RP,,Token request | body | code_verifier,"An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code', than it must contain the code and the code_verifier",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-grant_type,Token request,Token request,Trigger Token request,"Compliant if the Token Request contains the grant_type parameter, not Compliant otherwise",HTTP parameter presence,Correct Input,Token request,Does the token request contain the grant_type parameter,The token request sent by the RP must contain grant_type parameter in the URL,RP,,Token request | body | grant_type,An RP doing a Token Request must insert the grant_type parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-grant_type-value,Token request,Token request,Trigger Token request,"Compliant if the Token Request set the grant_type parameter to authorization_code or refresh_token, not Compliant otherwise",HTTP list value,Correct Input,Token request,Does the token request contain a correct grant_type parameter,The grant_type parameter in the URL of the token request sent by the RP must be set to authorization_code or to refresh_token. So in this test a token request is taken and the grant_type parameter is checked,RP,,"Token request | body | (?<=grant_type=)([^&]+) | [""authorization_code"", ""refresh_token""]",An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code'  or 'refresh_token',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-http_post,Token request,Token request,Trigger Token request,"Compliant if the Token request is sent in HTTP POST, not Compliant otherwise",HTTP parameter type,Correct Input,Token request,Does the token request use HTTP POST,The token request sent by the RP must be sent in HTTP POST,RP,,Token request | head | POST,An RP doing a Token Request must be done via HTTP POST,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Token request-url-client_id-type,Token request,Token request,Trigger Token request,Compliant if the token request contains a client_id parameter and it is an HTTPS URL. Not Compliant otherwise,JSON parameter type,Correct Input,Token request,Does the client_id in the token request contain an HTTPS URL,The client_id parameter in the URL of the token request is taken and checked to be an HTTPS URL,RP,,"Token request | body |  | {""type"":""object"", ""properties"":{""client_id"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://""}},""required"":[""client_id""]})",An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,H,If the URL is not an HTTP there is a  lack of security for transmitted data,,,,,,,,FALSE,x,,no,s1,E,Problema implementazione,F,F,failed,URL è HTTP non HTTPS
x,RP-Token request-url-client_id-value,Token request,Token request,Trigger Token request,Compliant if the token request contains a client_id parameter identifying the RP. Not Compliant otherwise,HTTP parameter value,Correct Input,Token request,Does the client_id in the token request identifies the RP,The client_id parameter in the URL of the token request is taken. This parameter must identify the RP,RP,,Token request | body | client_id | X_https_RP,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Passive,M,Mismatch of content,,,,,,,,FALSE,x,,yes,s1,E,,P,P,passed,
x,RP-Token response-id_token-payload-aud-value,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token has the aud parameter set to the RP's client ID, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Token response,Does the issued JWT ID Token contain the 'aud' parameter in the Payload set to RP's 'client_id',"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'aud' parameter in the Payload set to the RP's 'client_id'",RP,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | aud[0]",Entity Configuration response RP | body | [^\r\n]* | payload | iss | saved_iss,The JWT ID Token Payload requires the aud parameter and it must contain the RP's client_id,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Active,M,Mismatch of parameter,Is the token audience set (HasCorrectAudience),ID Token has aud claim,,,,"3.3.7, 3.3.8",,TRUE,x,,yes,s1,E,,P,P,passed,
x,RP-User logout-token-revocation,User's logout,Revocation request,Trigger User logout,"Compliant if the RP sends a Revocation Request regarding the access token, not compliant otherwise",HTTP parameter presence,Correct Input,User logout,Does the RP revoke the Token when the User logs out,"In order to test if the RP really revokes an access token on logout, a classic authentication flow is computed and, once obtained the token and used, a logout is performed. After this, the requests made by the RP must be analyzed and there has to be a request to the OP's revocation endpoint for only the access token",RP,,Revocation request | body | token,"When the user logs out, the RP MUST revoke the Access Token in its possession",SPID_CIE_OIDC#logout; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/logout.html,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,,,no,s1,E,,P,P,passed,
x,RP-Userinfo request-access-token,RP's UserInfo request,Userinfo request,Trigger Userinfo request,"Compliant if the the authorization field in the header of the UserInfo Request contains an Access Token, not compliant otherwise",HTTP parameter presence,Correct Input,Userinfo request,Does the RP contain the Access Token in the UserInfo request,The UserInfo request from the RP is taken and analyzed. In the Authorization field of the header there must be an Access Token,RP,,UserInfo request | head | Authorization,"In order to obtain the requested claims, the RP sends a request to the UserInfo Endpoint using the Access Token",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,M,Missing parameter,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,RP-Userinfo request-access-token-valid,RP's UserInfo request,Userinfo request,Trigger Userinfo request,"Compliant if the authorization field in the header of the UserInfo Request contains a valid Access Token (JWT), not compliant otherwise",HTTP parameter type,Correct Input,Userinfo request,Does the RP contain a valid Access Token in the UserInfo request,The UserInfo request from the RP is taken and analyzed. In the Authorization field of the head there must be a valid Access Token,RP,,UserInfo request | head | Authorization:\s?Bearer\s?([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"In order to obtain the requested claims, the RP sends a request to the UserInfo Endpoint using the Access Token",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Passive,L,Type mismatch,,,,,,,,FALSE,x,,no,s1,E,,P,P,passed,
x,SA-Entity Configuration response-metadata-logo_uri-type,SA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim is an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the TA metadata contain correct type logo_uri claim,In this test the SA metadata in the TA Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL with an .svg file,SA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"":""object"", ""properties"":{""logo_uri"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://.*\\.svg$""}},""required"":[""logo_uri""]}",The SA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-contacts,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'contacts' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the contacts parameter,In this test the SA metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.contacts,The TA and SA metadata must contain the parameter contacts,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-federation_fetch_endpoint,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_fetch_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the federation_fetch_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_fetch_endpoint,The TA and SA metadata must contain the parameter federation_fetch_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-federation_list_endpoint,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_list_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the federation_list_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_list_endpoint,The TA and SA metadata must contain the parameter federation_list_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-federation_resolve_endpoint,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_resolve_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the federation_resolve_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_resolve_endpoint,The TA and SA metadata must contain the parameter federation_resolve_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-federation_trust_mark_status_endpoint,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_trust_mark_status_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the federation_trust_mark_status_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_trust_mark_status_endpoint,The TA and SA metadata must contain the parameter federation_trust_mark_status_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-homepage_uri,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'homepage_uri' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the homepage_uri parameter,In this test the SA metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.homepage_uri,The TA and SA metadata must contain the parameter homepage_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.28,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-logo_uri,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'logo_uri' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the logo_uri parameter,In this test the SA metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.logo_uri,The TA and SA metadata must contain the parameter logo_uri and it must be in SVG format,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-organization_name,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'organization_name' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the organization_name parameter,In this test the SA metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.organization_name,The TA and SA metadata must contain the parameter organization_name,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.27,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-metadata-policy_uri,SA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'policy_uri' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the SA's metadata contain the policy_uri parameter,In this test the SA metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,SA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.policy_uri,The TA and SA metadata must contain the parameter policy_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-trust_marks,SA's entity configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'trust_marks' parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the entity configuration of the SA contain the trust marks,"The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the metadata in the response are analyzed. Among them, the 'trust_marks' parameter must be present.",SA,,Entity Configuration response | body | [^\r\n]* | payload | trust_marks,"The RP, OP or SA must include the trust marks in the entity configuration as a result of the onboarding process",SPID_CIE_OIDC#entity-configuration-leaves-and-intermediaries; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Configuration response-trust_marks-type,SA's entity configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the 'trust_marks' parameter is a JSON array, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the entity configuration of the SA contain a correct trust_marks parameter,"The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the configuration metadata are analyzed. Among them, the 'trust_marks' parameter must be present and must be a JSON array containing the Trust Marks.",SA,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""trust_marks"": {""type"": ""object"", ""additionalProperties"": {""type"": ""array""}}}, ""required"": [""trust_marks""]}","The RP, OP or SA must include the trust marks in the entity configuration as a result of the onboarding process",SPID_CIE_OIDC#entity-configuration-leaves-and-intermediaries; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Listing endpoint response-exposed,Entity Listing endpoint response,Entity Listing endpoint response,Trigger Entity Listing endpoint response,"Compliant if the Response contains a JSON list (array), not compliant otherwise",HTTP parameter type,Correct Input,Entity Listing endpoint response,Does the Entity expose the entity listing endpoint,"In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request entity's endpoint. An HTTP 200 OK response containing a JSON list with the known Entity Identifiers is expected",SA,,"Entity Listing response | body | [^\r\n]*.^\{(\s*""[^""]*""\s*:\s*(?:""[^""]*"",?|\[[^\r\n]*\],?|\{[^\r\n]*\},?)\s*)*\}$",This test simply checks if the entity exposes the /.well-known/openid-federation endpoint and if it,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-constraints,Entity Statement issued by the SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the constraints parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the constraints parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | constraints,The constraints parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-exp,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the exp parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | exp,The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-exp-type,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the exp parameter is a timestamp, not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain a correct exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""exp"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""exp""]}",The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-iat,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iat parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | iat,The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-iat-type,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iat parameter is a timestamp, not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain a correct iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""iat"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""iat""]}",The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-iss,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iss parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the iss parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | iss,The iss parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-iss-value,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the client assertion JWT contains the iss claim and it is set to the client ID of the SA sending the Entity Statement, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Entity Statement response OP,Does the Entity Statement's JWT payload contain a correct 'iss' claim,"This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA",SA,Entity Configuration response SA | body | [^\r\n]* | payload | iss,Entity Statement response SA OP | url | client_assertion | payload | iss | conf_iss,The iss parameter is required in the Entity Statement released by the SA. Its value must be the Entity Identifier of the issuer of the statement,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Federation,Passive,M,Mismatch of parameter,,,,,,,,FALSE,x,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-jwks,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the jwks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the jwks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | jwks,The jwks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-metadata_policy,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the metadata_policy parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the metadata_policy parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | metadata_policy,The metadata_policy parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-release,SA's fetch Entity Statement Endpoint response regarding the Entity we are considering,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the SA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",HTTP parameter type,Correct Input,Entity Statement response OP,Does the SA correctly release the Entity statements,"After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",SA,,Entity Statement response SA OP | body | [^\r\n]*.^([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it. An Entity publishes an ES related to a subordinate, at its Fetch Endpoint.",SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-signature,Entity statement issued by the SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the signature is verified, not compliant otherwise",JWT signature check,Correct Input,Entity Statement response OP,Does the SA correctly signs the Entity Statement,"In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",SA,,Entity Statement response SA OP | body | [^\r\n]* | X_key_SA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#firma-di-entity-statement,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-sub,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the sub parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the sub parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | sub,The sub parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-claims,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | claims,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-claims-type,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the claims claim is present and its value is a list, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""claims"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""claims""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim and it is a list",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-email,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the email claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | email,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response OP-trust_mark-email-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the email claim is of type string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the correct type of email claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the email claim in it is checked.",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | {  ""type "":  ""object "",  ""properties "": {  ""email "": {  ""type "":  ""string "",  ""format "":  ""email "" } },  ""required "": [ ""email ""] } ",The issued Trust Marks must have the email claim as string,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-exp,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the exp claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | exp,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-exp-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the exp claim is UNIX Timestamp, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the exp type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the exp claim in it is checked.",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""exp"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""exp""]}",The issued Trust Marks must have the exp claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-fiscal_number-or-vat_number,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,nested JWT parameter type,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""fiscal_number"": {}, ""vat_number"":{}},""anyOf"":[{""required"":[""fiscal_number""]},{""required"":[""vat_number""]}]}},""required"":[""id_code""]}",The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-iat,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iat claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iat,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-iat-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iat claim is UNIX Timestamp, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the correct iat type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the iat claim in it is checked.",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""iat"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""iat""]}",The issued Trust Marks must have the iat claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-id,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the id claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the id claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-id_code,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the id_code claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id_code,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-id_code-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the id_code claim is a JSON Object, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain correcty type of id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""id_code""]}",The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-id-value,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the id is present, has the structure <SA domain>/<entity_type>/<trustmark_profile>/ and the entity_type and trustmark_profile parts of the URL have values among the allowed ones, not compliant otherwise",/ manual: check content,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks | trust_mark | payload | id | openid_relying_party | openid_provider | intermediate | oauth_resource,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,Da capire come individuare che solo l'entity type sia all'interno dei valori dati,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-ipa_code,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,nested JWT parameter type,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain the ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": { ""id_code"": { ""type"": ""object"", ""properties"": {""ipa_code"": {}},""required"": [""ipa_code""]}},""required"": [""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response OP-trust_mark-ipa_code-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""ipa_code"": { ""type"":""string""}},""required"":[""ipa_code""]}},""required"":[""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response OP-trust_mark-iss,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iss claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iss,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-iss-type,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the iss claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""iss"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""iss""]}",The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-logo_uri,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the logo_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | logo_uri,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-logo_uri-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the logo_uri claim is value is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain correct type of logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""logo_uri"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""logo_uri""]}",The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-organization_name,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the organization_name claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_name,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-organization_name-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the organization_name claim is type string and has value ""public"" or ""private"", not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the correct type of organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the organization_name claim in it is checked.",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type "":  ""object "", ""properties "": { ""organization_name "": { ""type "":  ""string "", ""enum "": [ ""private "",  ""public ""]}}, ""required "": [ ""organization_name ""]}",The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-organization_type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the organization_type claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_type,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
o,SA-Entity Statement response OP-trust_mark-organization_type-value,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the organization_type claim contains 'public' or 'private', not compliant otherwise",nested JWT parameter values,Correct Input,Entity Statement response OP,Does the Trust Mark contain correct value for organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_type | [""public"", ""private""]",The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-policy_uri,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | policy_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-policy_uri-type,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the policy_uri claim is present and its value is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""policy_uri"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""policy_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-ref,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the ref claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | ref,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-ref-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the ref claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain an URL in the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the ref claim in it is checked.",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""ref"": { ""type"": ""string"", ""format"": ""uri"" } }, ""required"": [""ref""] }",The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-sa_profile,Trust Mark generated for an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the sa_profile claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued intermediary Trust Mark contain the sa_profile claim,"A Trust Mark issued by a TA for an SA is taken, decrypted and the presence of the sa_profile claim is checked.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sa_profile,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
o,SA-Entity Statement response OP-trust_mark-sa_profile-value,Trust Mark generated for an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the sa_profile claim is 'full' or 'light', not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued intermediary Trust Mark contain a correct sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type "":  ""object "", ""properties "": { ""sa_profile"": { ""type "":  ""string "", ""enum "": [ ""full "",  ""light ""]}}, ""required "": [ ""sa_profile ""]}","In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-service_documentation,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | service_documentation,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-service_documentation-type,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the service_documentation claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""service_documentation"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""service_documentation""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-signature,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the signature of the trust marks in the entity statement is valid, not compliant otherwise",nested JWT signature check,Correct Input,Entity Statement response OP,Does the SA correctly sign the Trust marks,"To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks | trust_mark | X_key_SA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-sub,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the sub claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sub,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
o,SA-Entity Statement response OP-trust_mark-sub-type,Trust Mark generated by TA or SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the sub claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""sub"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""sub""]}",The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-tos_uri,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | tos_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_mark-tos_uri-type,Trust Mark generated for an AA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the tos_uri claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL",SA,,"Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""tos_uri"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""tos_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response OP-trust_marks,Entity Statement issued by an SA,Entity Statement response SA OP,Trigger Entity Statement response SA OP,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the SA contain the trust_marks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",SA,,Entity Statement response SA OP | body | [^\r\n]* | payload | trust_marks,The trust_marks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-constraints,Entity Statement issued by the SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the constraints parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the constraints parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | constraints,The constraints parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-exp,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the exp parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | exp,The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-exp-type,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the exp parameter is a timestamp, not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain a correct exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""exp"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""exp""]}",The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-iat,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iat parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | iat,The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-iat-type,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iat parameter is a timestamp, not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain a correct iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""iat"": {""type"": ""integer"", ""minimum"": 0}}, ""required"": [""iat""]}",The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-iss,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iss parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the iss parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | iss,The iss parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-iss-value,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the client assertion JWT contains the iss claim and it is set to the client ID of the SA sending the Entity Statement, not Compliant otherwise",JWT Check-Save to JWT,Correct Input,Entity Statement response RP,Does the Entity Statement's JWT payload contain a correct 'iss' claim,"This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA",SA,Entity Configuration response SA | body | [^\r\n]* | payload | iss,Entity Statement response SA RP | url | client_assertion | payload | iss | conf_iss,The iss parameter is required in the Entity Statement released by the SA. Its value must be the Entity Identifier of the issuer of the statement,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Federation,Passive,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-jwks,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the jwks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the jwks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | jwks,The jwks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-metadata_policy,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the metadata_policy parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the metadata_policy parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | metadata_policy,The metadata_policy parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-metadata_policy-jwks,Metadata policy in an Entity Statement issued by the SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the jwks parameter is present in the openid_relying_party type and it contains the RP's JWKS (type json), not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response RP,Does the SA's metadata policy for an RP contain the jwks parameter,"In order to check the compliance of a metadata policy issued by the SA, an entity statement for an RP must be fetched in the SA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations",SA,,"Entity Statement response SA RP | body | [^\n\r]* | payload | .metadata_policy.openid_relying_party.jwks | {""type"":""object"", ""properties"": {""value"" :{}}, ""required"": [""value""]}",The jwks claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that an SA establishes for an RP that is its direct descendant,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-release,SA's fetch Entity Statement Endpoint response regarding the Entity we are considering,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the SA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",HTTP parameter type,Correct Input,Entity Statement response RP,Does the SA correctly release the Entity statements,"After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",SA,,Entity Statement response SA RP | body | [^\r\n]*.^([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it. An Entity publishes an ES related to a subordinate, at its Fetch Endpoint.",SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-signature,Entity statement issued by the SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the signature is verified, not compliant otherwise",JWT signature check,Correct Input,Entity Statement response RP,Does the SA correctly signs the Entity Statement,"In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",SA,,Entity Statement response SA RP | body | [^\r\n]* | X_key_SA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#firma-di-entity-statement,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-sub,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the sub parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the sub parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | sub,The sub parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-claims,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | claims,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-claims-type,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the claims claim is present and its value is a list, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""claims"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""claims""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim and it is a list",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-email,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the email claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | email,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-email-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the email claim is of type string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the correct type of the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the email claim in it is checked.",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | {  ""type "":  ""object "",  ""properties "": {  ""email "": {  ""type "":  ""string "",  ""format "":  ""email "" } },  ""required "": [ ""email ""] } ",The issued Trust Marks must have the email claim as string,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-exp,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the exp claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | exp,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-trust_mark-exp-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the exp claim is UNIX Timestamp, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the exp type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the exp claim in it is checked.",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""exp"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""exp""]}",The issued Trust Marks must have the exp claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-fiscal_number-or-vat_number,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,nested JWT parameter type,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""fiscal_number"": {}, ""vat_number"":{}},""anyOf"":[{""required"":[""fiscal_number""]},{""required"":[""vat_number""]}]}},""required"":[""id_code""]}",The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-iat,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iat claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iat,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-iat,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iat type is in UNIX Timestamp in the trust mark payload, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the correct iat type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the iat claim in it is checked.",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""iat"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""iat""]}",The issued Trust Marks must have the iat claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,OP-Token response-id_token-payload-nbf,ID Token Payload,Token response,Trigger Token response,"Compliant if the ID Token contains the nbf claim, not Compliant otherwise",/ not to do,Correct Input,Token response,Does the issued JWT ID Token contain the 'nbf' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nbf' parameter in the Payload is checked.",OP,,"Token response | body | (?<=""id_token"": "")[^""]+ | payload | nbf",The JWT ID Token Payload requires the nbf parameter and it has to be equal to iat,External: solo SPID | SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Passive,,,,,,,,,,FALSE,x,,,,,,,Manca parametro nbf,,
,SA-Entity Statement response RP-trust_mark-id,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the id claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the id claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-id_code,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the id_code claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id_code,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-id_code-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the id_code claim is a JSON Object, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain correcty type of id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""id_code""]}",The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-id-value,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the id is present, has the structure <SA domain>/<entity_type>/<trustmark_profile>/ and the entity_type and trustmark_profile parts of the URL have values among the allowed ones, not compliant otherwise",/ manual: check content,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks | trust_mark | payload | id | openid_relying_party | openid_provider | intermediate | oauth_resource,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,Da capire come individuare che solo l'entity type sia all'interno dei valori dati,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-ipa_code,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,nested JWT parameter type,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain the ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": { ""id_code"": { ""type"": ""object"", ""properties"": {""ipa_code"": {}},""required"": [""ipa_code""]}},""required"": [""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-ipa_code-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""ipa_code"": { ""type"":""string""}},""required"":[""ipa_code""]}},""required"":[""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-trust_mark-iss,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iss claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iss,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-trust_mark-iss-type,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the iss claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""iss"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""iss""]}",The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-logo_uri,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the logo_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | logo_uri,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-logo_uri-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the logo_uri claim is value is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain correct type of logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""logo_uri"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""logo_uri""]}",The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-organization_name,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the organization_name claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_name,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-trust_mark-organization_name-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the organization_name claim is type string and has value ""public"" or ""private"", not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the correct type of organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the organization_name claim in it is checked.",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type "":  ""object "", ""properties "": { ""organization_name "": { ""type "":  ""string "", ""enum "": [ ""private "",  ""public ""]}}, ""required "": [ ""organization_name ""]}",The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-organization_type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the organization_type claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_type,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-organization_type-value,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the organization_type claim contains 'public' or 'private', not compliant otherwise",nested JWT parameter values,Correct Input,Entity Statement response RP,Does the Trust Mark contain correct value for organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_type | [""public"", ""private""]",The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-policy_uri,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | policy_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-policy_uri-type,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the policy_uri claim is present and its value is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""policy_uri"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""policy_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-ref,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the ref claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | ref,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-trust_mark-ref-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the ref claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain an URL in the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the ref claim in it is checked.",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks.trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""ref"": { ""type"": ""string"", ""format"": ""uri"" } }, ""required"": [""ref""] }",The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Entity Statement response RP-trust_mark-sa_profile,Trust Mark generated for an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the sa_profile claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued intermediary Trust Mark contain the sa_profile claim,"A Trust Mark issued by a TA for an SA is taken, decrypted and the presence of the sa_profile claim is checked.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sa_profile,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
o,SA-Entity Statement response RP-trust_mark-sa_profile-value,Trust Mark generated for an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the sa_profile claim is 'full' or 'light', not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued intermediary Trust Mark contain a correct sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type "":  ""object "", ""properties "": { ""sa_profile"": { ""type "":  ""string "", ""enum "": [ ""full "",  ""light ""]}}, ""required "": [ ""sa_profile ""]}","In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-service_documentation,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | service_documentation,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-service_documentation-type,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the service_documentation claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""service_documentation"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""service_documentation""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-signature,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the signature of the trust marks in the entity statement is valid, not compliant otherwise",nested JWT signature check,Correct Input,Entity Statement response RP,Does the SA correctly sign the Trust marks,"To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks | trust_mark | X_key_SA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-sub,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the sub claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sub,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-sub-type,Trust Mark generated by TA or SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the sub claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""sub"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""sub""]}",The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-tos_uri,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | tos_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_mark-tos_uri-type,Trust Mark generated for an AA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the tos_uri claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL",SA,,"Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""tos_uri"": {""type"": ""string"", ""format"": ""uri-reference"", ""pattern"": ""^https://""}}, ""required"": [""tos_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
,SA-Entity Statement response RP-trust_marks,Entity Statement issued by an SA,Entity Statement response SA RP,Trigger Entity Statement response SA RP,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the SA contain the trust_marks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",SA,,Entity Statement response SA RP | body | [^\r\n]* | payload | trust_marks,The trust_marks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Fetch Entity Statement response RP-exposed,Fetch Entity Statement Endpoint endpoint response,Fetch Entity Statement response SA RP,Trigger Fetch Entity Statement response SA RP,"Compliant if the response contains a JWT, not compliant otherwise",HTTP parameter type,Correct Input,Fetch Entity Statement response RP,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",SA,,Fetch Entity Statement response SA RP | body | [^\r\n]*.^([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Trust Mark status response OP-exposed-OP,Trust Mark Status Response,Trust Mark status response SA OP (endpoint response),Trigger Trust Mark status response SA OP (endpoint response),HTTP 200 OK response containing the claim 'active' set to true,/ manual: TM check content,Correct Input,Trust Mark status response OP,Does the SA Trust Mark Status endpoint effectively verify valid Trust Marks of OP,"To check if the trust mark status endpoint accurately verifies valid trust marks, valid trust marks obtained directly from the OP Entity Configuration response can be sent to the endpoint dynamically according to the 'iss' of the trust mark, and the response can be analyzed.",SA,,,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the trust mark status endpoint. It allows an Entity to test if a TM is still active or not.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Trust Mark status response OP-not_valid-trust_mark-OP,Trust Mark status endpoint response,Trust Mark status response SA OP (endpoint response),Trust Mark status request with a non-valid Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response OP,Does the SA's trust mark status endpoint correctly refuses a not-valid id Trust Marks OP,"In order to check if the trust mark status endpoint of a SA correctly refuses invalid trust marks OP, a invalid trust mark can be sent to the endpoint and the response analyzed",SA,,,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Trust Mark status response RP-exposed-RP,Trust Mark Status Response,Trust Mark status response SA RP (endpoint response),Trigger Trust Mark status response SA RP (endpoint response),HTTP 200 OK response containing the claim 'active' set to true,/ manual: TM check content,Correct Input,Trust Mark status response RP,Does the SA Trust Mark Status endpoint effectively verify valid Trust Marks of RP,"To check if the trust mark status endpoint accurately verifies valid trust marks, valid trust marks obtained directly from the RP Entity Configuration response can be sent to the endpoint dynamically according to the 'iss' of the trust mark, and the response can be analyzed.",SA,,,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the trust mark status endpoint. It allows an Entity to test if a TM is still active or not.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,,s1,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Trust Mark status response RP-not_valid-trust_mark-RP,Trust Mark status endpoint response,Trust Mark status response SA RP (endpoint response),Trust Mark status request with a non-valid Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response RP,Does the SA's trust mark status endpoint correctly refuses a not-valid id Trust Marks RP,"In order to check if the trust mark status endpoint of a SA correctly refuses invalid trust marks RP, a invalid trust mark can be sent to the endpoint and the response analyzed",SA,,,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,SA-Trust Mark status response SA-different-entity-trust_mark,Trust Mark status endpoint response,Trust Mark status endpoint response,Trust Mark status invalid request,"Compliant if the Trust Mark status response is an HTTP 400 because of invalid_request, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response SA,Does the SA checks Trust Marks not issued by the Entity,"In this test, a valid Trust Mark issued by another entity is sent to an SA. If it validates the Trust Mark, than is not compliant with the specifications",SA,,,trust mark status endpoint: allows an Entity to test if a TM is still active or not. The request MUST be sent to the subject that has released that TM.,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Messaggio non presente,N_A,SA non presente,not_applicable,
o,SA-Trust Mark status response SA-revocated-trust_mark,Trust Mark status endpoint response,Trust Mark status endpoint response,Trust Mark status endpoint request with invalidated Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response SA,Does the SA invalidate revocated trust marks,"In order to check if a SA correctly invalidate a Trust Mark, a Trust Mark revocation request on a Trust Mark has to be made and then the trust mark status endpoint must be fetched. If the response says that the trust mark is invalid, than it is correctly invalidated, otherwise the SA is not compliant with the specification",SA,,,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Messaggio non presente,N_A,SA non presente,not_applicable,
x,TA-Entity Configuration response-constraints,TA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the constraints parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the Entity configuration of the Trust Anchor contain the constraints parameter in its decoded payload,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked",TA,,Entity Configuration response | body | [^\r\n]* | payload | constraints,TA's Entity Configuration must have the 'constraints' and 'trust_marks_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-constraints-type,TA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the constraints parameter is a JSON object, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the Trust Anchor's Entity configuration contain a constraints parameter valued as a JSON Object with a max_path_length claim,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must be a JSON Object",TA,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""constraints"": {""type"": ""object"", ""properties"": {""max_path_length"": {}}, ""required"": [""max_path_length""]}, ""required"": [""constraints""]}}",TA's Entity Configuration must have the 'constraints' and 'trust_marks_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-constraints-value,TA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the constraints parameter contains the max_path_length attribute, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Trust Anchor's Entity configuration's constraints parameter contain the attribute 'max_path_length',"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must contain the attribute max_path_length",TA,,Entity Configuration response | body | [^\r\n]* | payload | constraints.max_path_length,TA's Entity Configuration must have the 'constraints' and 'trust_marks_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-jwks,Federation Configuration (TA's Entity Configuration),Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA's Entity Configuration response contains the TA's public keys, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does the Federation Configuration contain the TA public keys,"The Federation configuration must contain, among others, the TA public keys. To check the presence of those keys, the Entity Configuration is taken from the TA's '.well-known/openid-federation' endpoint and the response is analyzed, in the returned JWT the claim 'jwks' must be present",TA,,Entity Configuration response | body | [^\r\n]* | payload | jwks,"The Federation configuration contains the Trust Anchor public key for the signature operations, the maximum number of Intermediaries allowed between a Leaf and the Trust Anchor (max_path length) and the authorities who are enabled to issue the Trust Marks (trust_marks_issuers).",SPID_CIE_OIDC#Configuration-of-the-federation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/la_federazione_delle_identita.html#configurazione-della-federazione,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-contacts,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'contacts' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the contacts parameter,In this test the Entity metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.contacts,The TA and SA metadata must contain the parameter contacts,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-federation_fetch_endpoint,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_fetch_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the federation_fetch_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_fetch_endpoint,The TA and SA metadata must contain the parameter federation_fetch_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-federation_list_endpoint,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_list_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the federation_list_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_list_endpoint,The TA and SA metadata must contain the parameter federation_list_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-federation_resolve_endpoint,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_resolve_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the federation_resolve_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_resolve_endpoint,The TA and SA metadata must contain the parameter federation_resolve_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-federation_trust_mark_status_endpoint,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_trust_mark_status_endpoint' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the federation_trust_mark_status_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.federation_trust_mark_status_endpoint,The TA and SA metadata must contain the parameter federation_trust_mark_status_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-homepage_uri,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'homepage_uri' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the homepage_uri parameter,In this test the Entity metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.homepage_uri,The TA and SA metadata must contain the parameter homepage_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.28,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-metadata-logo_uri,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'logo_uri' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the logo_uri parameter,In this test the Entity metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.logo_uri,The TA and SA metadata must contain the parameter logo_uri and it must be in SVG format,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro logo_uri
x,TA-Entity Configuration response-metadata-logo_uri-type,TA metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the logo_uri claim is an URL, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does the TA metadata contain correct type logo_uri claim,In this test the TA metadata in the TA Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL with an .svg file,TA,,"Entity Configuration response | body | [^\n\r]* | payload | .metadata.federation_entity | {""type"":""object"", ""properties"":{""logo_uri"":{""type"":""string"", ""format"":""uri"", ""pattern"":""^https://.*\\.svg$""}},""required"":[""logo_uri""]}",The TA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,HTTP non HTTPS
x,TA-Entity Configuration response-metadata-organization_name,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'organization_name' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the organization_name parameter,In this test the Entity metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.organization_name,The TA and SA metadata must contain the parameter organization_name,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,1.3.27,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",TRUE,x,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro organization_name
x,TA-Entity Configuration response-metadata-policy_uri,TA's metadata,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'policy_uri' parameter, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Configuration response,Does the Entity's metadata contain the policy_uri parameter,In this test the Entity metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,TA,,Entity Configuration response | body | [^\r\n]* | payload | metadata.federation_entity.policy_uri,The TA and SA metadata must contain the parameter policy_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro policy_uri
x,TA-Entity Configuration response-trust_marks_issuers,TA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_marks_issuers parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Configuration response,Does TA's Entity configuration contain the trust_marks_issuers parameter,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks_issuers parameter is checked",TA,,Entity Configuration response | body | [^\r\n]* | payload | trust_mark_issuers,TA's Entity Configuration must have the 'constraints' and 'trust_marks_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Configuration response-trust_mark_issuers-type,TA's Entity Configuration,Entity Configuration response,Trigger Entity Configuration response,"Compliant if the trust_mark_issuers parameter is a JSON array, not compliant otherwise",JWT parameter type,Correct Input,Entity Configuration response,Does TA's Entity configuration's trust_mark_issuers parameter contain a JSON Array,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the trust_mark_issuers parameter must be a JSON Array.",TA,,"Entity Configuration response | body | [^\r\n]* | payload |  | {""type"": ""object"", ""properties"": {""trust_mark_issuers"": {""type"": ""object"", ""additionalProperties"": {""type"": ""array""}}}, ""required"": [""trust_mark_issuers""]}",TA's Entity Configuration must have the 'constraints' and 'trust_marks_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Listing endpoint response-exposed,Entity Listing endpoint response,Entity Listing endpoint response,Trigger Entity Listing endpoint response,"Compliant if the response contains a JSON list, not compliant otherwise",HTTP parameter type,Correct Input,Entity Listing endpoint response,Does the Entity expose the entity listing endpoint,"In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request to the entity's endpoint is done. A response containing a JSON list with the known Entity Identifiers is expected",TA,,"Entity Listing response | body | \[\s*""[^""]*""(?:,\s*""[^""]*"")*\s*\]$",This test simply checks if the entity exposes the /.well-known/openid-federation endpoint and if it,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,Manuali da definire per la prossima versione,N_A,N_A,not_applicable,Entity Listing response
x,TA-Entity Statement response OP-constraints,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the constraints parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the constraints parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | constraints,The constraints parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro constraints
x,TA-Entity Statement response OP-exp,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the exp parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the exp parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | exp,The exp parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-iat,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the iat parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the iat parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | iat,The iat parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-id_code-value,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_code claim is a JSON Object, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""id_code""]}",The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro id_code
x,TA-Entity Statement response OP-iss,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the iss parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statement issued by the TA contain the iss parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | iss,The iss parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-jwks,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the jwks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the jwks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | jwks,The jwks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-metadata_policy,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the metadata_policy parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the metadata_policy parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy,The metadata_policy parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-metadata_policy-acr_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the acr_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct acr_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must be a JSON object containing the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.acr_values_supported | {""type"": ""object"", ""properties"": {""subset_of"":{}, ""superset_of"":{}},""required"":[""subset_of"", ""superset_of""]}",The acr_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-acr_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the acr_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct acr_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must contain the value 'subset_of': ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.acr_values_supported.subset_of | [""https://www.spid.gov.it/SpidL1"", ""https://www.spid.gov.it/SpidL2"", ""https://www.spid.gov.it/SpidL3""]",The acr_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-authorization_response_iss_parameter_supported,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the authorization_response_iss_parameter_supported parameter is present in the openid_provider type, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the authorization_response_iss_parameter_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.authorization_response_iss_parameter_supported,The authorization_response_iss_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-authorization_response_iss_parameter_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the authorization_response_iss_parameter_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct authorization_response_iss_parameter_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.authorization_response_iss_parameter_supported.value,The authorization_response_iss_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
,TA-Entity Statement response OP-metadata_policy-authorization_response_iss_parameter_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the authorization_response_iss_parameter_supported parameter is present in the openid_provider type and contains the value 'one_of': ['true'], not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct authorization_response_iss_parameter_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.authorization_response_iss_parameter_supported | {""type"": ""object"", ""properties"": {""value"": {""const"": true}}, ""required"": [""value""]}",The authorization_response_iss_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-claims_parameter_supported,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the claims_parameter_supported parameter is present in the openid_provider type, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the claims_parameter_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the claims_parameter_supported parameter inside the openid_provider type is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.claims_parameter_supported,The claims_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-claims_parameter_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the claims_parameter_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct claims_parameter_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.claims_parameter_supported.value,The claims_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-claims_parameter_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the claims_parameter_supported parameter is present in the openid_provider type and contains the value 'one_of': ['true'], not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct claims_parameter_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.claims_parameter_supported | {""type"": ""object"", ""properties"": {""value"": {""const"": true}}, ""required"": [""value""]}",The claims_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-client_registration_types_supported,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the client_registration_types_supported parameter is present in the openid_provider type, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the client_registration_types_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types_supported parameter inside the openid_provider type is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.client_registration_types_supported.subset_of,The client_registration_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-client_registration_types_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,Compliant if the client_registration_types_supported parameter is present in the openid_provider type and contains the key 'one_of' not compliant otherwise,JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct client_registration_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.client_registration_types_supported.subset_of,The client_registration_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-client_registration_types_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the client_registration_types_supported parameter is present in the openid_provider type and contains the value 'one_of': ['automatic'], not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct client_registration_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['automatic']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.client_registration_types_supported | {""type"": ""object"", ""properties"": {""subset_of"": {""const"": ""automatic""}}, ""required"": [""subset_of""]}",The client_registration_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-code_challenge_methods_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the code_challenge_methods_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct code_challenge_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.code_challenge_methods_supported.subset_of,The code_challenge_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-code_challenge_methods_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the code_challenge_methods_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['S256'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct code_challenge_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['S256']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.code_challenge_methods_supported.subset_of | [""S256""]",The code_challenge_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-grant_types_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the grant_types_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct grant_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.grant_types_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The grant_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-grant_types_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the grant_types_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['refresh_token', 'authorization_code'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct grant_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['refresh_token', 'authorization_code']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.grant_types_supported.subset_of | [""refresh_token"", ""authorization_code""]",The grant_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-id_token_encryption_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_encryption_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.id_token_encryption_alg_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The id_token_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
,TA-Entity Statement response OP-metadata_policy-id_token_encryption_enc_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_encryption_enc_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_enc_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.id_token_encryption_enc_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The id_token_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-id_token_encryption_enc_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_encryption_enc_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_enc_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and must be valued as ['A128CBC-HS256', 'A256CBC-HS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encryption_enc_values_supported.one_of | [""A128CBC-HS256"", ""A256CBC-HS512""]",The id_token_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-id_token_signing_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant if it is missing or empty",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.id_token_signing_alg_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The id_token_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,message type - validate | {head/body/url} | jwt_name | {header/payload} | param_path,,,,,,,TRUE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
,OP-Authentication request-url-wrong-client_id,Authentication request URL,,,HTTP 302 error because of 'invalid_request',,Wrong Input,Authentication request,T1_a,The authentication request is intercepted and the 'client_id' field in the URL is edited to be a wrong value. The request is then forwarded and the result is an incorrect flow,OP,,,,External: T1_a (MIG),OIDC Core,active,,,,,,T1_a,,,client_id in URL is optional (should),TRUE,x,,,,,,,,,
,OP-Authentication request-url-missing-client_id,Authentication request URL,,,HTTP 400 error because of 'unauthorized_client',,Wrong Input,Authentication request,T1_b,"The authentication request is intercepted and the 'client_id' field is removed. After forwarding the request, the expected output is an incorrect flow",OP,,,,External: T1_b (MIG),OIDC Core,active,,,,,,T1_b,,,client_id in URL is optional (should),TRUE,x,,,,,,,,,
,OP-Authentication request-url-wrong-response_type,Authentication request URL,,,HTTP 400 error because of 'unsupported_response_type',,Wrong Input,Authentication request,T1_c,The authentication request is intercepted and the 'response_type' field in the URL is edited to be a wrong value. The request is then forwarded and the result is an incorrect flow,OP,,,,External: T1_c (MIG),OIDC Core,active,,,,"Auth request, no correct response_type","Auth request, no correct response_type",T1_c,,,response_type in URL is said should,FALSE,x,,,,,,,,,
,OP-Authentication request-url-missing-response_type,Authentication request URL,,,HTTP 400 error because of 'unsupported_response_type',,Wrong Input,Authentication request,T1_d,"The authentication request is intercepted and the 'response_type' field is removed from the URL. After forwarding the request, the expected output is an incorrect flow",OP,,,,External: T1_d (MIG),OIDC Core,active,,,,,,T1_d,,,response_type in URL is said should,TRUE,x,,,,,,,,,
,OP-Authentication request-token-replay,Authentication request JWT,,,HTTP 400 error because of 'invalid_grant',,Wrong Input,Authentication request,T7_a,"The authentication request in a first session is intercepted and the token present in the request parameter is saved. After forwarding and completing the first session, a second authentication request is initialized and the token saved previously is used in this second session. This results in an incorrect second flow.",OP,,,,External: T7_a (MIG),OIDC Core,active,,,Are replayed JWT's detected (IsJwtReplayDetected),,,T7_a,,,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Authentication request-code-length,Authorization code from authorization request,,,String asserting whether the code is valid or not,,Correct Input,Authentication request,Is the authorization code grant supported (CodeFlowSupported),"The OP takes the authorization code from the request and checks the length of the Code, assuring that it is of at least 128 bits. Moreover the entropy of the code is checked. If the code is not long enough or it cannot be retrieved (e.g., is null), an error is returned.",OP,,,,External: OAuch,OIDC Core,passive,,,Is the authorization code grant supported (CodeFlowSupported),Support code response_type,,,,,"OAuch has not the source code, thus I cannot understand what it does. Regarding the Conformance profile, the test checks the code length and entropy. Nothing about code length or entropy is said in the specification",TRUE,x,,,,,,,,,
,OP-Authentication request-no-bearer,Authentication response,,,HTTP 302 because of access_denied,,Wrong Input,Authentication request,Are authentication parameters in the URI allowed (IsAuthInUriAllowed),"This test firstly checks if there is a flow needing the authentication via a client secret. Once found, it removes the 'Authorization' field in the header of the request and adds the 'client_id' and 'client_secret' values in the request parameters. If the request is accepted, then the server accepts an authentication via parameters in the URI and is not compliant with the specifications.",OP,,,,External: OAuch,OIDC Core,active,,,Are authentication parameters in the URI allowed (IsAuthInUriAllowed),,,,,,Nothing about this in the specification. I think this is implicit due to the fact that the implicit flow should not be supported and that the request must have the JWT. Maybe can be said more clearly,TRUE,x,,,,,,,,,
,OP-Authentication request-fragment,Authorization endpoint URL,,,"Compliant if the URL has not a fragment, not compliant otherwise",,Correct Input,Authentication request,Does the authorization URL have a fragment (HasFragment),"This analyzes the URL of the authorization endpoint and checks if there is a fragment (#). If there a # is present, then there is a fragment and the server is not compliant with the specifications, otherwise the specifications are well-implemented.",OP,,,,External: OAuch,OIDC Core,passive,,,Does the authorization URL have a fragment (HasFragment),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication response-referrer,Referrer policy of the authorization response,,,"Compliant if all the referers are legit, not compliant otherwise",,Correct Input,Authentication response,Does the server suppress the referrer (ReferrerPolicyEnforced),"This test takes the Referrer policy present in the headers and/or in the metadata of the authorization response and checks that every referer is a proper one. If a referer is not valid or if there are not referers (and thus there is not a proper referrer policy), then the specifications are not fully implemented. ",OP,,,,External: OAuch,OIDC Core,passive,,,Does the server suppress the referrer (ReferrerPolicyEnforced),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication request-same-parameter-twice,Authorization response to a request with duplicated parameter,,,"Compliant if the response has not a token, not compliant if it has",,Wrong Input,Authentication request,Does the authorization server allow multiple instances of the same parameter (SameParameterTwiceDisallowed),"This test creates a request with a duplicated parameter and sends it. If the response contains the token, than the authorization server ignored the duplicated parameter and didn't implemented the specifications properly.",OP,,,,External: OAuch,OIDC Core,active,,,Does the authorization server allow multiple instances of the same parameter (SameParameterTwiceDisallowed),,,,,,"Nothing about this in the specification. Did not understand why they wait for a token if it is an authentication request
",TRUE,x,,,,,,,,,
,OP-Authentication request-unrecognized-parameter,Authorization response to a request with additional arbitrary parameter,,,"Compliant if the response has not a token, not compliant if it has",,Correct Input,Authentication request,Does the authorization server ignore unrecognized parameters (UnrecognizedParameterAllowed),"Create a request, add an arbitrary parameter and send it. If the server ignores the additional parameter and responds with the token, then it implements the specifications properly, otherwise it does not.",OP,,,,External: OAuch,OIDC Core,active,,,Does the authorization server ignore unrecognized parameters (UnrecognizedParameterAllowed),Ignores not understood query parameter in authentication request,,,,,Nothing about this in the specification. Did not understand why they wait for a token if it is an authentication request,TRUE,x,,,,,,,,,
,OP-Authentication request-missing-sub,Authorization response to a request with a JWT without the sub claim,,,Refuse client authorization: HTTP 400 error because of 'invalid_grant',,Wrong Input,Authentication request,Is JWT subject checked (HasSubjectClaim),A request with a JWT token without the sub claim is created and sent. The server should reject the request.,OP,,,,External: OAuch,OIDC Core,active,,,Is JWT subject checked (HasSubjectClaim),,,,,,The sub parameter in the authentication request is no more required,TRUE,x,,,,,,,,,
,OP-Authentication request-support-ui_locales,Authentication response,,,"Compliant if the Authentication page is showed with the proper language, not compliant otherwise",,Correct Input,Authentication request,Support ui_locales request parameter,"This test includes the ui_locales parameter in the request to the authorization endpoint, with the value set to that provided in the configuration (or 'se' if no value probably). Use of this parameter in the request must not cause an error at the OP. Please remove any cookies you may have received from the OpenID Provider before proceeding. You need to do this so you can check that the login page is displayed using one of the requested locales.",OP,,,,External: Reference OpenID Connect Conformance Profiles v3.0,OIDC Core,active,,,,Support ui_locales request parameter,,,,,It is an optional parameter right now. Cannot find the source code,TRUE,x,,,,,,,,,
,OP-Authentication request-wrong-ui_locales,"Authentication response to a request with a wrong ""ui_locales"" field",,,HTTP 302 error code because of invalid_request,,Wrong Input,Authentication request,"Auth request, no correct UI_locales",The authentication request is created and sent with a wrong 'ui_locales' field.,OP,,,,External: Reference spid-cie-oidc-django unit test,OIDC Core,active,,,,,"Auth request, no correct UI_locales",,,,"In the spec it is optional, so we did not consider it as a requirement for an OP to be compliant",TRUE,x,,,,,,,,,
,OP-Authentication response-header-pragma,Authorization response,,,"Compliant if the response has the pragma header, not compliant otherwise",,Correct Input,Authentication response,Is pragma header present (HasPragmaHeader),This test determines whether Pragma header is present in authorization endpoint responses,OP,,,,External: OAuch,OIDC Core,passive,,,Is pragma header present (HasPragmaHeader),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication response-csp,Authorization page,,,"Compliant if it has a Content Security Policy, not compliant otherwise",,Correct Input,Authentication response,Authorization page has Content Security Policy (HasContentSecurityPolicy),This test determines whether the authorization endpoint uses a content security policy to avoid framing of the authorization page.,OP,,,,External: OAuch,OIDC Core,passive,,,Authorization page has Content Security Policy (HasContentSecurityPolicy),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication response-header-x-frame,Authorization page,,,"Compliant if it has a X-Frame-Options header, not compliant otherwise",,Correct Input,Authentication response,Authorization page has X-Frame-Options header (HasFrameOptions),This test determines whether the authorization endpoint uses the X-Frame-Options header to avoid framing of the authorization page.,OP,,,,External: OAuch,OIDC Core,passive,,,Authorization page has X-Frame-Options header (HasFrameOptions),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication response-header-cache_control,Authorization response,,,"Compliant if it has a Cache-Control header, not compliant otherwise",,Correct Input,Authentication response,Is cache control header present (HasCacheControlHeader),This test determines whether Cache-Control header is present in authorization endpoint responses,OP,,,,External: OAuch,OIDC Core,passive,,,Is cache control header present (HasCacheControlHeader),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication request-pkce-downgrade,Authorization response to a request without the code_challenge and the code_challenge_method parameters,,,"Compliant if the response does not have a token inside, not compliant otherwise",,Correct Input,Authentication request,Is PKCE downgrade detected (authorization request) (IsPkceDowngradeDetected),"Attackers can downgrade PKCE protection without the server noticing. The server should disallow authorization code exchanges where a code_verifier is presented, if there was no code_challenge present in the authorization request.",OP,,,,External: OAuch,OIDC Core,active,,,Is PKCE downgrade detected (authorization request) (IsPkceDowngradeDetected),,,,,,"This type of attack is accomplished via a MITM, where the attacker acts like the OP and tries to downgrade to the plain PKCE, thus making the RP send the code_verifier. In the specification there is not written that plain PKCE is not supported, maybe it could be made more clear also specifying that the RP must not try to use plain PKCE an refuses requests where is asked to downgrade. Did not understand why they wait for a token if it is an authentication request
",TRUE,x,,,,,,,,,
,OP-Authentication request-tls,Authorization uri,,,"Compliant if it supports a modern version of TLS, not compliant otherwise",,Correct Input,Authentication request,Does the authorization server support a modern version of TLS (IsModernTlsSupported),This test determines whether the authorization server supports modern versions of the TLS protocol (v1.2 and higher).,OP,,,,External: OAuch,OIDC Core,passive,,,Does the authorization server support a modern version of TLS (IsModernTlsSupported),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication request-post-authentication,Authentication response to a request made with HTTP POST,,,"Compliant if the response does not have a token inside, not compliant otherwise",,Correct Input,Authentication request,Does the server support POST authentication requests (SupportsPostAuthorizationRequests),This test checks whether the authorization server supports sending authentication parameters via a POST request.,OP,,,,External: OAuch,OIDC Core,active,,,Does the server support POST authentication requests (SupportsPostAuthorizationRequests),,,,,,"Did not inserted because it seems that the serialization method used is query string, whereas the one that the specification requires is form serialization. Did not understand why they wait for a token if it is an authentication request",TRUE,x,,,,,,,,,
,OP-Authentication request-query-component-in-redirect,Authentication response,,,"Compliant if the response is successful, not compliant otherwise",,Correct Input,Authentication request,Preserves query parameter in redirect_uri,This test uses a redirect uri with a query component. Authorization should complete successfully.,OP,,,,External: Reference OpenID Connect Conformance Profiles v3.0,OIDC Core,active,,,,Preserves query parameter in redirect_uri,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Authentication response-iss,Authentication response to a request with a wrong iss parameter,,,HTTP 302 error code because of invalid_request,,Correct Input,Authentication response,Authentication Response: iss parameter compliance,iss parameter must be https://login.interno.gov.it/,OP,,,,External: MIG,OIDC Core,passive,,,,,,P2_e,,,The value of iss must no more be the one described the one described,TRUE,x,,,,,,,,,
,OP-Authentication response-code-timeout,Authentication response to a delayed request,,,"Compliant if the response does not have the token, not compliant otherwise",,Correct Input,Authentication response,Do authorization codes have a short timeout (AuthorizationCodeTimeout),This test checks if authorization codes time out after at most 10 minutes.,OP,,,,External: OAuch,OIDC Core,active,,,Do authorization codes have a short timeout (AuthorizationCodeTimeout),,,,,,"Nothing is said in the specification about the timeout time of the codes. Did not understand why they wait for a token if it is an authentication request
",TRUE,x,,,,,,,,,
,OP-Token request-short-code_verifier,Token response to a request with a short code verifier,,,"Compliant if the response does not have the token, not compliant otherwise",,Wrong Input,Token request,Are insecure code verifiers rejected (ShortVerifier),"try to edit code_verifier and put a value shorter than 32, note it still has to be valid",OP,,,,External: OAuch,OIDC Core,active,,,Are insecure code verifiers rejected (ShortVerifier),,,,,,Nothing is said about the length of the code verifier,TRUE,x,,,,,,,,,
,OP-Token request-asymmetric-authentication,Site settings,,,"Compliant if the server supports client authentication as private_key_jwt or certificates, not compliant otherwise",,Correct Input,Token request,Does the server support asymmetric client authentication (IsAsymmetricClientAuthenticationUsed),"This test determines whether the server supports asymmetric client authentication, such as mTLS or 'private_key_jwt'.",OP,,,,External: OAuch,OIDC Core,active,,,Does the server support asymmetric client authentication (IsAsymmetricClientAuthenticationUsed),,,,,,"Not clear how it works, in CIE the type of authentication is private_key_jwt, but in this test is not clear how this is checked",TRUE,x,,,,,,,,,
,OP-Token request-basic-authentication,Token response to a request without authentication,,,"Compliant if the token received is not valid, not compliant otherwise",,Correct Input,Token request,Is basic authentication supported (IsBasicAuthenticationSupported),This test verifies whether the token endpoint supports the basic authentication scheme (or a more secure authentication scheme) for clients that were issues a password.,OP,,,,External: OAuch,OIDC Core,active,,,Is basic authentication supported (IsBasicAuthenticationSupported),,,,,,"Did not proprerly understand what it does. For what I could, it tests if client secrets are used and this is not for our interest",TRUE,x,,,,,,,,,
,OP-Token request-require-client-authentication,Token response to a request without client id and client secret,,,"Compliant if the response does not contain a token, not compliant otherwise",,Wrong Input,Token request,Is client authentication required (IsClientAuthenticationRequired),Try to not authenticate as the client to the token endpoint,OP,,,,External: OAuch,OIDC Core,active,,,Is client authentication required (IsClientAuthenticationRequired),,,,,,"Is tried to remove the client id and secret, in CIE authentication is performed via JWT",TRUE,x,,,,,,,,,
,OP-Token request-get-requests,Token response to a request made with HTTP GET,,,"Compliant if the response does not contain a token, not compliant otherwise",,Correct Input,Token request,Does the token server support GET requests (IsGetSupported),This test checks if the token server supports GET requests.,OP,,,,External: OAuch,OIDC Core,active,,,Does the token server support GET requests (IsGetSupported),,,,,,In the specification is not specified which type of request the token endpoint accepts (even though examples show a POST request). A similar test is created for the authorization endpoint,TRUE,x,,,,,,,,,
,OP-Token request-require-https,Token response to a request made to the URI with http scheme,,,"Compliant if the response does not contain a token, not compliant otherwise",,Wrong Input,Token request,Is HTTPS required at the token endpoint (IsHttpsRequired),This test checks whether the token endpoint enforces HTTPS connections,OP,,,,External: OAuch,OIDC Core,active,,,Is HTTPS required at the token endpoint (IsHttpsRequired),,,,,,I think it is trivial but in the specification I did not find that HTTPS is required. For this reason I did not create a test,TRUE,x,,,,,,,,,
,OP-Token request-tls,Site settings,,,"Compliant if the token server supports modern versions of TLS, not compliant otherwise",,Correct Input,Token request,Does the token server support a modern version of TLS (IsModernTlsSupported),This test determines whether the token server supports modern versions of the TLS protocol (v1.2 and higher).,OP,,,,External: OAuch,OIDC Core,active,,,Does the token server support a modern version of TLS (IsModernTlsSupported),,,,,,I think it is trivial but in the specification I did not find that the most updated TLS (and thus HTTPS) is required. For this reason I did not create a test. Moreover I did not properly understand how the test works,TRUE,x,,,,,,,,,
,OP-Token request-password-disabled,Token request,,,"Compliant if the server does not support the password flow (grant_type set to password), not compliant otherwise",,Wrong Input,Token request,Is the password flow disabled (IsPasswordFlowDisabled),Check that the password flow is disabled ,OP,,,,External: OAuch,OIDC Core,active,,,Is the password flow disabled (IsPasswordFlowDisabled),,,,,,In the specification the authorization code flow is used but nothing is said about this type of flow. It is true that if an entity uses the password flow it is not compliant but it would fail all the other tests anyway. I think this is trivial. Moreover I did not properly understand how the test works,TRUE,x,,,,,,,,,
,OP-Token request-refresh-authentication,Token response to a request with a refresh token and without client id and client secret (as authentication),,,"Compliant if the response does not have a token, not compliant otherwise",,Wrong Input,Token request,Is refresh authentication required (IsRefreshAuthenticationRequired),Check to not authenticate when asking a token with a refresh token,OP,,,,External: OAuch,OIDC Core,active,,,Is refresh authentication required (IsRefreshAuthenticationRequired),,,,,,"It tries to remove client id and secret and make a request, we do not care about this test because the required authentication method is the signed JWT",TRUE,x,,,,,,,,,
,OP-Token request-refresh_token-bound,Token response to a request with a refresh token and with a wrong client id as authentication method,,,"Compliant if the response does not have a token, not compliant otherwise",,Wrong Input,Token request,Is the refresh token bound to a client (IsRefreshBoundToClient),Try to use the refresh token with another client,OP,,,,External: OAuch,OIDC Core,active,,,Is the refresh token bound to a client (IsRefreshBoundToClient),,,,,,"This test seems to try to use the refresh token with another client, and see if an access token is sent back. In the specification I did not really find something that says to not do this. Must the OP check the client when exchanging a refresh token?",TRUE,x,,,,,,,,,
,OP-Token request-use-code-twice,Token response to a request containing a code already exchanged,,,"Compliant if the response does not have a token, not compliant otherwise",,Wrong Input,Token request,Can codes be exchanged multiple times (MultipleCodeExchanges),Try to use authorization code twice,OP,,,,External: OAuch,OIDC Core,active,,,Can codes be exchanged multiple times (MultipleCodeExchanges),Reject second use of authorization code,,,,,Nothing about invalidating the authorization code is said in the specification,TRUE,x,,,,,,,,,
,OP-Token request-check-redirect_uri,Token response to a request with a wrong redirect uri,,,"Compliant if the response does not have a token, not compliant otherwise",,Wrong Input,Token request,Is the redirect URI checked when exchanging a code (RedirectUriChecked),"Try to use a not registered redirect uri, try to set it differently from the authorization request",OP,,,,External: OAuch,OIDC Core,active,,,Is the redirect URI checked when exchanging a code (RedirectUriChecked),,,,,,"In CIE/SPID the redirect uri must be checked when asking for a code, not when exchanging it",TRUE,x,,,,,,,,,
,OP-Token request-parameter-twice,Token response to a request with a parameter duplicated,,,"Compliant if the response does not have a token, not compliant otherwise",,Wrong Input,Token request,Does the token endpoint allow multiple instances of the same parameter (SameParameterTwiceDisallowed),Try to put a parameter twice in the token request,OP,,,,External: OAuch,OIDC Core,active,,,Does the token endpoint allow multiple instances of the same parameter (SameParameterTwiceDisallowed),,,,,,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Token request-tokens-invalidated-after-multiple-exchange,Introspection response to a request containing an access token whose code was exchanged twise,,,"Compliant if the response says that the token is not valid, not compliant otherwise",,Wrong Input,Token request,Are tokens invalidated after exchanging the same code multiple times (TokenValidAfterMultiExchange),"Get a token, assure it works, try to exchange same code again, see if the token still works",OP,,,,External: OAuch,OIDC Core,active,,,Are tokens invalidated after exchanging the same code multiple times (TokenValidAfterMultiExchange),Second use of Authorization code revokes previously issued Access Token,,,,,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Token request-ignore-unrecognized-parameter,Token response to a request with unkown parameters,,,"Compliant if the response does not have a token, not compliant otherwise",,Wrong Input,Token request,Does the token endpoint ignore unrecognized parameters (UnrecognizedParameterAllowed),Try to add invalid parameters,OP,,,,External: OAuch,OIDC Core,active,,,Does the token endpoint ignore unrecognized parameters (UnrecognizedParameterAllowed),,,,,,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Token request-pkce-downgrade,Authorization response to a request without the code_challenge and the code_challenge_method parameters,,,"Compliant if the response does not have a token inside, not compliant otherwise",,Wrong Input,Token request,Is PKCE downgrade detected (token request) (IsPkcePlainDowngradeDetected),"Attackers can downgrade PKCE protection without the server noticing. The authorization request used S256 PKCE, but an attacker can downgrade this to plain PKCE by modifying the token request.",OP,,,,External: OAuch,OIDC Core,active,,,Is PKCE downgrade detected (token request) (IsPkcePlainDowngradeDetected),,,,,,"This type of attack is accomplished via a MITM, where the attacker acts like the OP and tries to downgrade to the plain PKCE, thus making the RP send the code_verifier. In the specification there is not written that plain PKCE is not supported, maybe it could be made more clear also specifying that the RP must not try to use plain PKCE. Regarding the test, the code is not available",TRUE,x,,,,,,,,,
,OP-Token request-max_age,Two ID Tokens,,,"Compliant if the second ID token has an auth_time parameter and the user is asked to log in again, not compliant otherwise",,Wrong Input,Token request,Support max_age request parameter,"This test calls the authorization endpoint test twice. The second time it waits 1 second and includes max_age=1, so that the authorization server is required to ask the user to login a second time and must return an auth_time claim in the second id_token. A screenshot of the second authorization should be uploaded.",OP,,,,External: OpenID Connect Conformance Profile,OIDC Core,active,,,,"Support max_age request parameter, ID token has auth_time claim when max_age in request",,,,,Parameter not used in CIE,TRUE,x,,,,,,,,,
,OP-Token request-max_age-not-reached,Two ID Tokens,,,"Compliant if the second ID token has an auth_time parameter and the user is not asked to log in again, not compliant otherwise",,Wrong Input,Token request,Support max_age request parameter when max age not reached,"This test calls the authorization endpoint test twice. The first time it includes max_age=15000 (so that the OP is required to return auth_time in the id_token). The second time it includes max_age=10000, and the authorization server must not request that the user logs in. The test verifies that auth_time and sub are consistent between the id_tokens from the first and second authorizations.",OP,,,,External: OpenID Connect Conformance Profile,OIDC Core,active,,,,Support max_age request parameter when max age not reached,,,,,Parameter not used in CIE,TRUE,x,,,,,,,,,
,OP-Token request-reject-code-second-use,Token response to a request with an already used code,,,"Compliant if the server returns an error and invalidate the previously-issued access token, not compliant otherwise",/ todo 0809,Wrong Input,Token request,Reject second use of authorization code after 30 seconds,"This test tries using an authorization code for a second time, 30 seconds after the first use. The server must return an invalid_grant error as the authorization code has already been used. The originally issued access token should be revoked (as per RFC6749-4.1.2) - a warning is issued if the access token still works.",OP,,,,External: OpenID Connect Conformance Profile,OIDC Core,active,,,,Reject second use of authorization code after 30 seconds,,,,,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Token response-correct-content_type,Token response,,,"Compliant if the content-type header is application/json, not compliant otherwise",,Correct Input,Token response,response MUST have Content-Type 'application/json',This test takes the token response header and checks the Content-type,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.2.0,In the example of the token response the content type is the same but it is not said to be mandatory or necessary,TRUE,x,,,,,,,,,
,OP-Token response-header-correct-cache_control,Token response,,,"Compliant if the cache-control header is no-store, not compliant otherwise",,Correct Input,Token response,response MUST have HTTP response header Cache-Control with value 'no-store',This test takes the token response header and checks the Cache-control,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.2.2,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Token response-header-correct-pragma,Token response,,,"Compliant if the pragma header is no-cache, not compliant otherwise",,Correct Input,Token response,response MUST have HTTP response header Pragma with value 'no-cache',This test takes the token response header and checks the pragma,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.2.3,Nothing about this is said in the specification,TRUE,x,,,,,,,,,
,OP-Token response-correct-expires_in,Token response,,,"Compliant if the expires_in parameter is less or equal to 900, not compliant otherwise",,Correct Input,Token response,the value of expires_in MUST be <= 900,This test takes the token response and checks the presence of the expires_in parameter in the data,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.2.13,parameter not correct (exp). expiration time in specification is not clear,TRUE,x,,,,,,,,,
,OP-Token response-id-token-payload-correct-acr,ID token in the token response,,,"Compliant if the acr parameter is present and contains only values among ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3'], not compliant otherwise",,Correct Input,Token response,"ID Token Payload: the value of acr MUST be one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']","This test takes the ID token in the token response, decrypt it and checks the presence of the acr values",OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.3.10,The values are no more defined like that,TRUE,x,,,,,,,,,
,OP-Token response-id_token-payload-exp-authorization_code,ID token in the token response,,,"Compliant if the ID token payload contains the grant_type claim set to 'authorization_code', the iat claim and the exp claim is set to iat + 5 min. Not compliant otherwise",,Correct Input,Token response,"ID Token Payload: if grant_type was 'authorization_code', the value of exp MUST be = iat + 5min","This test takes the ID token in the token response, decrypt it and checks the presence of the grant_type, iat and exp claims",OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.3.21,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Token response-id_token-payload-exp-refresh_token,ID token in the token response,,,"Compliant if the ID token payload contains the grant_type claim set to 'refresh_token', the iat claim and the exp claim is set to iat + 30 days. Not compliant otherwise",,Correct Input,Token response,"ID Token Payload: if grant_type was 'refresh_token', the value of exp MUST be = iat + 30 days - (iat of original authentication)","This test takes the ID token in the token response, decrypt it and checks the presence of the grant_type, iat and exp claims",OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.3.22,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Token response-access_token-payload-exp-time,Access token in the token response,,,Compliant if the Access token payload contains the iat claim and the exp claim is set to iat + 15 min. Not compliant otherwise,,Correct Input,Token response,Access Token Payload: the value of exp MUST be = iat + 15min,"This test takes the Access token in the token response, decrypt it and checks the presence of the iat and exp claims",OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,3.4.13,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Token response-key-references,ID Token in the token response,,,"Not compliant if the ID token contains one parameter among { 'x5u', 'x5c', 'jku', 'jwk' }, compliant otherwise",,Correct Input,Token response,Are references to keys communicated using discovery and registration parameters (KeyReferences),"This test determines whether the identity token uses keys that are communicated in advance using Discovery and Registration parameters, instead of the JWS x5u, x5c, jku and jwk header claims.",OP,,,,External: OAuch,OIDC Core,passive,,,Are references to keys communicated using discovery and registration parameters (KeyReferences),,,,,,"This tests check discovery for the keys, in the CIE case the key exchange is a matter of federation. This is not a useful test",TRUE,x,,,,,,,,,
x,TA-Entity Statement response OP-metadata_policy-id_token_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['RS256', 'RS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.id_token_signing_alg_values_supported.one_of | [""RS256"", ""RS512""]",The id_token_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,message type - validate | {head/body/url} | jwt_name | {header/payload} | param_path | param_value1 | param_value2 | ...,,,,,,,TRUE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
,OP-Metadata-claims-spid,metadata,,,"Compliant if the claim claim in the metadata contains all the spid attributes, not compliant otherwise",,Correct Input,Metadata,claims supported should be all the spid attributes,"If present, the value of claims_supported MUST be all the SPID attributes (see table of SPID attributes for OIDC)",OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.4.8,Claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-valid-url,Metadata URL,,,"Compliant if the metadata are on a valid URL, not compliant otherwise",,Correct Input,Metadata,1.0.0,Metadata file MUST be on a valid URL of the OP,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.0.0,It is trivial but there is not written to use HTTPS,TRUE,x,,,,,,,,,
,OP-Metadata-correct-url,Metadata URL,,,"Compliant if the metadata are on a URL composed like <issuer>/.well-known/openid-configuration, not compliant otherwise",,Correct Input,Metadata,1.1.0,Document URL MUST be <issuer>/.well-known/openid-configuration,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.1.0,Metadata in the CIE federation are published in the .well-known/openid-federation,TRUE,x,,,,,,,,,
,OP-Metadata-correct-content_type,Response to a metadata request,,,"Compliant if the header 'Content-Type' is set to application/json, not compliant otherwise",,Correct Input,Metadata,1.1.3,The document MUST be returned as Content-Type application/json,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.1.3,"It is not specified but in the examples the content type is ""application/entity-statement+jwt""",TRUE,x,,,,,,,,,
,OP-Metadata-not-contain-request_object_encryption_alg_values_supported,OP's Metadata,,,"Compliant if the request_object_encryption_alg_values_supported parameter is not present, not compliant otherwise",,Correct Input,Metadata,1.3.23,The metadata must not contain the claim request_object_encryption_alg_values_supported,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.3.23,claim no more used. Test is changed recently. Nothing is said about the prohibition of this parameter,TRUE,x,,,,,,,,,
,OP-Metadata-not-contain-request_object_encryption_enc_values_supported,OP's Metadata,,,"Compliant if the request_object_encryption_enc_values_supported parameter is not present, not compliant otherwise",,Correct Input,Metadata,1.3.24,The metadata MUST NOT contain the claim request_object_encryption_enc_values_supported,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.3.24,claim no more used. Test is changed recently. Nothing is said about the prohibition of this parameter,TRUE,x,,,,,,,,,
,OP-Metadata-contain-request_parameter_supported,OP's Metadata,,,"Compliant if the request_parameter_supported parameter is present, not compliant otherwise",,Correct Input,Metadata,1.3.25,The metadata MUST contain the claim request_parameter_supported,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.3.25,claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-request_parameter_supported-true,OP's Metadata,,,"Compliant if the request_parameter_supported parameter is present and set to true, not compliant otherwise",,Correct Input,Metadata,1.3.26,The value of request_parameter_supported MUST be true,OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.3.26,claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-claims_parameter_supported-true,Metadata,,,"Compliant if the claims_parameter_supported claim is present and set to true, not compliant if it present but not set to true",,Correct Input,Metadata,1.4.10,"If present, the value of claims_parameter_supported MUST be true",OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.4.10,claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-token_endpoint_auth_methods_supported-private_key_jwt,Metadata,,,"Compliant if the token_endpoint_auth_methods_supported claim is present and contains the value private_key_jwt, not compliant if it present but does not contain the value private_key_jwt",,Correct Input,Metadata,1.4.5,"If present, the token_endpoint_auth_methods_supported MUST be ['private_key_jwt']",OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.4.5,claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-correct-request_object_encryption_alg_values_supported,Metadata,,,"Compliant if the request_object_encryption_alg_values_supported claim is present and set to ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it present but is set differently",,Correct Input,Metadata,1.5.7,"The request_object_encryption_alg_values_supported MUST be ['RSA-OAEP', 'RSA-OAEP-256']",OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.5.7,Claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-correct-request_object_encryption_enc_values_supported,Metadata,,,"Compliant if the request_object_encryption_enc_values_supported claim is present and set to ['A128CBC-HS256', 'A256CBC-HS512'], not compliant if it present but is set differently",,Correct Input,Metadata,1.5.8,"The request_object_encryption_enc_values_supported MUST be ['A128CBC-HS256', 'A256CBC-HS512']",OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.5.8,Claim no more used,TRUE,x,,,,,,,,,
,OP-Metadata-correct-token_endpoint_auth_signing_alg_values_supported,Metadata,,,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim is present and set to ['RS256', 'RS512'], not compliant if it present but is set differently",,Correct Input,Metadata,1.5.9,"If present, the token_endpoint_auth_signing_alg_values_supported  MUST be  ['RS256', 'RS512']",OP,,,,External: spid-oidc-check-op,OIDC Core,Passive,,,,,,,,1.5.9,Claim no more used,TRUE,x,,,,,,,,,
x,TA-Entity Statement response OP-metadata_policy-incorrect-id_token_encryption_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_encryption_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encryption_alg_values_supported.one_of | [""RSA_1_5""]",The id_token_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-incorrect-id_token_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_token_signing_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the id_token_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_signing_alg_values_supported.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The id_token_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-incorrect-request_authentication_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_authentication_signing_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the request_authentication_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.request_authentication_signing_alg_values_supported.subset_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The request_authentication_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-incorrect-userinfo_encryption_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_encryption_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the userinfo_encryption_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encryption_alg_values_supported.one_of | [""RSA_1_5""]",The userinfo_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-incorrect-userinfo_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_signing_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512']",JWT list parameter does not contain,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the userinfo_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_signing_alg_values_supported.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The userinfo_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
,OP-Authentication request-require-https-authentication_request,HTTP response from the authorization endpoint,,,"Compliant if the server returns an HTTP error, not compliant otherwise",,Wrong Input,Authentication request,OP authentication requests use HTTPS,"This test is performed trying to make a request to the Authorization endpoint with http and not with https. If the endpoint refuses the connection, then the use of HTTPS is required and thus, the server respects the specification. If otherwise the request is accepted, it means that the server automatically upgrades to HTTPS and then it is not compliant with the specifications.",OP,,,,External: OAuch,OIDC Core,passive,,,Is HTTPS required at the authorization endpoint (IsHttpsRequired),All OP endpoints use https,,,,,It is trivial but in the specification is not specified for the authorization endpoint to have an HTTPS URL,TRUE,x,,,,,,,,,
,OP-Authentication request-require-https-revocation_request,HTTP response from the revocation endpoint,,,"Compliant if the server returns an HTTP error, not compliant otherwise",,Wrong Input,Authentication request,OP revocation requests use HTTPS,"This test is performed trying to make a request to the Revocation endpoint with http and not https. If the endpoint refuses the connection, then the use of HTTPS is required and thus, the server respects the specification. If otherwise the request is accepted, it means that the server automatically upgrades to HTTPS and then it is not compliant with the specifications.",OP,,,,External: OAuch,OIDC Core,passive,,,Is the revocation endpoint secure (IsRevocationEndpointSecure),Uses https for all endpoints unless only using code flow,,,,,It is trivial but in the specification is not specified for the revocation endpoint to have an HTTPS URL,TRUE,x,,,,,,,,,
,OP-Revocation request-require-client-authentication,Revocation response to revocation request without any authentication,,,"Compliant if the server rejects the request, not compliant otherwise",,Wrong Input,Revocation request,Does revocation require client authentication (IsClientAuthRequired),This test checks if the revocation endpoint requires client authentication.,OP,,,,External: OAuch,OIDC Core,active,,,Does revocation require client authentication (IsClientAuthRequired),,,,,,Cannot understand what they mean for authentication method,TRUE,x,,,,,,,,,
,OP-Revocation request-tls,Revocation Endpoint URI,,,"Compliant if newer TLS protocols are supported, not compliant otherwise",,Correct Input,Revocation request,Does the revocation endpoint support a modern version of TLS (IsModernTlsSupported),This test determines whether the revocation endpoint supports modern versions of the TLS protocol (v1.2 and higher).,OP,,,,External: OAuch,OIDC Core,passive,,,Does the revocation endpoint support a modern version of TLS (IsModernTlsSupported),,,,,,Not required in the specification. Did not understand how the test works,TRUE,x,,,,,,,,,
,OP-Userinfo request-form-encoded-body),Userinfo response to a POST request with the token in the body,,,"Compliant if the response is an HTTP 200 OK and thus the server accepts the token in the body, not compliant otherwise",,Correct Input,Userinfo request,Userinfo Endpoint access with form-encoded body method,"This tests makes an authenticated POST request to the UserInfo endpoint with the access token in the body and validates the response. Support for passing an access token in the request body is not required by the standards - if is acceptable for servers not to implement this form, and the test will complete with a 'warning' if the server returns a http error response.",OP,,,,External: OpenID Connect Conformance Profiles v3.0,OIDC Core,passive,,,,Userinfo Endpoint access with form-encoded body method,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Userinfo request-correct-request,Userinfo response,,,None,,Correct Input,Userinfo request,request correct,This test simply does a correct request to the userinfo endpoint without analyzing the response,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.0.0,This test simply does a correct request without analyzing the response. It is trivial and covered from other tests,TRUE,x,,,,,,,,,
,OP-Userinfo response-correct-signature-alg,Userinfo response,,,"Compliant if the userinfo response is signed with RS256, not compliant otherwise",,Correct Input,Userinfo response,Can provide signed userinfo response with RS256,This tests register a client with userinfo_signed_response_alg=RS256 and validates the signed response from the userinfo endpoint,OP,,,,External: OpenID Connect Conformance Profiles v3.0,OIDC Core,passive,,,,Can provide signed userinfo response with RS256,,,,4.4.0,alg parameter is no more used,TRUE,x,,,,,,,,,
,OP-Userinfo response-content-type,Userinfo response header,,,"Compliant if the Content-Type header is 'application/jwt', not compliant otherwise",,Correct Input,Userinfo response,4.2.0,response MUST have Content-Type 'application/jwt',OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.2.0,"Not specified in the specification (for CIE, not for SPID) but in the example the content type is ""application/jose""",TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-payload-valid-iat,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the iat claim in the payload and it is a valid unix time, not compliant otherwise",,Correct Input,Userinfo response,4.4.10,Userinfo Signed Token Payload: the value of iat MUST be a valid unix time,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.10,Parameter present in the example but not in the text,TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-payload-correct-iat,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the iat claim in the payload, it is a valid unix time and is less than the current time + 3 min, not compliant otherwise",,Correct Input,Userinfo response,4.4.11,Userinfo Signed Token Payload: the value of iat MUST be < current date + 3min,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.11,Parameter present in the example but not in the text,TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-payload-exp,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the exp claim in the payload, not compliant otherwise",,Correct Input,Userinfo response,4.4.12,Userinfo Signed Token Payload: claim exp MUST be present,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.12,Parameter present in the example but not in the text,TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-payload-valid-exp,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the exp claim in the payload and it is a valid unix time, not compliant otherwise",,Correct Input,Userinfo response,4.4.13,Userinfo Signed Token Payload: the value of exp MUST be a valid unix time,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.13,Parameter present in the example but not in the text,TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-header-kid,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the kid claim in the header, not compliant otherwise",,Correct Input,Userinfo response,4.4.2,Userinfo Signed Token Header: claim kid MUST be present,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.2,Claim present in the example but not in the text of the specification. We ignored it,TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-payload-correct-iss,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the iss claim in the payload and it is equal to the URL of the OP, not compliant otherwise",,Correct Input,Userinfo response,4.4.6,Userinfo Signed Token Payload: the value of iss MUST be equal to the URL of the OP,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.6,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-Userinfo response-JWT-payload-iat,Token returned in the Userinfo response,,,"Compliant if the decrypted token has the iat claim in the payload, not compliant otherwise",,Correct Input,Userinfo response,4.4.9,Userinfo Signed Token Payload: claim iat MUST be present,OP,,,,External: spid-oidc-check-op,OIDC Core,passive,,,,,,,,4.4.9,claim no more required,TRUE,x,,,,,,,,,
,OP-OP requests-support-old-tls,OAuth endpoints URI,,,"Compliant if none of them has in the supported protocols older versions of TLS, not compliant otherwise",,Wrong Input,OP requests,Are deprecated TLS versions supported on the OAuth endpoints (IsDeprecatedTlsSupported),This test determines whether the OAuth endpoints supports older versions of the TLS protocol (v1.0 and 1.1) or any version of the SSL protocol.,OP,,,,External: OAuch,OIDC Core,active,,,Are deprecated TLS versions supported on the OAuth endpoints (IsDeprecatedTlsSupported),,,,,,Nothing about this in the specification,TRUE,x,,,,,,,,,
,OP-OP requests-trusted-certificate,OAuth authorization URI,,,"Compliant if the URI has a valid certificate, not compliant otherwise",,Correct Input,OP requests,Trusted authorization certificate (HasValidCertificate),This test determines whether the certificate that is being used by the authorization server is widely trusted.,OP,,,,External: OAuch,OIDC Core,passive,,,Trusted authorization certificate (HasValidCertificate),,,,,,"Nothing about certificates in the specification, I think it is a test that does not concern properly the CIE ecosystem",TRUE,x,,,,,,,,,
,OP-OP responses-attach-fragment,Authentication response,,,"Compliant if the URI has a fragment attached and nothing after it, not compliant otherwise",,Correct Input,OP responses,Does the server attach a fragment (FragmentFix),This test checks whether the server attaches an arbitrary fragment identifier to prevent browsers from reattaching fragments to redirection URLs.,OP,,,,External: OAuch,OIDC Core,passive,,,Does the server attach a fragment (FragmentFix),,,,,,Nothing about fragments in the specification,TRUE,x,,,,,,,,,
,OP-OP responses-header-x-frame,Authentication response,,,"Compliant if the response has the X-Frame-Options header, not compliant otherwise",,Correct Input,OP responses,P3_a,All responses from the OP should contain X-Frame-Options header,OP,,,,External: MIG,OIDC Core,passive,,,,,,P3_a,,,Nothing about x-frame-options in the specification,TRUE,x,,,,,,,,,
,OP-OP responses-correct-redirect,Authentication response,,,"Compliant if the is not a 307 redirect, not compliant otherwise",,Correct Input,OP responses,P3_b,All responses from the OP should not have HTTP 307 code,OP,,,,External: MIG,OIDC Core,passive,,,,,,P3_b,,,Nothing about 307 redirect in the specification. This should be regulated by the last BCP of OAuth. It could be made more clear by specifying to avoid this kind of redirect,TRUE,x,,,,,,,,,
x,TA-Entity Statement response OP-metadata_policy-jwks,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the jwks parameter is present, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the jwks parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_provider type is checked. It must contain the RP JWKS related to the OIDC Core operations",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | jwks,The jwks claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-metadata_policy-request_authentication_methods_supported,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_authentication_methods_supported parameter is present in the openid_provider type, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the request_authentication_methods_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_methods_supported parameter inside the openid_provider type is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.request_authentication_methods_supported,The request_authentication_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,message type - validate | {head/body/url} | jwt_name | {header/payload} | param_path,,,,,,,TRUE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-request_authentication_methods_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_authentication_methods_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'value'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.request_authentication_methods_supported.value,The request_authentication_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-request_authentication_methods_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_authentication_methods_supported parameter is present in the openid_provider type and the key 'one_of' is valued with ['request_object'], not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued with ['request_object']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.request_authentication_methods_supported | {""type"": ""object"", ""properties"": {""value"": {""const"": ""request_object""}}, ""required"": [""value""]}",The request_authentication_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-request_authentication_signing_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_authentication_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant if it is missing or empty",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.request_authentication_signing_alg_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The request_authentication_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-request_authentication_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_authentication_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued as ['RS256', 'RS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.request_authentication_signing_alg_values_supported.subset_of | [""RS256"", ""RS512""]",The request_authentication_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
,TA-Entity Statement response OP-metadata_policy-request_object_signing_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,Compliant if the request_object_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'superset_of' or 'subset_of',JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_object_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_object_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and 'superset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.request_parameter_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The request_object_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
,TA-Entity Statement response OP-metadata_policy-request_object_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,Compliant if the request_object_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'superset_of' or 'subset_of',JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_object_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_object_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued as ['RS256', 'RS512'] ",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.request_parameter_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]} [""RS256"", ""RS512""]",The request_object_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,,,,yes,s1,E,Problema implementazione,F,TBD,Clarifying docs,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
o,TA-Entity Statement response OP-metadata_policy-request_parameter_supported,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_parameter_supported parameter is present in the openid_provider type, not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the request_parameter_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_parameter_supported parameter inside the openid_provider type is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.request_parameter_supported,The request_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-request_parameter_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_parameter_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_parameter_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.request_parameter_supported.value,The request_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-request_parameter_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the request_parameter_supported parameter is present in the openid_provider type and contains the value 'one_of': ['true'], not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_parameter_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['true']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.request_parameter_supported | {""type"": ""object"", ""properties"": {""value"": {""const"": true}}, ""required"": [""value""]}",The request_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-response_modes_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the response_modes_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_modes_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.response_modes_supported | {""type"": ""object"", ""properties"": {""subset_of"":{}, ""superset_of"":{}}, ""required"": [""subset_of"", ""superset_of""]}",The response_modes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-response_modes_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the response_modes_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['form_post', 'query'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_modes_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it is valued with['form_post', 'query']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.response_modes_supported.subset_of | [""form_post"", ""query""]",The response_modes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-response_types_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the response_types_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.response_types_supported.subset_of,The response_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-response_types_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the response_types_supported parameter is present in the openid_provider type and contains the value 'one_of': ['code'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['code']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.response_types_supported.subset_of | [""code""]",The response_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-revocation_endpoint_auth_methods_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the revocation_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct revocation_endpoint_auth_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.revocation_endpoint_auth_methods_supported.subset_of,The revocation_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-revocation_endpoint_auth_methods_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the revocation_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the value 'one_of': ['private_key_jwt'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct revocation_endpoint_auth_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.revocation_endpoint_auth_methods_supported.subset_of | [""private_key_jwt""]",The revocation_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-scopes_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the scopes_supported parameter is present in the openid_provider typeand contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct scopes_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.scopes_supported | {""type"": ""object"", ""properties"": {""subset_of"":{}, ""superset_of"":{}}, ""required"": [""subset_of"", ""superset_of""]}",The scopes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-scopes_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the scopes_supported parameter is present in the openid_provider typeand contains the value 'subset_of': ['openid', 'offline_access', 'profile', 'email'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct scopes_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['openid', 'offline_access', 'profile', 'email']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.scopes_supported.subset_of | [""openid"", ""offline_access"", ""profile"", ""email""]",The scopes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-subject_types_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the subject_types_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct subject_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.subject_types_supported.subset_of,The subject_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-subject_types_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the subject_types_supported parameter is present in the openid_provider type and contains the value 'one_of': ['pairwise'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct subject_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['pairwise']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.subject_types_supported.subset_of | [""pairwise""]",The subject_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-token_endpoint_auth_methods_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the token_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the token_endpoint_auth_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.openid_provider.token_endpoint_auth_methods_supported.subset_of,The token_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro. openid_provider è vuoto
x,TA-Entity Statement response OP-metadata_policy-token_endpoint_auth_methods_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the token_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the value 'one_of': ['private_key_jwt'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain the token_endpoint_auth_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.openid_provider.token_endpoint_auth_methods_supported.subset_of | [""private_key_jwt""]",The token_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-token_endpoint_auth_signing_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the token_endpoint_auth_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct token_endpoint_auth_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.token_endpoint_auth_signing_alg_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The token_endpoint_auth_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-token_endpoint_auth_signing_alg_values_supported-not-supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the token_endpoint_auth_signing_alg_values_supported parameter is present in the openid_provider type and not contains the values ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the token_endpoint_auth_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.token_endpoint_auth_signing_alg_values_supported.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The token_endpoint_auth_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-token_endpoint_auth_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the token_endpoint_auth_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct token_endpoint_auth_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.token_endpoint_auth_signing_alg_values_supported.one_of | [""RS256"", ""RS512""]",The token_endpoint_auth_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-userinfo_encryption_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_encryption_alg_values_supported parameter is presentin the openid_provider type and contains the key 'subset_of', not compliant if it is missing or empty",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.userinfo_encryption_alg_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The userinfo_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-userinfo_encryption_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_encryption_alg_values_supported parameter is presentin the openid_provider type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encryption_alg_values_supported.one_of | [""RSA-OAEP"", ""RSA-OAEP-256""]",The userinfo_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-userinfo_encryption_enc_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_encryption_enc_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_enc_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.userinfo_encryption_enc_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The userinfo_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-userinfo_encryption_enc_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_encryption_enc_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_enc_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encryption_enc_values_supported.one_of | [""A128CBC-HS256"", ""A256CBC-HS512""]",The userinfo_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-metadata_policy-userinfo_signing_alg_values_supported-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant if is missing or empty",JWT parameter type,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | .metadata_policy.intermediary.userinfo_signing_alg_values_supported | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The userinfo_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro intermediary
x,TA-Entity Statement response OP-metadata_policy-userinfo_signing_alg_values_supported-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the userinfo_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_signing_alg_values_supported.one_of | [""RS256"", ""RS512""]",The userinfo_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response OP-release,TA's fetch Entity Statement Endpoint response regarding the Entity we are considering,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the TA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",HTTP parameter type,Correct Input,Entity Statement response OP,Does the TA correctly release the Entity statements,"After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",TA,,Entity Statement response TA OP | body | ([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it.,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-signature,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the signature is verified, not compliant otherwise",JWT signature check,Correct Input,Entity Statement response OP,Does the TA correctly sign the Entity statements,"In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",TA,,Entity Statement response TA OP | body | [^\r\n]* | X_key_TA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Signature non corretta
x,TA-Entity Statement response OP-sub,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the sub parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the sub parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | sub,The sub parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-claims,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an TA must be taken, decrypted and the presence of the claims claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | claims,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro claim
o,TA-Entity Statement response OP-trust_mark-claims-type,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the claims claim is a list of JSON Objects, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""claims"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""claims""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro claims
x,TA-Entity Statement response OP-trust_mark-email,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the email claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | email,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro email
,TA-Entity Statement response OP-trust_mark-email-type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the email claim is of type string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the correct type of the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the email claim in it is checked.",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"":""object"",""properties"":{""email"":{""type"":""string"",""format"":""email""}},""required "":[""email""]}",The issued Trust Marks must have the email claim as string,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,No email
x,TA-Entity Statement response OP-trust_mark-exp,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the exp claim is present, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | exp,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro exp
x,TA-Entity Statement response OP-trust_mark-exp-type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the exp claim is UNIX Timestamp, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the exp type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the exp claim in it is checked.",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""exp"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""exp""]}",The issued Trust Marks must have the exp claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,No exp
x,TA-Entity Statement response OP-trust_mark-fiscal_number-or-vat_number,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,nested JWT parameter type,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""fiscal_number"": {}, ""vat_number"":{}},""anyOf"":[{""required"":[""fiscal_number""]},{""required"":[""vat_number""]}]}},""required"":[""id_code""]}",The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,[ORA] Manca id_code
x,TA-Entity Statement response OP-trust_mark-iat,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the iat claim is present, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iat,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response OP-trust_mark-iat-type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the iat type is in UNIX Timestamp in the trust mark payload, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the correct iat type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the iat claim in it is checked.",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""iat"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""iat""]}",The issued Trust Marks must have the iat claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
x,TA-Entity Statement response OP-trust_mark-id,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the id claim,"The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-id_code,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the id_code claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id_code,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro id_code
x,TA-Entity Statement response OP-trust_mark-ipa_code,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued by a TA for public organization contain ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | $.id_code.ipa_code,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,[ORA] Manca id_code
x,TA-Entity Statement response OP-trust_mark-ipa_code-type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued by a TA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""ipa_code"": { ""type"":""string""}},""required"":[""ipa_code""]}},""required"":[""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,[ORA] Manca id_code
,TA-Entity Statement response OP-trust_mark-ipa_code-value,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim for public organizations,nested JWT parameter type,Correct Input,Entity Statement response OP,Does the id_code claim of a Trust Mark issued for public organization contain the ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the ipa_code in the id_code is checked",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": { ""id_code"": { ""type"": ""object"", ""properties"": {""ipa_code"": {}},""required"": [""ipa_code""]}},""required"": [""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations.,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,,F,failed,[ORA] Manca id_code
,TA-Entity Statement response OP-trust_mark-iss,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the iss claim is present, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iss,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-iss-value,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the iss claim is an URL identifying the TA, not compliant otherwise",nested JWT Check-Save to JWT,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL",TA,Entity Configuration response TA | body | [^\r\n]* | payload | iss | valid_iss,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks | trust_mark | payload | iss,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Active,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-logo_uri,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the logo_uri claim is present in the trust_mark JWT in the trust_marks parameter, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | logo_uri,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro logo_uri
x,TA-Entity Statement response OP-trust_mark-logo_uri-value,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the logo_uri parameter in the trust mark in the trust marks parameter of the response is an URI, not compliant otherwise ",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""logo_uri"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""logo_uri""]}",The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro logo_uri
x,TA-Entity Statement response OP-trust_mark-organization_name,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the organization_name claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_name,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro organization_name
x,TA-Entity Statement response OP-trust_mark-organization_name-type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the organization_name claim is type string and has value ""public"" or ""private"", not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain the correct type of organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the organization_name claim in it is checked.",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type "":  ""object "", ""properties "": { ""organization_name "": { ""type "":  ""string "", ""enum "": [ ""private "",  ""public ""]}}, ""required "": [ ""organization_name ""]}",The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,No organization_name
x,TA-Entity Statement response OP-trust_mark-organization_type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the organization_type claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_type,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro organization_type
o,TA-Entity Statement response OP-trust_mark-organization_type-value,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the organization_type claim is 'public' or 'private', not compliant otherwise",JWT list values,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark.organization_type | [""public"", ""private""]",The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro organization_type
x,TA-Entity Statement response OP-trust_mark-policy_uri,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | policy_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro policy_uri
o,TA-Entity Statement response OP-trust_mark-policy_uri-type,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the policy_uri claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""policy_uri"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""policy_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro policy_uri
x,TA-Entity Statement response OP-trust_mark-ref,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the ref claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | ref,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-ref-type,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the ref claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain an URL in the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the ref claim in it is checked.",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""ref"": { ""type"": ""string"", ""format"": ""uri"" } }, ""required"": [""ref""] }",The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
o,TA-Entity Statement response OP-trust_mark-sa_profile-value,Trust Mark generated for an SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the sa_profile claim is 'full' or 'light', not compliant otherwise",nested JWT parameter values,Correct Input,Entity Statement response OP,Does the issued intermediary Trust Mark contain a correct sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sa_profile | [""light"", ""full""]","In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro sa_profile
x,TA-Entity Statement response OP-trust_mark-service_documentation,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | service_documentation,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro service_documentation
o,TA-Entity Statement response OP-trust_mark-service_documentation-type,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the service_documentation claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""service_documentation"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""service_documentation""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro service_documentation
o,TA-Entity Statement response OP-trust_mark-signature,Entity statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the signature is valid, not compliant otherwise",nested JWT signature check,Correct Input,Entity Statement response OP,Does the TA correctly sign the issued Trust Mark,"To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks | trust_mark | X_key_TA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,
x,TA-Entity Statement response OP-trust_mark-sub,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the sub claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the Trust Mark contain sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sub,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-sub-value,Trust Mark generated by TA or SA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the sub claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""sub"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""sub""]}",The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response OP-trust_mark-tos_uri,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | tos_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro tos_uri
o,TA-Entity Statement response OP-trust_mark-tos_uri-type,Trust Mark generated for an AA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the tos_uri claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL",TA,,"Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""tos_uri"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""tos_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro tos_uri
x,TA-Entity Statement response OP-trust_marks,Entity Statement issued by the TA,Entity Statement response TA OP,Trigger Entity Statement response TA OP,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response OP,Does Entity Statements issued by the TA contain the trust_marks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",TA,,Entity Statement response TA OP | body | [^\r\n]* | payload | trust_marks,The trust_marks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-constraints,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the constraints parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the constraints parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | constraints,The constraints parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro. constraints si trova in metadata_policy
,TA-Entity Statement response RP-exp,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the exp parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the exp parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | exp,The exp parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-iat,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the iat parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the iat parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | iat,The iat parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-id_code-value,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_code claim is a JSON Object, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""id_code""]}",The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro id_code
x,TA-Entity Statement response RP-iss,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the iss parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statement issued by the TA contain the iss parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | iss,The iss parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-jwks,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the jwks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the jwks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | jwks,The jwks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-metadata_policy,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the metadata_policy parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the metadata_policy parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy,The metadata_policy parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response RP-metadata_policy-client_registration_types-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the client_registration_types parameter is present in the openid_relying_party type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct client_registration_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.client_registration_types.subset_of,The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro client_registration_types
x,TA-Entity Statement response RP-metadata_policy-client_registration_types-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the client_registration_types parameter is present in the openid_relying_party type and contains the value 'one_of': ['automatic'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct client_registration_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['automatic']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.client_registration_types.subset_of | [""automatic""]",The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-grant_types-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the grant_types parameter inside the openid_relying_party type is present and it contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct grant_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' and 'superset_of'",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | .metadata_policy.openid_relying_party.grant_types | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of"", ""superset_of""]}",The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca superset_of
x,TA-Entity Statement response RP-metadata_policy-grant_types-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the grant_types parameter inside the openid_relying_party type is present and it contains the value 'subset_of: [authorization_code, refresh_token]', not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct grant_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with '[authorization_code, refresh_token]'",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.grant_types.subset_of | [""authorization_code"", ""refresh_token""]",The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,,F,P,passed,[PRIMA] Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-id_token_encrypted_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_encrypted_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_encrypted_response_alg.one_of,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro id_token_encrypted_response_alg 
x,TA-Entity Statement response RP-metadata_policy-id_token_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_encrypted_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_encrypted_response_alg.one_of | [""RSA-OAEP"", ""RSA-OAEP-256""]",The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-id_token_encrypted_response_enc-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_encrypted_response_enc parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_encrypted_response_enc.one_of,The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro id_token_encrypted_response_enc
x,TA-Entity Statement response RP-metadata_policy-id_token_encrypted_response_enc-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_encrypted_response_enc parameter is present in the openid_relying_party type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_encrypted_response_enc.one_of | [""A128CBC-HS256"" , ""A256CBC-HS512""]",The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-id_token_signed_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_signed_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant if it is missing or empty",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_signed_response_alg.one_of,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro id_token_signed_response_alg
x,TA-Entity Statement response RP-metadata_policy-id_token_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_signed_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_signed_response_alg.one_of | [""RS256"" , ""RS512""]",The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-incorrect-id_token_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_token_encrypted_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant if present",JWT list parameter does not contain,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values for the id_token_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_encrypted_response_alg.one_of | [""RSA_1_5""]",The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro.
x,TA-Entity Statement response RP-metadata_policy-incorrect-id_token_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the value of id_token_signed_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not compliant if present",JWT list parameter does not contain,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values for the id_token_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.id_token_signed_response_alg.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro.
x,TA-Entity Statement response RP-metadata_policy-incorrect-userinfo_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_encrypted_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values for the userinfo_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_encrypted_response_alg.one_of | [""RSA_1_5""]",The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro.
x,TA-Entity Statement response RP-metadata_policy-incorrect-userinfo_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_signed_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values in the userinfo_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_signed_response_alg.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro.
x,TA-Entity Statement response RP-metadata_policy-jwks,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the jwks parameter is present inside the openid_relying_party type of the metadata_policy, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain the jwks parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | jwks,The jwks claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-metadata_policy-response_types-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the response_types parameter is present in the openid_relying_party type and contains the key 'value', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct response_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types parameter inside the openid_relying_party type is checked. It must contain the key 'value'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.response_types.value,The response_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca response_types
,TA-Entity Statement response RP-metadata_policy-response_types-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the response_types parameter is present in the openid_relying_party type and contains the key 'value', not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct response_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types parameter inside the openid_relying_party type is checked. It must contain the key 'value'",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.response_types.value | [""code""]",The response_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca response_types
x,TA-Entity Statement response RP-metadata_policy-token_endpoint_auth_method-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the token_endpoint_auth_method parameter is present in the openid_relying_party type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct token_endpoint_auth_method parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.token_endpoint_auth_method.one_of,The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro token_endpoint_auth_method
x,TA-Entity Statement response RP-metadata_policy-token_endpoint_auth_method-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the token_endpoint_auth_method parameter is present in the openid_relying_party type and contains the value 'one_of': ['private_key'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct token_endpoint_auth_method parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['private_key']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.token_endpoint_auth_method.one_of | [""private_key""]",The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-userinfo_encrypted_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_encrypted_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant if it is missing or empty",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_encrypted_response_alg.one_of,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro userinfo_encrypted_response_alg
x,TA-Entity Statement response RP-metadata_policy-userinfo_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_encrypted_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_encrypted_response_alg.one_of | [""RSA-OAEP"", ""RSA-OAEP-256""]",The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
o,TA-Entity Statement response RP-metadata_policy-userinfo_encrypted_response_enc-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain the userinfo_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_encrypted_response_enc.one_of,The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro userinfo_encrypted_response_enc
o,TA-Entity Statement response RP-metadata_policy-userinfo_encrypted_response_enc-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain the userinfo_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_encrypted_response_enc.one_of | [""A128CBC-HS256"" , ""A256CBC-HS512""]",The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
x,TA-Entity Statement response RP-metadata_policy-userinfo_signed_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_signed_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_signed_response_alg.one_of,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro userinfo_signed_response_alg
x,TA-Entity Statement response RP-metadata_policy-userinfo_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the userinfo_signed_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['RS256', 'RS512']",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.userinfo_signed_response_alg.one_of | [""RS256"", ""RS512""]",The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,TBD,failed,Manca parametro. metadata_policy contiene solo openid_provider ma è vuoto
,TA-Entity Statement response RP-release,TA's fetch Entity Statement Endpoint response regarding the Entity we are considering,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the TA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",HTTP parameter type,Correct Input,Entity Statement response RP,Does the TA correctly release the Entity statements,"After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",TA,,Entity Statement response TA RP | body | ([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it.,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-signature,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the signature is verified, not compliant otherwise",JWT signature check,Correct Input,Entity Statement response RP,Does the TA correctly sign the Entity statements,"In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",TA,,Entity Statement response TA RP | body | [^\r\n]* | X_key_TA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Signature non corretta
,TA-Entity Statement response RP-sub,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the sub parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the sub parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | sub,The sub parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-claims,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | claims,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro claims
,TA-Entity Statement response RP-trust_mark-claims-type,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the claims claim is a list of JSON Objects, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""claims"": {""type"": ""object"", ""additionalProperties"": {""type"": ""object""}}},""required"": [""claims""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro claims
,TA-Entity Statement response RP-trust_mark-email,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the email claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | email,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro email
,TA-Entity Statement response RP-trust_mark-email-type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the email claim is of type string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the correct type of the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the email claim in it is checked.",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {  ""type "":  ""object "",  ""properties "": {  ""email "": {  ""type "":  ""string "",  ""format "":  ""email "" } },  ""required "": [ ""email ""] } ",The issued Trust Marks must have the email claim as string,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,No email
,TA-Entity Statement response RP-trust_mark-exp,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the exp claim is present, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | exp,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro exp
x,TA-Entity Statement response RP-trust_mark-exp-type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the exp claim is UNIX Timestamp, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the exp type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the exp claim in it is checked.",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""exp"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""exp""]}",The issued Trust Marks must have the exp claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,No exp
,TA-Entity Statement response RP-trust_mark-fiscal_number-or-vat_number,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,nested JWT parameter type,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""fiscal_number"": {}, ""vat_number"":{}},""anyOf"":[{""required"":[""fiscal_number""]},{""required"":[""vat_number""]}]}},""required"":[""id_code""]}",The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,[ORA] Manca id_code
,TA-Entity Statement response RP-trust_mark-iat,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the iat claim is present, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iat,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-iat-type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the iat type is in UNIX Timestamp in the trust mark payload, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the correct iat type,"In this test, an issued Trust Mark must be taken, decrypted and the type of the iat claim in it is checked.",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""iat"": { ""type"": ""integer"", ""minimum"": 0 } }, ""required"": [""iat""]}",The issued Trust Marks must have the iat claim in UNIX Timestamp,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
,TA-Entity Statement response RP-trust_mark-id,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the id claim,"The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-id_code,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id_code claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | id_code,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro id_code
,TA-Entity Statement response RP-trust_mark-id-value,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the id is 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile is 'public' or private', not compliant otherwise",/ manual: wrong parameter,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks | trust_mark | payload | id | openid_relying_party | openid_provider | intermediate | oauth_resource,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-ipa_code,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued by a TA for a public organization contain ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | $.id_code.ipa_code,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,[ORA] Manca id_code
,TA-Entity Statement response RP-trust_mark-ipa_code-type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued by a TA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""id_code"": {""type"":""object"", ""properties"": {""ipa_code"": { ""type"":""string""}},""required"":[""ipa_code""]}},""required"":[""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,[ORA] Manca id_code
,TA-Entity Statement response RP-trust_mark-ipa_code-value,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim for public organizations,nested JWT parameter type,Correct Input,Entity Statement response RP,Does the id_code claim of a Trust Mark issued for public organization contain the ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the ipa_code in the id_code is checked",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": { ""id_code"": { ""type"": ""object"", ""properties"": {""ipa_code"": {}},""required"": [""ipa_code""]}},""required"": [""id_code""]}",The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations.,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Presence of wrong parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,,F,failed,[ORA] Manca id_code
x,TA-Entity Statement response RP-trust_mark-iss,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the iss claim is present, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | iss,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response RP-trust_mark-iss-value,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the iss claim is an URL identifying the TA, not compliant otherwise",nested JWT Check-Save to JWT,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL",TA,Entity Configuration response TA | body | [^\r\n]* | payload | iss | valid_iss,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks | trust_mark | payload | iss,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Active,M,Mismatch of parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-logo_uri,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the logo_uri claim is present in the trust_mark JWT in the trust_marks parameter, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | logo_uri,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,Manca parametro logo_uri
,TA-Entity Statement response RP-trust_mark-logo_uri-value,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the logo_uri parameter in the trust mark in the trust marks parameter of the response is an URI, not compliant otherwise ",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""logo_uri"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""logo_uri""]}",The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro logo_uri
,TA-Entity Statement response RP-trust_mark-organization_name,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the organization_name claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_name,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro organization_name
x,TA-Entity Statement response RP-trust_mark-organization_name-type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the organization_name claim is type string and has value ""public"" or ""private"", not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain the correct type of organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the organization_name claim in it is checked.",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type "":  ""object "", ""properties "": { ""organization_name "": { ""type "":  ""string "", ""enum "": [ ""private "",  ""public ""]}}, ""required "": [ ""organization_name ""]}",The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,F,failed,No organization_name
,TA-Entity Statement response RP-trust_mark-organization_type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the organization_type claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | organization_type,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro organization_type
,TA-Entity Statement response RP-trust_mark-organization_type-value,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the organization_type claim is 'public' or 'private', not compliant otherwise",JWT list values,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | organization_type | [""public"", ""private""]",The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,[SAME] Manca parametro organization_type
,TA-Entity Statement response RP-trust_mark-policy_uri,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | policy_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro policy_uri
,TA-Entity Statement response RP-trust_mark-policy_uri-type,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the policy_uri claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""policy_uri"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""policy_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro policy_uri
,TA-Entity Statement response RP-trust_mark-ref,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the ref claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | ref,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response RP-trust_mark-ref-type,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the ref claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain an URL in the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the type of the ref claim in it is checked.",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | { ""type"": ""object"", ""properties"": { ""ref"": { ""type"": ""string"", ""format"": ""uri"" } }, ""required"": [""ref""] }",The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,,P,passed,
,TA-Entity Statement response RP-trust_mark-sa_profile-value,Trust Mark generated for an SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the sa_profile claim is 'full' or 'light', not compliant otherwise",nested JWT parameter values,Correct Input,Entity Statement response RP,Does the issued intermediary Trust Mark contain a correct sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sa_profile | [""light"", ""full""]","In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro sa_profile
,TA-Entity Statement response RP-trust_mark-service_documentation,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | service_documentation,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro service_documentation
,TA-Entity Statement response RP-trust_mark-service_documentation-type,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the service_documentation claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""service_documentation"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""service_documentation""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro service_documentation
,TA-Entity Statement response RP-trust_mark-signature,Entity statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the signature is valid, not compliant otherwise",nested JWT signature check,Correct Input,Entity Statement response RP,Does the TA correctly sign the issued Trust Mark,"To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks | trust_mark | X_key_TA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,Passive,H,An inaccurate signature poses challenges in maintaining confidentiality and integrity.,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,F,F,failed,
,TA-Entity Statement response RP-trust_mark-sub,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the sub claim is present in the trust mark, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the Trust Mark contain sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sub,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-sub-value,Trust Mark generated by TA or SA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the sub claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""sub"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""sub""]}",The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
,TA-Entity Statement response RP-trust_mark-tos_uri,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | tos_uri,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro tos_uri
,TA-Entity Statement response RP-trust_mark-tos_uri-type,Trust Mark generated for an AA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the tos_uri claim is an URL, not compliant otherwise",nested JWT parameter type,Correct Input,Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL",TA,,"Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload |  | {""type"": ""object"", ""properties"": {""tos_uri"": {""type"": ""string"", ""format"": ""uri-reference""}}, ""required"": [""tos_uri""]}","In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Problema implementazione,P,F,failed,Manca parametro tos_uri
,TA-Entity Statement response RP-trust_marks,Entity Statement issued by the TA,Entity Statement response TA RP,Trigger Entity Statement response TA RP,"Compliant if the trust_marks parameter is present, not compliant otherwise",JWT parameter presence,Correct Input,Entity Statement response RP,Does Entity Statements issued by the TA contain the trust_marks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",TA,,Entity Statement response TA RP | body | [^\r\n]* | payload | trust_marks,The trust_marks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,,P,P,passed,
x,TA-Entity Statement response SA-metadata_policy-client_registration_types-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the client_registration_types parameter is present in the intermediary type and contains the key 'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct client_registration_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.client_registration_types.subset_of,The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-client_registration_types-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the client_registration_types parameter is present in the intermediary type and contains the value 'one_of': ['automatic'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct client_registration_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['automatic']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.client_registration_types.subset_of | [""automatic""]",The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-grant_types-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the grant_types parameter is present in the intermediary type and it contains the key 'subset_of', not compliant otherwise",JWT parameter type,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct grant_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of' and 'superset_of'",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | .metadata_policy.intermediary.grant_types | {""type"": ""object"", ""properties"": {""subset_of"": {}, ""superset_of"": {}}, ""required"": [""subset_of""], [""superset_of""]}",The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,L,Type mismatch,,,,,,,From the trust marks table I assumed the correct type is intermediary,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-grant_types-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the grant_types parameter is present in the intermediary type and it contains the value 'subset_of: [authorization_code, refresh_token]', not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct grant_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of' values with ['authorization_code', 'refresh_token']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.grant_types.subset_of | [""authorization_code"", ""refresh_token]",The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,From the trust marks table I assumed the correct type is intermediary,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-id_token_encrypted_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_encrypted_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encrypted_response_alg.one_of,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-id_token_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_encrypted_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of': valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encrypted_response_alg.one_of | [""RSA-OAEP"", ""RSA-OAEP-256""]",The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-id_token_encrypted_response_enc-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_encrypted_response_enc parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encrypted_response_enc.one_of,The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-id_token_encrypted_response_enc-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_encrypted_response_enc parameter is present in the intermediary type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encrypted_response_enc.one_of | [""A128CBC-HS256"", ""A256CBC-HS512""]",The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-id_token_signed_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_signed_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_signed_response_alg.one_of,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-id_token_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_signed_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_signed_response_alg.one_of | [""RS256"", ""RS512""]",The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-incorrect-id_token_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_encrypted_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid value for the id_token_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_encrypted_response_alg.one_of | [""RSA_1_5""]",The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-incorrect-id_token_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the id_token_signed_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid values for the id_token_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.id_token_signed_response_alg.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-incorrect-userinfo_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_encrypted_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid values for the userinfo_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encrypted_response_alg.one_of | [""RSA_1_5""]",The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-incorrect-userinfo_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_signed_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",JWT list parameter does not contain,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid values for the userinfo_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_signed_response_alg.one_of | [""none"", ""HS256"", ""HS384"", ""HS512""]",The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
,TA-Entity Statement response SA-metadata_policy-response_types-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if theresponse_types parameter is present in the intermediary type and it contains the key 'value', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct response_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types parameter inside the intermediary type is checked. It must contain the key 'value'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.response_types.value,The response_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,From the trust marks table I assumed the correct type is intermediary,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
,TA-Entity Statement response SA-metadata_policy-response_types-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if theresponse_types parameter is present in the intermediary type and it contains the key 'value', not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct response_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types parameter inside the intermediary type is checked. It must contain the key 'value' with value 'code'",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.openid_relying_party.response_types.value | [""code""]",The response_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,From the trust marks table I assumed the correct type is intermediary,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-token_endpoint_auth_method-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the token_endpoint_auth_method parameter is present in the intermediary type and contains the key  'one_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct token_endpoint_auth_method parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.token_endpoint_auth_method.one_of,The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-token_endpoint_auth_method-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the token_endpoint_auth_method parameter is present in the intermediary type and contains the value 'one_of': ['private_key'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct token_endpoint_auth_method parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['private_key']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.token_endpoint_auth_method.one_of | [""private_key""]",The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-userinfo_encrypted_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_encrypted_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encrypted_response_alg.one_of,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-userinfo_encrypted_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_encrypted_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encrypted_response_alg.one_of | [""RSA-OAEP"", ""RSA-OAEP-256""]",The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-userinfo_encrypted_response_enc-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_encrypted_response_enc parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encrypted_response_enc.one_of,The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-userinfo_encrypted_response_enc-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_encrypted_response_enc parameter is present in the intermediary type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_encrypted_response_enc.one_of | [""A128CBC-HS256"", ""A256CBC-HS512""]",The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-userinfo_signed_response_alg-key,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_signed_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",JWT parameter JSON presence,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_signed_response_alg.one_of,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-metadata_policy-userinfo_signed_response_alg-value,Metadata policy in an Entity Statement issued by the TA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the userinfo_signed_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",JWT list parameter contains,Correct Input,Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,,"Entity Statement response TA SA | body | [^\r\n]* | payload | metadata_policy.intermediary.userinfo_signed_response_alg.one_of | [""RS256"", ""RS512""]",The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,Passive,M,Mismatch of content,,,,,,,,FALSE,,,yes,s1,E,Messaggio non presente,N_A,N_A,not_applicable,Entity Statement response SA
x,TA-Entity Statement response SA-trust_mark-sa_profile,Trust Mark generated for an SA,Entity Statement response TA SA,Trigger Entity Statement response TA SA,"Compliant if the sa_profile claim is present in the trust mark payload, not compliant otherwise",nested JWT parameter presence,Correct Input,Entity Statement response SA,Does the issued intermediary Trust Mark contain the sa_profile claim,"A Trust Mark issued by a TA for an SA is taken, decrypted and the presence of the sa_profile claim is checked.",TA,,Entity Statement response TA SA | body | [^\r\n]* | payload | trust_marks[0].trust_mark | payload | sa_profile,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,Passive,M,Missing parameter,,,,,,,,FALSE,,,yes,s1,E,Non supportato,N_A,N_A,not_applicable,Manca parametro sa_profile
x,TA-Fetch Entity Statement response OP-exposed,Fetch Entity Statement Endpoint endpoint response,Fetch Entity Statement response TA OP,Trigger Fetch Entity Statement response TA OP,"Compliant if the response contains a JWT, not compliant otherwise",HTTP parameter type,Correct Input,Fetch Entity Statement response OP,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",TA,,Fetch Entity Statement response TA OP | body | ([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Manuali da definire per la prossima versione,N_A,N_A,not_applicable,Fetch Entity Statement response TA OP
,TA-Fetch Entity Statement response RP-exposed,Fetch Entity Statement Endpoint endpoint response,Fetch Entity Statement response TA RP,Trigger Fetch Entity Statement response TA RP,"Compliant if the response contains a JWT, not compliant otherwise",HTTP parameter type,Correct Input,Fetch Entity Statement response RP,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",TA,,Fetch Entity Statement response TA RP | body | ([\w=]+)\.([\w=]+)\.([\w\-\+\/=]*),"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,yes,s1,E,Manuali da definire per la prossima versione,N_A,N_A,not_applicable,Fetch Entity Statement response TA RP
x,TA-Public Keys History response-published,TA's public keys history response,TA's public keys history response,Trigger Public Keys History response,"Compliant if the response contains a JWT, not compliant otherwise",HTTP parameter type,Correct Input,Public Keys History response,Does the TA publish the federation public key history,An HTTP Get request is made to the TA's /.well-known/openid-federation-jwks endpoint and the answer is analyzed,TA,,"Public Keys History response | body | \[\s*""[^""]*""(?:,\s*""[^""]*"")*\s*\]$","In order to enable the verification of messages exchanged by Entities participating in the federation and their Trust Chains, the TA MUST publish the federation public key history (JWKS) within a registry made available to all participants via the /.well-known/openid-federation-jwks endpoint.",SPID_CIE_OIDC#Retention-Policy; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/log_management.html,OIDC Federation,Passive,L,Type mismatch,,,,,,,,FALSE,,,no,s1,E,Manuali da definire per la prossima versione,N_A,N_A,not_applicable,Public Keys History response
x,TA-Trust Mark status response OP-exposed-OP,Trust Mark Status Response,Trust Mark status endpoint response,Trigger Trust Mark status response TA OP,HTTP 200 OK response containing the claim 'active' set to true,/ manual: status code,Correct Input,Trust Mark status response OP,Does the TA Trust Mark Status endpoint effectively verify valid Trust Marks of OP,"To check if the trust mark status endpoint accurately verifies valid trust marks, valid trust marks obtained directly from the OP Entity Configuration response can be sent to the endpoint dynamically according to the 'iss' of the trust mark, and the response can be analyzed.",TA,,,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the trust mark status endpoint. It allows an Entity to test if a TM is still active or not.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Active,L,Return wrong status code,,,,,,,,FALSE,,,yes,s1_logout,E,Problema implementazione,F,F,failed,[SAME] Manca trust_mark in OP in EC
x,TA-Trust Mark status response OP-not_valid-trust_mark-OP,Trust Mark status endpoint response,Trust Mark status endpoint response,Trust Mark status request with a non-valid Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response OP,Does the TA's trust mark status endpoint correctly refuses a not-valid id Trust Marks OP,"In order to check if the trust mark status endpoint of a TA correctly refuses invalid trust marks OP, a invalid trust mark can be sent to the endpoint and the response analyzed",TA,,,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,,P,P,passed,
x,TA-Trust Mark status response RP-exposed-RP,Trust Mark Status Response,Trust Mark status endpoint response,Trigger Trust Mark status response TA RP,HTTP 200 OK response containing the claim 'active' set to true,/ manual: check flow,Correct Input,Trust Mark status response RP,Does the TA Trust Mark Status endpoint effectively verify valid Trust Marks of RP,"To check if the trust mark status endpoint accurately verifies valid trust marks, valid trust marks obtained directly from the RP Entity Configuration response can be sent to the endpoint dynamically according to the 'iss' of the trust mark, and the response can be analyzed.",TA,,,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the trust mark status endpoint. It allows an Entity to test if a TM is still active or not.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Active,H,"If the message flow is interrupted due to an error, even without specifying the exact code, it's not a major issue.",,,,,,,,FALSE,,,yes,s1_logout,E,,P,P,passed,
x,TA-Trust Mark status response RP-not_valid-trust_mark-RP,Trust Mark status endpoint response,Trust Mark status endpoint response,Trust Mark status request with a non-valid Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response RP,Does the TA's trust mark status endpoint correctly refuses a not-valid id Trust Marks RP,"In order to check if the trust mark status endpoint of a TA correctly refuses invalid trust marks RP, a invalid trust mark can be sent to the endpoint and the response analyzed",TA,,,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,,P,P,passed,
x,TA-Trust Mark status response-different-entity-trust_mark,Trust Mark status endpoint response,Trust Mark status response TA (endpoint response),Trust Mark status invalid request,"Compliant if the Trust Mark status response is an HTTP 400 because of invalid_request, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response,Does the TA checks Trust Marks not issued by the Entity,"In this test, a valid Trust Mark issued by another entity is sent to an TA. If it validates the Trust Mark, than is not compliant with the specifications",TA,,,trust mark status endpoint: allows an Entity to test if a TM is still active or not. The request MUST be sent to the subject that has released that TM.,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Problema implementazione,F,F,failed,[SAME] Ritorna 200 - active: false
o,TA-Trust Mark status response-revocated-trust_mark,Trust Mark status endpoint response,Trust Mark status response TA (endpoint response),Trust Mark status endpoint request with invalidated Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",/ manual: TM check content,Wrong Input,Trust Mark status response,Does the TA invalidate revocated trust marks,"In order to check if a TA correctly invalidate a Trust Mark, a Trust Mark revocation request on a Trust Mark has to be made and then the trust mark status endpoint must be fetched. If the response says that the trust mark is invalid, than it is correctly invalidated, otherwise the TA is not compliant with the specification",TA,,,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,Active,H,The severity is based on whether the TM is still active or not,,,,,,,,FALSE,,,yes,s1_logout,E,Messaggio non presente,N_A,N_A,not_applicable,