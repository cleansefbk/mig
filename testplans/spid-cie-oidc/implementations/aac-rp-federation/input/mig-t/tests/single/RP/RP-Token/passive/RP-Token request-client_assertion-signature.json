{
  "test suite": {
    "name": "Single test",
    "description": "One test only",
    "filter messages": true
  },
  "tests": [
    {
      "test": {
        "name": "Does the client_assertion in the token request have a correct signature",
        "description": "The client_assertion parameter in the token request sent by the RP must be a JWT with a signature",
        "type": "passive",
        "sessions": [
          "s1"
        ],
        "operations": [
          {
            "message type": "Token request",
            "decode operations": [
              {
                "from": "body",
                "decode param": "(?<=client_assertion=)([^&]+)",
                "type": "jwt",
                "jwt check sig": "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCgOXFh2jO6E1hY\nOVwTbRiUPhjolp9tyi/beKK87KENOMqhFiw+P2EBhx9PC7aifwhM8iXMqKiMLgd/\n3mZxeRbRpLd/urVCToSKMy8x060Qceb4HqE+BFnD4ixAXGpclWXMQQ55u3qc/qma\nEA/YnsBT27nTt8xwcmb7AnCENzNtHt0wMTSBVLMmBc9iLMRwuIccXQorwuXTbbIV\ndmH4vdXn8JE9upENwWTO/rfSGmFifnxa5DXjt442CjeVecur2UA/WChmcEuJi8fh\neuGzGqF0KRitC6S0zaQfTKHsiDmoN0hl7uSLdg4Vm1NnyIexUOYM8nlEHcagf4Is\n+Ogu4uU9AgMBAAECggEAe+qxVBqsMtdPVjxWh/eyMMSuAwSrHQBobvcn9bGVBWLM\n5DT/1syxu7rDbiEDCT3yL4B/138BjBj1V+GrnUsnaNBZ0wGVukh7nV7ku0aY7MUK\n+w7Fae93dVXxH33aDOzGpGgUR/XFaLJUfYC6oLB20uR3HdVi2fzAxJUobDk9HsCs\nq4XrkD4bvlo5pEyGbxupuUKZDFcNq9H2kfo/Ah7hhAHr8ifQ6HlVQTGJwzWTe5gq\nep0Kdw+cyIvQgSoHTLHfFAkisWm3WGzSurHMnlbNx2uu05H1CPfOfEaMaGkCKuQc\n80mvOaq2vzKM7SPJkItM/gfIaHT8TIj5JxPRD2+yQQKBgQDQpmiHt5hLPeooZsVg\nIDv9X70+rUDikuVp206V3H78dR3eA6GZs4DTk0Npmgc9g5uA3g2W3Dtirj+EKtsb\nibazv0nHQjKFPhj6Atn0/Gj+3fwW/MNJMuKijRpN6DHb7L+jQBt/cLKAyPema3Lz\n6UCIkcsWTyyHhBp5iTl1lhFDeQKBgQDElbsacCDGB35FuRjuNejADroRLdZmWkMy\nVnSaevJfnGc91oyhz/Z0ZCIfed5bVOIK5gGtlbj7Nu/mJqJ72tp/IvNN0yzpWIyT\nv6KDmQI+ZlQBw1mjTbrYauMEwaab20FM4nn5hIk5bYXi0+ej3HwPAbDLNlT0JpnL\nhAjdLkFa5QKBgBVLtsWLXpbnZdvjyWdrQtQ0jls0UbgOaC3qvVWcYLWhun+rfTXz\n1UVC9ZF0sCJ+KUP45ggsyD7lLARwX1arMqOb9YrJ3eAtm10BJ3/St2C0BYPPHpt8\n/xa6MiIbfeNFgbXG2EekmAN+/4/TzbLJbtXBk6neQNxABne7Iss2muJ5AoGAFPYS\nOUNzeyoZYL3X1q6Q3smzNVm53rgJKjjlvgMWDPPUXleeLzLJiKeUq96Gwx5N6/OS\ngjvQuZimA9hiwuoXGi9T2hyGUWtLsgVhAr8x6g1nL7jwueTz41eiVUOAzGWYlOYh\nM2Xaa/EtsX3+2Q4NfFwlycVFUbM7+uNdPphMB7ECgYEAqpF6//mt0NfK1ROgBwkb\nLRBnQg00IM7mWExbQW8V0ET8DInpveSOg3oFaMoeIrd7sPEO2IKU2vrq1weMZBoL\n6+fmKc6AlgBsUUqSSUaot0hGAytkzHj30efJVghnHuzORgKzv9a3eXmyD4LUNrGH\noIQuP3rN+iRTRZ/gmHLRHyo=\n-----END PRIVATE KEY-----\n"
              }
            ]
          }
        ],
        "result": "correct flow s1"
      }
    }
  ]
}