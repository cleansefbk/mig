UID,Input to test,Input to Entity Uder Test,Output,Message Under test,Test Name,Description,Entity under test,Requirement,Requirement Source,Profile,Reference OAuch,Reference OpenID Connect Conformance Profiles v3.0,Note,Comments
AA-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer', not compliant otherwise",Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",AA,"Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
AA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,"Trigger In order to check if the trust mark status endpoint of the AA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed",HTTP 200 OK response containing the claim 'active' set to true,Trust Mark status response,Does the Entity expose the trust mark status endpoint,"In order to check if the trust mark status endpoint of the AA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed",AA,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the trust mark status endpoint. It allows an Entity to test if a TM is still active or not.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,Chiamata assente in implementazione di Giuseppe De Marco,
OP-Authentication response-metadata-value,Authentication response,Authentication request,"Compliant if the OP shows the consent page, not compiant otherwise",Authentication response,Does the OP show the consent view,"In this test an authentication request is accomplished and, when the correct login credentials are inserted, the presence of the consent view shown to the user is checked. If it is not the case, the OP is not compliant",OP,"If the prompt parameter is set to consent login, the OP forces an authentication request to the user. Then it asks permission to transfer the claims. If the prompt parameter is set to consent, if a Single Sign On session is not yet active, the OP makes an Authentication Request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authentication-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
OP-Authentication response-metadata-value,The Authentication error response is analyzed and the presence of the error parameter is checked,Trigger The Authentication error response is analyzed and the presence of the error parameter is checked,"Compliant if the Authentication Response contains the error parameter, not Compliant otherwise",Authentication response,Does the Authentication error response contain the error parameter,The Authentication error response is analyzed and the presence of the error parameter is checked,OP,"In case of errors, the response must contain the error and error_description parameters",SPID_CIE_OIDC#Authentication-Error-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#gestione-degli-errori,OIDC Core,,,,
OP-Authentication response-metadata-value,The Authentication error response is analyzed and the presence of the error_description is checked,Trigger The Authentication error response is analyzed and the presence of the error_description is checked,"Compliant if the Authentication Response has the error_description parameter, not Compliant otherwise",Authentication response,Does the Authentication error response contain the error_description parameter,The Authentication error response is analyzed and the presence of the error_description is checked,OP,"In case of errors, the response must contain the error and error_description parameters",SPID_CIE_OIDC#Authentication-Error-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#gestione-degli-errori,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a Request done with the HTTP GET method and the Query String serialization method,Authentication Request done with the HTTP GET method and the Query String serialization method,"Client redirect to the redirect uri with correct query parameters (scope, code_challenge, code_challenge_method and request) insterted in the URL",Authentication response,Does the OP accept GET requests and the Query String serialization method,"An authentication request is sent with the GET method and the parameters (scope, code_challenge, code_challenge_method and request) are set as query components of the request, using the application/x-www-form-urlencoded format",OP,"For conveying the request, the RP MAY use the methods POST and GET. With the method POST the parameters MUST be sent using the Form Serialization. With the method GET the parameters MUST be sent using the Query String Serialization. For more details see",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a Request done with the HTTP GET method and a wrong serialization method,"Authentication Request done with the HTTP GET method and scope, code_challenge, code_challenge_method and request parameters inserted in the body of the request using the application/x-www-form-urlencoded format","Compliant if the Authentication response is HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP accept GET requests with a wrong serialization method,"An authentication request is sent with the GET method and the parameters (scope, code_challenge, code_challenge_method and request) are inserted in the body of the request, using the application/x-www-form-urlencoded format",OP,"For conveying the request, the RP MAY use the methods POST and GET. With the method GET the parameters MUST be sent using the Query String Serialization",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a Request done with the HTTP POST method and the Form serialization method,Authentication Request done with the HTTP POST method and the Form serialization method,"Client redirect to the redirect uri with correct query parameters (scope, code_challenge, code_challenge_method and request) insterted in the URL",Authentication response,Does the OP accept POST requests and the Form serialization method,"An authentication request is sent with the POST method and the parameters (scope, code_challenge, code_challenge_method and request) are inserted in the body of the request, using the application/x-www-form-urlencoded format",OP,"For conveying the request, the RP MAY use the methods POST and GET. With the method POST the parameters MUST be sent using the Form Serialization. With the method GET the parameters MUST be sent using the Query String Serialization. For more details see",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with a request parameter being a JWT without signature,Authentication Request with the request parameter in the url being a JWT without signature,"Compliant if the Authentication response is HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the signature of the JWT,"This test aims to verify if the OP checks the presence of the signature in an authentication request's JWT. In particular, since the JWT is composed by three parts (header, payload and signature), an Authentication Request is sent with a JWT without the last part of it, the signature.",OP,"The Authorization request is initiated by the user that selects the OP for the authentication. The RP redirects the user to the Authorization Endpoint of the selected OP, including in the request the parameter request that is a signed JWT containing the Authorization Request.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is a JWT signature required (IsSignatureRequired),Support request request parameter iwht unsecured request,,
OP-Authentication response-metadata-value,Authentication Response to a Request done with the HTTP POST method and a wrong serialization method,"Authentication Request done with the HTTP POST method and scope, code_challenge, code_challenge_method and request parameters set as query components of the request, using the application/x-www-form-urlencoded format","Compliant if the Authentication response is HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP accept POST requests with a wrong serialization method,"An authentication request is sent with the POST method and the parameters (scope, code_challenge, code_challenge_method and request) are set as query components of the request, using the application/x-www-form-urlencoded format",OP,"For conveying the request, the RP MAY use the methods POST and GET. With the method POST the parameters MUST be sent using the Form Serialization",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication response to a request with prompt parameter set to consent login,Authentication request with prompt parameter set to consent login,"Compliant if the OP shows a login page to the client, not compliant otherwise",Authentication response,Does the OP correctly handle the prompt parameter set to 'consent login' in the case of a new request,"In the case of the prompt parameter set to 'consent login' in an authentication request, the OP should send an authentication request to the user in any case. In order to verify this behavior, a fresh authentication request is accomplished and the action of the OP verified.",OP,In case of a prompt parameter set to consent login in an authentication request: The OP forces an authentication request to the user. Then it asks permission to transfer the claims.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,JWT Response (correct check-yes) but must build custom control of output (login page),
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must identify the client issuing the request,Trigger The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must identify the client issuing the request,"Compliant if the JWT Access Token Payload contains the client_id parameter and its value identifies the RP, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'client_id' parameter in the Payload and identify the client,The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must identify the client issuing the request,OP,The JWT Access Token Payload requires the client_id parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication response to a request with prompt parameter set to consent login and SSO session active,Authentication request with prompt parameter set to consent login and SSO session active,"Compliant if the OP shows a login page to the client, not compliant otherwise",Authentication response,Does the OP correctly handles the prompt parameter set to 'consent login' in the case of SSO,"In the case of the prompt parameter set to 'consent login' in an authentication request, the OP should send an authentication request to the user in any case. In order to verify this behavior, an authentication request while a SSO session is active is accomplished and the action of the OP verified. It should show a login page and ask for the credentials.",OP,In case of a prompt parameter set to consent login in an authentication request: The OP forces an authentication request to the user. Then it asks permission to transfer the claims.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication response to a request with prompt parameter set to consent,Authentication request with prompt parameter set to consent,"Compliant if the OP shows a login page to the client, not compliant otherwise",Authentication response,Does the OP correctly handle the prompt parameter set to 'consent' in the case of a new request,"In the case of the prompt parameter set to 'consent login' in an authentication request, the OP should send an authentication request to the user in any case. In order to verify this behavior, an authentication request while a SSO session is active is accomplished and the action of the OP verified. It should show a login page and ask for the credentials.",OP,"In case of a prompt parameter set to consent in an authentication request, if a Single Sign On session is not yet active, the OP makes an Authentication Request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,JWT Response (correct check-yes) but must build custom control of output (login page),
OP-Authentication response-metadata-value,Authentication response to a request with prompt parameter set to consent and SSO session active,Authentication request with prompt parameter set to consent and SSO session active,"Compliant if the OP directly allows the authentication request, not compliant otherwise",Authentication response,Does the OP correctly handles the prompt parameter set to 'consent' in the case of SSO,"In the case of the prompt parameter set to consent in an authentication request, the OP has to verify if a SSO session is active and, in this case, it should consent the request. In order to verify this behavior, an authentication request with the prompt parameter set to consent while such a session is active is accomplished and the action of the OP verified. It should not show a login page, automatically authenticating the user.",OP,"In case of a prompt parameter set to consent in an authentication request, if a Single Sign On session is not yet active, the OP makes an Authentication Request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter set to the OP's identifier","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter set to the OP's identifier","Compliant if the OP redirects the client to the redirect_uri with the iss parameter set to the correct OP's identifier, not compliant otherwise",Authentication response,Does the OP contain iss set to the its identifier on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter set to the OP's identifier",OP,If the authentication is successful the OpenID Provider (OP) redirects the user by adding iss parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter. This parameter must have the same value of the 'state' parameter sent in the payload of the request parameter in the Authentication request","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter. This parameter must have the same value of the 'state' parameter sent in the payload of the request parameter in the Authentication request","Compliant if the OP redirects the client to the redirect_uri and the value of the state parameter in the query parameters corresponds to the state parameter sent in the request, not compliant otherwise",Authentication response,Does the OP contain correct state parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter. This parameter must have the same value of the 'state' parameter sent in the payload of the request parameter in the Authentication request",OP,If the authentication is successful the OpenID Provider (OP) redirects the user by adding state parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Is the state parameter present in the authorization response (StatePresent),OAuth state request value returned in response,,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri.","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri.","Compliant if the OP redirects the client to the redirect_uri, not compliant otherwise",Authentication response,Does the OP correctly redirects the client,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri.",OP,If the authentication is successful the OpenID Provider (OP) redirects the user to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Is at least one grant type supported (HasSupportedFlows),Can make request with code response_type,,
OP-Authentication response-metadata-value,Authentication Response to a request without the scope parameter in the URL,Authentication Request with the scope parameter in the URL that differs from the one in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with the scope parameter different in the URL and in the JWT,The Authentication Request is intercepted and the iss parameter in the URL of the request (scope in the HTTP request) is modified to a valid value but different from the JWT's one. The same parameter in the JWT's payload is left unchanged,OP,"The parameter scope MUST be sent both as a parameter in the HTTP request, and inside the request object. The two values MUST be the same.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the code_challenge parameter,Authentication Request without the code_challenge parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the code_challenge parameter,"The 'code_challenge' parameter in an authentication request is part of the PKCE protocol and is useful against various attacks. In order to test if the OP checks this parameter, an authorization request is sent without the client_id in the JWT and the answer is analyzed",OP,The JWT payload must contain the code_challenge parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Does the server require PKCE (IsPkceRequired),,,
OP-Authentication response-metadata-value,Authentication Response to a Request without the code_challenge and code_challenge_method parameter in the HTTP request,Authentication Request without the code_challenge and code_challenge_method parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP require PKCE,"An authentication request with empty code_challenge and code_challenge_method parameter is sent and the response analyzed. If the OP accepts the request, than plain PKCE is accepted and a protection against attacks like CSRF and authorization code injection attacks is missing",OP,The JWT payload must contain the code_challenge parameter. The JWT payload must contain the code_challenge_method parameter and its value must be in the code_challenge_methods_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,"Does the server require PKCE (IsPkceRequired), Does the server support plain PKCE (PlainPkce)",,,
OP-Authentication response-metadata-value,Authentication Response to a request without the code_challenge_method parameter,Authentication Request without the code_challenge_method parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the code_challenge_method parameter,"The 'code_challenge_method' parameter in an authentication request says to the OP how to verify the code_challenge when receiving the token request. If one request has a wrong code_challenge_method, than the OP will not be able to verify this parameter. In order to test the OP's behavior, an Authenticaton request is sent without code_challenge_method and the answer is analyzed",OP,The JWT payload must contain the code_challenge_method parameter and its value must be in the code_challenge_methods_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is PKCE implemented (IsPkceImplemented),,,
OP-Authentication response-metadata-value,Authentication Response to a request without the request parameter,Authentication Request without the request parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the request parameter,"The 'request' parameter in an authentication request is crucial to authenticate and answer correctly. If a request is missing the request parameter, than the OP should refuse it. In order to test the OP's behavior, an Authenticaton request is sent without request parameter in the URL and the answer is analyzed",OP,The JWT payload must contain the request parameter and its value must a JWT,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with the request parameter that is not a JWT,Authentication Request with a request parameter in the URL that is not a JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with the request parameter that is not a JWT,"The 'request' parameter in an authentication request is crucial to authenticate and answer correctly. If a request has a request parameter, that is not a JWT, it means that the OP should refuse it. In order to test the OP's behavior, an Authenticaton request is sent with a random value in the request parameter in the URL and the answer is analyzed",OP,The JWT payload must contain the request parameter and its value must a JWT,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer', not compliant otherwise",Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",OP,"Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,"In order to verify if the OP validates the trust chain, the signature of the trust marks in the RP's Entity Configuration must be wrong. If the OP validates the request anyway, than it is not checking the Trust Mark signature and it is not compliant with the specifications",Entity Configuration response containing a trust mark with wrong signature,"Compliant if the OP responds with an HTTP 302 error and because of unauthorized_client, not compliant otherwise",Entity Configuration response,Does the OP validate the signature of the RP Trust Marks,"In order to verify if the OP validates the trust chain, the signature of the trust marks in the RP's Entity Configuration must be wrong. If the OP validates the request anyway, than it is not checking the Trust Mark signature and it is not compliant with the specifications",OP,The OP obtains the Entity Configuration of the RP and validates the signatures of Trust Mark that are recognized inside the Federation,SPID_CIE_OIDC#Metadata-Retrieval-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#openid-provider,OIDC Federation,,,Signature JWT Response (correct check-no) but the JWT is nested,
OP-Authentication response-metadata-value,Authentication Response to a request with a request parameter signed with a symmetric algorithm,Authentication Request with a request parameter signed with a symmetric algorithm,"Compliant if the Authentication response is an HTTP 302 because of unauthorized_client, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests signed with a non-asymmetric method,"This test aims to check if the OP correctly handles the signature of the Authentication request: If the OP is not able to decrypt the signature, than the public key of the RP is wrong or, otherwise, the algorithm used is not known. If, instead, the OP is able to decrypt the signature, it can mean that the public key is correct and the algorithm known, or that the RP used a symmetric algorithm and the RP's key is the same key used to sign the JWT. In the latter case the confidentiality and integrity of the message cannot be trusted. In this case, the OP must check the 'alg' parameter in the JWT Header and, if it corresponds to a symmetric algorithm or to 'none', it must refuse the authentication request. In order to accomplish this test, a crafted RP could set in its metadata a symmetric key, use it to sign the JWT and send an Authentication Request. Another way to accomplish the test is by intercepting the request, changing the parameter and the signature.",OP,"The JWT Header of the request parameter in the Authentication Request must contain the 'alg' parameter, it must be set to one of the supported values for the OP metadata and must not be 'none' or a symmetric algorithm (MAC).",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,Check the error response code in MIG,
OP-Authentication response-metadata-value,Authentication Response to a request without the acr_values parameter,Authentication Request without the acr_values parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the acr_values parameter,An Authentication Request is sent without the acr_values parameter in JWT and the response analyzed.,OP,The JWT payload must contain the acr_values parameter and its value must be contained in the acr_values_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong acr_values parameter,Authentication Request with wrong acr_values parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a value of the acr_values parameter wrong or not present in its metadata,In this test an authorization request is sent with a acr_values parameter wrongly set in the JWT and the response is analyzed,OP,The JWT payload must contain the acr_values parameter and its value must be contained in the acr_values_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection Request with an expired token,Introspection Request with an expired token,"Compliant if the Introspection Response's body is a JSON Object with only an 'active' parameter set to false, not compliant otherwise",Introspection response,Does the Introspection Endpoint returns false on expired tokens,"To test that the Introspection response of the OP's correctly identifies expired tokens, an expired one is sent and the response is analyzed",OP,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a token issued for another client,Introspection Request with a token that does not belong to the RP making the request,"Compliant if the Introspection Response is a JSON Object with only an 'active' parameter set to false, not compliant otherwise",Introspection response,Does the Introspection Endpoint returns false on tokens that do not belong to the RP,"To test that the Introspection response of the OP's correctly identifies tokens that do not belong to the RP making the request, a token issued for another RP is sent by a different RP and the response is analyzed",OP,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,,,,
OP-Revocation request-metadata-value,The revocation request must be sent via HTTP POST,Trigger Revocation Request,"Compliant if the Revocation request is in HTTP POST, not compliant otherwise",Revocation request,Does the OP verify the HTTP method of the Revocation request,The revocation request must be sent via HTTP POST,OP,The OP must test the HTTP method in the revocation request,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked. Moreover, its value must be set to 'at+jwt', if it is not, than the Access Token is not compliant","Compliant if the Access Token Header has the typ parameter and it is set to 'at+jwt', not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'typ' parameter valid in the Header,"The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked. Moreover, its value must be set to 'at+jwt', if it is not, than the Access Token is not compliant",OP,The JWT Access Token Header requires the typ parameter and it must be set to 'at+jwt',SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,Not present in the description but present in the example,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter equals to the URL of the OP in the Payload is checked,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter equals to the URL of the OP in the Payload is checked,"Compliant if the JWT Access Token Payload has the iss parameter equals to the URL of the OP, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'iss' parameter in the Payload equals to the URL of the OP,The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter equals to the URL of the OP in the Payload is checked,OP,The JWT Access Token Payload requires the iss parameter equals to the URL of the OP,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with grant_type set to refresh_token and a valid refresh_token ,Token request with grant_type set to refresh_token and a valid refresh_token,"Compliant if the Token Response contains the Access Token, not compliant otherwise",Token response,Does the OP release Access Tokens with the use of refresh tokens,"In this test the offline access flow is accomplished and a refresh token is obtained. After this, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The response must include the Access Token",OP,"The Refresh Token MUST NOT allow the requesting RP to obtain an ID Token, neither the one previously issued during authentication nor a new ID Token",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,This test verifies the presence of Cache-Control set to 'no-store' in the token response.,Trigger This test verifies the presence of Cache-Control set to 'no-store' in the token response.,"Compliant if the token response has Cache-Control set to 'no-store', not Compliant otherwise",Token response,Does the token response have Cache-Control set to 'no-store',This test verifies the presence of Cache-Control set to 'no-store' in the token response.,OP,The error Token response must have Cache-Control set to 'no-store',SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,This test verifies the head Content-Type set to application/json in the error token response.,Trigger error This test verifies the head Content-Type set to application/json in the error token response.,"Compliant if the error token response has application/json set in Content-Type, not Compliant otherwise",Token response,Does the Content-Type in a error token response set correctly?,This test verifies the head Content-Type set to application/json in the error token response.,OP,The error Token response must have the Content-Type head set to application/json.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,This test verifies the presence of error_description parameter in the error token response.,Trigger error This test verifies the presence of error_description parameter in the error token response.,"Compliant if the error token response has error_description parameter, not Compliant otherwise",Token response,Does the error token response have error_description parameter,This test verifies the presence of error_description parameter in the error token response.,OP,The error Token response must have error_description parameter,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,This test verifies the presence of error parameter in the error token response.,Trigger error This test verifies the presence of error parameter in the error token response.,"Compliant if the error token response has error parameter, not Compliant otherwise",Token response,Does the error token response have error parameter,This test verifies the presence of error parameter in the error token response.,OP,The error Token response must have error parameter,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger To test this OP functionality, a flow is started using an RP that exposes the 'id_token_encrypted_response_alg' parameter. Once received the ID Token, it has to be not only signed but also encrypted","Compliant if the ID Token obtained in the Token Response is a nested signed and encrypted JWT, not compliant otherwise",Token response,Does the OP encrypt the ID Token when the 'id_token_encrypted_response_alg' parameter is exposed in the RP's metadata,"To test this OP functionality, a flow is started using an RP that exposes the 'id_token_encrypted_response_alg' parameter. Once received the ID Token, it has to be not only signed but also encrypted",OP,If the RP exposes in its metadata the parameter id_token_encrypted_response_alg the OP MUST encrypt the ID Token. In this case the ID Token MUST be a nested signed and encrypted JWT,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be an asymmetric algorithm between those defined in the 'id_token_signing_alg_values_supported' parameter of the OP's metadata","Compliant if the ID Token Header has the alg parameter and contains one of the values in the OP's metadata, not compliant otherwise",Token response,Does the issued JWT ID Token contain a correct 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be an asymmetric algorithm between those defined in the 'id_token_signing_alg_values_supported' parameter of the OP's metadata",OP,The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,Asymmetric ID Token signature with RS256,Not present in the description of the ID Token but present in the example. I assumed the signature values,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked. It must be equal or superior to the acr send from the RP in the Authentication Request.","Compliant if the ID Token contains the acr claim equal or higher than acr_values requested within the authorization request, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'acr' parameter valid in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked. It must be equal or superior to the acr send from the RP in the Authentication Request.",OP,The JWT ID Token Payload requires the acr parameter and must be set to the 'acr_value' that is satisfied by the OP in the Authentication Request,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,Support acr_values request parameter,,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked. Its value is one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']. It must be equal or superior to the acr send from the RP in the Authentication Request.","Compliant if the ID Token contains the acr claim and its value is one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3'], not Compliant otherwise",Token response,Does the issued JWT ID Token contain correct value of 'acr' parameter valid in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked. Its value is one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']. It must be equal or superior to the acr send from the RP in the Authentication Request.",OP,"The JWT ID Token Payload requires the acr parameter and must be one of ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']",SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'at_hash' parameter in the Payload is checked. In particular, its value must match the base64url encoding of the left-most half of the hash of the octets of the ASCII representation of the access_token value the Access Token returned with the Token ID","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'at_hash' parameter in the Payload is checked. In particular, its value must match the base64url encoding of the left-most half of the hash of the octets of the ASCII representation of the access_token value the Access Token returned with the Token ID","Compliant if the ID Token's at_hash parameter value matches the Access Token returned with the Token ID, not Compliant otherwise",Token response,Does ID token payload contain a correct 'at_hash' parameter,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'at_hash' parameter in the Payload is checked. In particular, its value must match the base64url encoding of the left-most half of the hash of the octets of the ASCII representation of the access_token value the Access Token returned with the Token ID",OP,The JWT ID Token Payload requires the at_hash parameter and its value must match the Access Token returned with the Token ID. Its value is the base64url encoding of the left-most half of the hash of the octets of the ASCII representation of the access_token value,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the aud parameter,Authentication Request without the aud parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the aud parameter,The aud parameter identifies subjects of that request. An entity whose identifier is not in the audience of the request should refuse that request. In this test an authorization request is sent to the OP with an aud parameter that does not contains its identifier and the response of the OP is analyzed,OP,The JWT payload must contain the aud parameter and it must contain the OP's identifier (issuer parameter in OP's metadata),SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is JWT audience checked (HasAudienceClaim),,,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'aud' parameter in the Payload set to the RP's 'client_id'","Compliant if the ID Token has the aud parameter set to the RP's client ID, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'aud' parameter in the Payload set to RP's 'client_id',"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'aud' parameter in the Payload set to the RP's 'client_id'",OP,The JWT ID Token Payload requires the aud parameter and it must contain the RP's client_id,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the token audience set (HasCorrectAudience),ID Token has aud claim,,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the type of the 'exp' parameter in the Payload is checked. In particular, its value must be a timestamp","Compliant if the ID Token contains the exp claim and its value is a timestamp, not Compliant otherwise",Token response,Does the issued JWT ID Token contain a correct 'exp' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the type of the 'exp' parameter in the Payload is checked. In particular, its value must be a timestamp",OP,The JWT ID Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked. In particular, its value must be a timestamp","Compliant if the ID Token contains the iat claim and its value is a timestamp, not Compliant otherwise",Token response,Does the issued JWT ID Token contain a correct 'iat' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked. In particular, its value must be a timestamp",OP,The JWT ID Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Are all required required claims present (HasRequiredClaims),ID Token has iat claim,,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter has to be an HTTPS URL identifying the OP","Compliant if the ID Token contains the iss parameter as an HTTPS URL that identifies the OP, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'iss' parameter in the Payload as an HTTP URL,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter has to be an HTTPS URL identifying the OP",OP,The JWT ID Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the token issuer set (HasCorrectIssuer),ID Token has iss claim,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'iss' parameter is checked equals to the URL of the OP","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'iss' parameter is checked equals to the URL of the OP","Compliant if the ID Token contains the iss parameter equals to the URL of the OP, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'iss' parameter in the Payload equals to the URL of the OP,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the value of the 'iss' parameter is checked equals to the URL of the OP",OP,The JWT ID Token Payload requires the iss parameter and it must be equal to the URL of the OP,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked. In particular, its value must be set to the 'nonce' value set in the Authentication Request","Compliant if the ID Token contains the nonce claim and its value is the same as the nonce in the Authentication Request made before, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'nonce' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked. In particular, its value must be set to the 'nonce' value set in the Authentication Request",OP,The JWT ID Token Payload requires the nonce parameter and it must be set to the nonce value sent in the Authentication Request,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the nonce present in the ID token (NoncePresentInToken),ID Token has nonce when requested for code flow,,
OP-Token response-metadata-value,Token Response,Token request with grant_type set to refresh_token and a valid refresh_token ,"Compliant if the Token Response does not contain the ID Token, not compliant otherwise",Token response,Does the OP release ID Tokens with the use of refresh tokens,"In this test the offline access flow is accomplished and a refresh token is obtained. After this, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The response must not include the ID Token",OP,"The Refresh Token MUST NOT allow the requesting RP to obtain an ID Token, neither the one previously issued during authentication nor a new ID Token",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,This test verifies the presence of Pragma set to 'no-cache' in the token response.,Trigger This test verifies the presence of Pragma set to 'no-cache' in the token response.,"Compliant if the token response has Pragma set to 'no-cache', not Compliant otherwise",Token response,Does the token response have Pragma set to 'no-cache',This test verifies the presence of Pragma set to 'no-cache' in the token response.,OP,The error Token response must have Pragma set to 'no-cache',SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test an offline_access flow is performed and the obtained Refresh token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the Refresh token is passed to a signature verifier correctly configured",Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the signature of the Refresh token is correctly verified using the OP's public key, not compliant otherwise",Token response,Does the OP correctly sign the Refresh Token,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test an offline_access flow is performed and the obtained Refresh token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the Refresh token is passed to a signature verifier correctly configured",OP,The Refresh Token MUST be a signed JWT,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,Token Response,Authentication request with scope profile and prompt contains consent,"Compliant if the token response does not contain the refresh_token parameter, not Compliant otherwise",Token response,Does the OP issue refresh tokens even when it is not supposed to,"In this test an RP makes an authentication request with an arbitrary scope that differs from 'offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must not contain the refresh token.",OP,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access and prompt=consent)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,Token Response to a request with refresh token ,Token request with grant_type set to refresh_token and a refresh_token whose corresponding access_token was revoked,"Compliant if the OP sends a successful token response, not compliant otherwise",Token response,Does the OP revoke the Refresh Token when revoking an Access Token,"In order to test if the OP revokes a refresh token together with the access token revocation, a classic authentication flow is computed and, once obtained the access token and the refresh token, the access token is used to login. Finally, a logout is performed (thus revocating the access token), a token request using the refresh token is accomplished and the OP's response analyzed.",OP,The Access Token revocation MUST NOT imply revoking all the Refresh Tokens linked to it.,SPID_CIE_OIDC#revocation-endpoint; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html,OIDC Core,Are refresh tokens revoked after access token revocation (AccessRevokesRefresh),,"The OAuch outcome is in contrast with ours and with the one in the specification: for OAuch if the related refresh token is revoked, than this is compliant, in the CIE scenario it is not",
OP-Token response-metadata-value,Token Response to a request with an already-used refresh token ,Token request with offline_access grant type and an already-used refresh token in it,"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the OP invalidate already-used refresh tokens,"A Token Request with the grant_type=refresh_token and the refresh token in it is sent. Even if the response will contain a new access token and a new refresh token, the next step is trying to refresh again the access token with the already-used refresh token and analyze the response",OP,"For security reasons, an OP MUST return, along with a new Access Token, also a new Refresh Token, invalidating all previously issued tokens (refresh token rotation) to the RP and related to the end-user",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Is the active refresh token revoked after a multi-exchange (InvalidatedRefreshToken),,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,Trigger The Refresh Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,"Compliant if the JWT Refresh Token Payload has the aud parameter, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain the 'aud' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,OP,The Refresh Token MUST contain the aud parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload set to the identifier of the resource server,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload has the aud parameter set to the identifier of the intended resource server, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain correct 'aud' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload set to the identifier of the resource server,OP,The Refresh Token MUST contain the aud parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked,Trigger The Refresh Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked,"Compliant if the JWT Refresh Token Payload contains the exp parameter, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain correct 'exp' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked,OP,The Refresh Token MUST contain the exp parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the value of the 'exp' parameter in the Payload is a timestamp,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload contains the exp parameter which is a timestamp, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain correct type of 'exp' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the value of the 'exp' parameter in the Payload is a timestamp,OP,The Refresh Token MUST contain the exp parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked,Trigger The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked,"Compliant if the JWT Refresh Token Payload contains the iat claim, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain 'iat' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked,OP,The Refresh Token MUST contain the iat parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the claims parameter,Authentication Request without the claims parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the claims parameter,An Authentication Request is sent without the claims parameter in JWT and the response is analyzed,OP,The JWT payload must contain the claims parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong claims parameter,Authentication Request with a wrong claims parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a wrong claims parameter,In this test an authorization request is sent with a claims parameter in the JWT which contains not supported values and the response is analyzed,OP,The JWT payload must contain the claims parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the client_id parameter,Authentication request without the client_id parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the client_id parameter,"The 'client_id' parameter in an authentication request's JWT identifies the RP sending the request. In order to test if the OP checks this parameter, an authorization request is sent without the client_id in the JWT and the answer is analyzed",OP,The JWT payload must contain the client_id parameter and its value must be an HTTPS URL identifying the RP,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,Check error code in the test (is changed),
OP-Authentication response-metadata-value,Authentication Request's request parameter,Authentication Request with a wrong client_id parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP correctly reject an invalid client_id parameter in an intercepted Authentication Request,"This test aims to check if the OP checks the correctness of the client_id parameter. The client id value contained must contain an URL identifying the RP, so in this test the Authentication Request is intercepted, the request parameter is decrypted, the client_id in it modified with a random (and invalid) one, the JWT re-encrypted, the signature re-calculated and sent. The OP should check the parameter and, seen that it is an invalid one, refuse the authentication request.",OP,The JWT content of the request parameter in the Authentication Request must contain the 'client_id' parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,Not clear what the the client_id in the request must match and if it has to match something,
OP-Token response-metadata-value,"The Token error response is analyzed and the the error parameter in it is checked. It must have a value among 'invalid_request', 'invalid_client', 'unsupported_grant_type', 'invalid_grant', 'server_error', or 'temporarily_unavailable'","Trigger The Token error response is analyzed and the the error parameter in it is checked. It must have a value among 'invalid_request', 'invalid_client', 'unsupported_grant_type', 'invalid_grant', 'server_error', or 'temporarily_unavailable'","Compliant if the Token Response has the error parameter and it is set to a value among 'invalid_request', 'invalid_client', 'unsupported_grant_type', 'invalid_grant', 'server_error', or 'temporarily_unavailable'. Not Compliant otherwise",Token response,Does the Token error response contain a correct error parameter,"The Token error response is analyzed and the the error parameter in it is checked. It must have a value among 'invalid_request', 'invalid_client', 'unsupported_grant_type', 'invalid_grant', 'server_error', or 'temporarily_unavailable'",OP,"If the Token Request (both ID Token and Refresh Token) is invalid or unauthorized, the OP constructs the error response. This response needs to have the error parameter with the error code ('invalid_request' or 'unauthorized_client')",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,"The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked. In particular, its value must be a timestamp",Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload contains the iat claim and its value is a timestamp, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain 'iat' parameter in the Payload,"The Refresh Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked. In particular, its value must be a timestamp",OP,The Refresh Token MUST contain the iat parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Authentication response-metadata-value,"The Authentication error response is analyzed and error parameter in it is checked. It must have a value among 'invalid_request', 'unauthorized_client', 'access_denied', 'invalid_scope', 'server_error', 'temporarily_unavailable', 'unsupported_response_type', 'login_required', 'consent_required', 'request_uri_not_supported', 'registration_not_supported', or 'invalid_request_object'","Trigger The Authentication error response is analyzed and error parameter in it is checked. It must have a value among 'invalid_request', 'unauthorized_client', 'access_denied', 'invalid_scope', 'server_error', 'temporarily_unavailable', 'unsupported_response_type', 'login_required', 'consent_required', 'request_uri_not_supported', 'registration_not_supported', or 'invalid_request_object'","Compliant if the Authentication Response has the error parameter and it is set to a value among 'invalid_request', 'unauthorized_client', 'access_denied', 'invalid_scope', 'server_error', 'temporarily_unavailable', 'unsupported_response_type', 'login_required', 'consent_required', 'request_uri_not_supported', 'registration_not_supported', or 'invalid_request_object'. Not Compliant otherwise",Authentication response,Does the Authentication error response contain a correct error parameter,"The Authentication error response is analyzed and error parameter in it is checked. It must have a value among 'invalid_request', 'unauthorized_client', 'access_denied', 'invalid_scope', 'server_error', 'temporarily_unavailable', 'unsupported_response_type', 'login_required', 'consent_required', 'request_uri_not_supported', 'registration_not_supported', or 'invalid_request_object'",OP,"In case of errors, the response must contain the error and error_description parameters",SPID_CIE_OIDC#Authentication-Error-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#gestione-degli-errori,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked.,Trigger The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked.,"Compliant if the JWT Refresh Token Payload has the iss parameter, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain the 'iss' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked.,OP,The Refresh Token MUST contain the iss parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong code_challenge_method parameter,Authentication Request with wrong code_challenge_method parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a value of the code_challenge_method parameter wrong or not present in its metadata,"The 'code_challenge_method' parameter in the JWT of an authentication request says to the OP how to verify the code_challenge when receiving the token request. If one request has a wrong code_challenge_method, than the OP will not be able to verify this parameter. In order to test the OP's behavior, an Authenticaton request is sent with a wrong code_challenge_method (a method not present in the OP's metadata) and the answer is analyzed",OP,The JWT payload must contain the code_challenge_method parameter and its value must be in the code_challenge_methods_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the exp parameter,Authentication Request without the exp parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the exp parameter,An Authentication Request is sent without the exp parameter in JWT and the response is analyzed,OP,The JWT payload must contain the exp parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong exp parameter,Authentication Request with wrong exp parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a wrong exp parameter,In this test an authorization request with the exp parameter expired in the JWT is sent and the response analyzed.,OP,The JWT payload must contain the exp parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is JWT expiration checked (IsExpirationChecked),,,
OP-Authentication response-metadata-value,Authentication Response to a request without the iat parameter,Authentication Request without the iat parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the iat parameter,An Authentication Request is sent without the iat parameter in JWT and the response is analyzed,OP,The JWT payload must contain the iat parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is JWT 'issued at' checked (IsIssuedAtChecked),,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong iat parameter,Authentication Request with wrong iat parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a wrong iat parameter,In this test an authorization request with the iat parameter in the JWT set after the current time is sent and the response analyzed.,OP,The JWT payload must contain the iat parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the iss parameter,Authentication Request without the iss parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the iss parameter,An Authentication Request is sent without the iss parameter in JWT and the response is analyzed,OP,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is JWT issuer checked (HasIssuerClaim),,,
OP-Authentication response-metadata-value,Authentication Response to a request without the OP's identifier in the aud parameter,Authentication Request without the OP's identifier in the aud parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with an aud parameter that does not contain its identifier,The aud parameter identifies subjects of that request. An entity whose identifier is not in the audience of the request should refuse that request. In this test an authorization request is sent to the OP with an aud parameter in the JWT that does not contains its identifier and the response of the OP is analyzed,OP,The JWT payload must contain the aud parameter and it must contain the OP's identifier (issuer parameter in OP's metadata),SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong iss parameter,Authentication Request with a wrong iss parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a wrong iss parameter,"The 'iss' parameter in the JWT of an authentication request says who sent the request. If one request has a wrong iss, than it could be forwarded by a malicious user, so the iss must be checked. In order to test this behavior in the OP, an Authenticaton request is sent with a wrong iss (not the RP's client id) and the answer is analyzed",OP,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the nonce parameter,Authentication request without the nonce parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the nonce parameter,"If the nonce in the request is missing, than a control about the freshness of the request/response is missing. In this test an authorization request without the nonce parameter in the JWT is sent and the response analyzed.",OP,The JWT payload must contain the nonce parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is the nonce parameter required (NonceRequired),,,
OP-Authentication response-metadata-value,Authentication Response to a request with a nonce parameter shorter than 32 alphanumeric characters,Authentication Request with a nonce parameter shorter than 32 alphanumeric characters in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a nonce parameter shorter than 32 alphanumeric characters,In this test an authorization request with a nonce parameter in the JWT of a length less than 32 alphanumeric characters is sent and the response analyzed.,OP,The JWT payload must contain the nonce parameter. It must be a casual string with at least 32 alphanumeric characters.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the prompt parameter,Authentication Request without the prompt parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the prompt parameter,An Authenticaton request is sent without the prompt parameter in the JWT and the response is analyzed,OP,The JWT payload must contain the prompt parameter and its value must be 'consent' or 'consent login',SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong prompt parameter,Authentication Request with a wrong prompt parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a wrong prompt parameter,An Authenticaton request is sent with a wrong prompt parameter in the JWT (a value different from 'consent' and 'consent login') and the answer is analyzed,OP,The JWT payload must contain the prompt parameter and its value must be 'consent' or 'consent login',SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the redirect_uri parameter,Authentication Request without the redirect_uri parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the redirect_uri parameter,An Authentication Request is sent without the redirect_uri parameter in JWT and the response is analyzed,OP,The JWT payload must contain the redirect_uri parameter and its value must be contained in the redirect_uris parameter of the RP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,Reject request without redirect_uri when multiple registered,I heard that sometimes it is not always checked because the address in the RP metadata is checked,
OP-Authentication response-metadata-value,Authentication Request's request parameter,Authentication Request with a wrong redirect_uri parameter in the JWT in the request parameter,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Request with a wrong redirect URI,"Once received an Authentication Request, an OP must check if the provided redirect URI matches one of the redirect uris in the RP metadata. To verify this behavior, an authentication request is sent to the OP with a wrong redirect URI in the JWT in the request parameter ",OP,The redirect_uri parameter in the Authentication Request must match one of the URLs given in the RP Metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,"Does the authorization server automatically redirect the user-agent to the invalid redirection URI (InvalidRedirect), Does the authorization server exactly match the full redirect uri (RedirectUriFullyMatched)","Reject redirect_uri not matching a registered redirect_uri, Reject redirect_uri when query parameter added, Reject redirect_uri when query parameter does not match",,
OP-Authentication response-metadata-value,Authentication Response to a request without the response_type parameter,Authentication Request without the response_type parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the response_type parameter,An Authentication Request is sent without the response_type parameter in JWT and the response is analyzed,OP,The JWT payload must contain the response_type parameter and its value must be contained in the response_types_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,Reject request without response_type,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong response_type parameter,Authentication Request with wrong response_type parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of unsupported_response_type, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a value of the response_type parameter wrong or not present in its metadata,"An Authentication Request is sent with a response_type parameter in the JWT wrong or not present in the RP's metadata. If the OP refuses the request, than it checks the parameter, otherwise it is not checking it.",OP,The JWT payload must contain the response_type parameter and its value must be contained in the response_types_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Does the authorization server check the response type (IsResponseTypeChecked),,,
OP-Authentication response-metadata-value,Authentication Response to a request without the scope parameter,Authentication Request without the scope parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the scope parameter,An Authentication Request is sent without the scope parameter in JWT and the response is analyzed,OP,The JWT payload must contain the scope parameter and its value must be contained in the scopes_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with wrong scope parameter,Authentication Request with wrong scope parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_scope, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a value of the scope parameter wrong or not present in its metadata,"The scope parameter is used by the OP to check which claims to send in the ID Token and/or at the Introspection endpoint. The allowed values are openid, offline_access, profile and email (and combination of them), different values must trigger an error response. So in this test a request with a wrong scope parameter in the JWT is sent and the response analyzed",OP,The JWT payload must contain the scope parameter and its value must be contained in the scopes_supported parameter of the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the state parameter,Authentication request without the state parameter in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the state parameter,"The state parameter identifies the session in the RP side, if this value is missing, than no control about the session is done. In this test an authorization request without the state parameter in the JWT is sent and the response analyzed.",OP,The JWT payload must contain the state parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with a state parameter shorter than 32 alphanumeric characters,Authentication Request with a state parameter shorter than 32 alphanumeric characters in the JWT,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests with a state parameter shorter than 32 alphanumeric characters,In this test an authorization request with a state parameter in the JWT of a length less than 32 alphanumeric characters is sent and the response analyzed.,OP,The JWT payload must contain the state parameter. It must be a casual string with at least 32 alphanumeric characters.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request with the request parameter with a wrong signature,Authentication Request with the request parameter with a wrong signature in the URL,"Compliant if the Authentication response is an HTTP 302 because of unauthorized_client, not compliant otherwise",Authentication response,Does the OP refuse wrongly signed Authentication Requests,"This test aims to check if the OP correctly handles the signature of the Authentication request: once received the request, the JWT token must be split in its 3 parts (header, payload, signature), base64url decoded and the signature must be verified. In order to test if the OP really checks the signature, the Authentication request is intercepted before arriving to the OP and the signature is changed. If the OP grants the tokens anyway, than it did not check the signature.",OP,"The Authorization request is initiated by the user that selects the OP for the authentication. The RP redirects the user to the Authorization Endpoint of the selected OP, including in the request the parameter request that is a signed JWT containing the Authorization Request.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,Is the JWT signature checked (IsSignatureChecked),,,
OP-Token response-metadata-value,"The Access Token present in the Token Response is analyzed and the 'scope' parameter in the Payload is checked, in particular, its value MUST match the value in the authentication request.","Trigger The Access Token present in the Token Response is analyzed and the 'scope' parameter in the Payload is checked, in particular, its value MUST match the value in the authentication request.","Compliant if the scope parameter value in the JWT Access Token Payload matches the value in the authentication request, not Compliant otherwise",Token response,Does the issued JWT Access Token contain a correct 'scope' parameter in the Payload,"The Access Token present in the Token Response is analyzed and the 'scope' parameter in the Payload is checked, in particular, its value MUST match the value in the authentication request.",OP,The JWT Access Token Payload requires the scope parameter. It MUST match the value in the authentication request.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication Response to a request without the scope parameter in the URL,Authentication Request without the scope parameter in the URL,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse Authentication Requests without the scope parameter in the URL,An Authentication Request is sent without the iss parameter in the URL of the request (scope in the HTTP request),OP,"The parameter scope MUST be sent both as a parameter in the HTTP request, and inside the request object. The two values MUST be the same.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,Scope openid present in all requests,,
SA-Entity Statement response OP-metadata-value,"This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA","Trigger This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA","Compliant if the client assertion JWT contains the iss claim and it is set to the client ID of the SA sending the Entity Statement, not Compliant otherwise",Entity Statement response OP,Does the Entity Statement's JWT payload contain a correct 'iss' claim,"This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA",SA,The iss parameter is required in the Entity Statement released by the SA. Its value must be the Entity Identifier of the issuer of the statement,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA","Trigger This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA","Compliant if the client assertion JWT contains the iss claim and it is set to the client ID of the SA sending the Entity Statement, not Compliant otherwise",Entity Statement response RP,Does the Entity Statement's JWT payload contain a correct 'iss' claim,"This test can be performed by taking the JWT present in the Entity Statement Response, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the SA",SA,The iss parameter is required in the Entity Statement released by the SA. Its value must be the Entity Identifier of the issuer of the statement,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL","Compliant if the iss claim is an URL identifying the TA, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL",TA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL","Compliant if the iss claim is an URL identifying the TA, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the iss claim has to be an URL",TA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
RP-Authentication request-metadata-value,"In this test the request parameter of the Authentication Request is taken, the payload decrypted and the value of the 'client_id' parameter correspond to the one that can be found in the EC of the RP","Trigger In this test the request parameter of the Authentication Request is taken, the payload decrypted and the value of the 'client_id' parameter correspond to the one that can be found in the EC of the RP","Compliant if the JWT in the request parameter contains the 'client_id' parameter identifying the RP, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'client_id' parameter identifying the RP,"In this test the request parameter of the Authentication Request is taken, the payload decrypted and the value of the 'client_id' parameter correspond to the one that can be found in the EC of the RP",RP,The JWT content of the request parameter in the Authentication Request must contain the 'client_id' parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'iss' parameter has to be the client_id of the RP. If it is another value or is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'iss' parameter has to be the client_id of the RP. If it is another value or is missing, than the RP is not compliant with the specifications","Compliant if the iss parameter corresponds to the RP's client_id, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'iss' parameter set to the RP's client_id,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'iss' parameter has to be the client_id of the RP. If it is another value or is missing, than the RP is not compliant with the specifications",RP,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'redirect_uri' parameter matches one of the URLs given in the RP metadata.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'redirect_uri' parameter matches one of the URLs given in the RP metadata.","Compliant if the redirect_uri parameter value matches one of the URLs given in the RP metadata, not compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'redirect_uri' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'redirect_uri' parameter matches one of the URLs given in the RP metadata.",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'redirect_uri' parameter. It must match one of the URLs given in the RP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked. This parameter's value must be the same of the 'response_types_supported' parameter in the OP metadata","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked. This parameter's value must be the same of the 'response_types_supported' parameter in the OP metadata","Compliant if the response_type parameter is present and equal to the 'response_types_supported' parameter in the OP metadata, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain a correct 'response_type' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked. This parameter's value must be the same of the 'response_types_supported' parameter in the OP metadata",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'response_type' parameter and it must contain the value in 'response_types_supported' parameter of the OP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication response,Entity Configuration response with wrong authority hints,"Compliant if the Authentication response is an HTTP 302 error and because of invalid_client, not compliant otherwise",Authentication response,Does the OP correctly validate the trust chain of an RP authentication request,"When an OP receives an authentication request, it must proceed with an Entity Configuration request toward the RP. The received Entity Configuration must be verified through the Entity Statement released by a parent entity of the RP and this process must be repeated until the Trust Anchor. In order to verify if the OP validates this trust chain, the authority_hints in the Entity Configuration of the RP could contain wrong values. If the OP validates the request anyway, it is not compliant with the specification",OP,"If the Provider successfully validates at least a Trust Mark for the RP profile contained inside the configuration of the requesting RP, it extracts the superior Entities from the claim authority_hints and starts the Federation Entity Discovery process until the Trust Chain calculation and the achievement of the final Metadata.",SPID_CIE_OIDC#Metadata-Retrieval-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#openid-provider,OIDC Federation,,,,
OP-Authentication response-metadata-value,"In this test the RP sends an authentication request to the OP, which will ask for the RP's Entity Configuration. The RP must send an Entity Configuration without trusted Trust Marks (Trust Marks issued by an entity not present in the Federation Configuration or no Trust Marks) and if the OP's response is analyzed",Entity Configuration response with trust marks not trusted,"Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse an RP without trusted Trust Marks,"In this test the RP sends an authentication request to the OP, which will ask for the RP's Entity Configuration. The RP must send an Entity Configuration without trusted Trust Marks (Trust Marks issued by an entity not present in the Federation Configuration or no Trust Marks) and if the OP's response is analyzed",OP,"If the RP configuration does not expose any Trust Mark that is recognizable by the RP profile, the Provider MUST refuse the authorization with an error message",SPID_CIE_OIDC#Metadata-Retrieval-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#openid-provider,OIDC Federation,,,,
OP-Introspection response-metadata-value,Introspection response to a request without the client assertion type,Introspection request without the client_assertion_type type parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP accept introspection requests without the client assertion type,An introspection request without the client_assertion_type parameter is sent and the response analyzed,OP,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a wrong client assertion type (not set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer),Introspection request with a wrong client_assertion_type parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP accept introspection requests with a wrong client assertion type,An introspection request with a wrong value in the client_assertion_type parameter is sent and the response analyzed,OP,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection response-metadata-value,Introspection response to a request without the client assertion,Introspection request without the client assertion JWT in the client_assertion parameter,"Compliant if the Introspection response is an HTTP 401 because of invalid_client, not compliant otherwise",Introspection response,Does the OP accept introspection requests without the client assertion,A request to the introspection endpoint is made without the client assertion in it. The OP's response is analyzed,RP,The request to the Introspection Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with wrong signature,Introspection request with a client assertion in the body with wrong signature,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the signature of the client assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the signature of it in order to make it wrong. If the OP Accepts the request anyway, than it does not verify the signature of the assertion.",OP,"The OP must test the validity of all the fields that are present in the JWT contained in the client assertion, plus the validity of its signature, with respect to the parameter client_id",SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection Response to a Request without the client id,Introspection request without the client_id parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_client, not compliant otherwise",Introspection response,Does the OP accept introspection requests without the client id,"To test if an OP verifies the presence of the client id of the RP in the Introspection request, a request without the client id is sent and the response is analyzed.",OP,The OP must check that the client_id in the Introspection Request is known inside the Federation.,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection Response to a Request with a wrong client id,Introspection request with a wrong the client_id parameter in the body,"Compliant if the Introspection response is an HTTP 401 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the client id of the Introspection Request,"To test if an OP verifies the presence of the client id of the RP in the Introspection request, a request with a wrong client id (not present in the federation) is sent and the response is analyzed.",OP,The OP must check that the client_id in the Introspection Request is known inside the Federation.,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with emtpy aud,Introspection request with a client assertion without the aud parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the presence of aud of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the aud parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with empty exp,Introspection request with a client assertion without the exp parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the presence of exp of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the exp parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with wrong value of exp,Introspection request with a client assertion with a wrong value of exp,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the value of exp of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the exp of it in order to make it wrong",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with emtpy iat,Introspection request with a client assertion without the iat parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the presence of iat of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the iat parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with wrong value of iat,Introspection request with a client assertion with a wrong value of iat,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the value of iat of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the iat of it in order to make it wrong",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the value of the 'iss' parameter is an HTTPS URL.,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the iss parameter in the JWT Refresh Token Payload contains an HTTPS URL identifying the OP, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain correct 'iss' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the value of the 'iss' parameter is an HTTPS URL.,OP,The Refresh Token MUST contain the iss parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion without the iss parameter,Introspection request with a client assertion without the iss parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the presence of iss of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the iss parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with emtpy jti,Introspection request with a client assertion without the jti parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the presence of jti of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the jti parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with emtpy sub,Introspection request with a client assertion without the sub parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the presence of sub of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and remove the sub parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with wrong value of sub,Introspection request with a client assertion with value of sub different to the one in the iss parameter,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the value of iss of the client_assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the sub to make it different from the iss parameter",OP,The OP must test the validity of all the fields that are present in the JWT contained in the client assertion,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a client assertion with wrong parameters in the JWT,Introspection request with a client assertion with a wrong parameter in the JWT,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,Does the OP verify the parameters of the client assertion in the Introspection request,"Since the OP has to verify the client assertion in the Introspection Request, this test consist in sending a request with a wrong the parameter in the JWT present in the client_assertion parameter of the request and adapt the signature to make it correct. If the OP accepts the request anyway, then it does not verify the JWT.",OP,"The OP must test the validity of all the fields that are present in the JWT contained in the client assertion, plus the validity of its signature, with respect to the parameter client_id",SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request without the token,Introspection request without the token parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,How does the OP behave when receiving an introspection request without the token,An introspection request without a token is sent and the introspection response analyzed,OP,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection response to a request with a token not valid,Introspection request with a wrong the token parameter in the body,"Compliant if the Introspection response is an HTTP 400 because of invalid_request, not compliant otherwise",Introspection response,How does the OP behave when receiving an introspection request with a wrong token,An introspection request with a token not valid is sent and the introspection response analyzed,OP,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a Request without the client client_assertion_type parameter,Revocation request without the client_assertion_type parameter in the body ,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Revocation response,Does the OP accept Revocation Requests without the client assertion type,"To test if an OP verifies the presence of the client assertion type in the Revocation request, a request withiout client assertion type is sent and the response is analyzed.",OP,The OP must check that the client_assertion_type value in the Revocation Request is 'urn:ietf:params:oauth:clientassertion-type:jwt-bearer',SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a Request with a wrong client_assertion_type parameter,Revocation Request with a wrong client_assertion_type parameter in the body,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Revocation response,Does the OP verify the client assertion type of the Revocation Request,"To test if an OP verifies the client assertion type in the Revocation request, a request with a wrong client_assertion_type parameter is sent and the response is analyzed.",OP,The OP must check that the client_assertion_type value in the Revocation Request is 'urn:ietf:params:oauth:clientassertion-type:jwt-bearer',SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation Response to a request without the client assertion,Revocation request without the client_assertion parameter in the body ,"Compliant if the Revocation response is an HTTP 400 because of invalid_client, not compliant otherwise",Revocation response,Does the OP accept revocation request without the client assertion,"In order to verify if the OP checks the presence of the client_assertion parameter in a revocation request, such a request is sent without the client_assertion and the OP's response is analyzed",OP,"The revocation request must contain the client_assertion parameter and the OP must check the validity of all the fields in the JWT, and the validity of its signature, according to the parameter client_id.",SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Revocation request-metadata-value,"Since the OP has to verify the client assertion in the Revocation Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the signature of it in order to make it wrong. If the OP Accepts the request anyway, than it does not verify the signature of the assertion.",Revocation Request with a client assertion in the body with a wrong signature,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Revocation request,Does the OP verify the signature of the client assertion in the Revocation request,"Since the OP has to verify the client assertion in the Revocation Request, this test consist in intercepting a legitimate request, take the JWT of the client assertion and modify the signature of it in order to make it wrong. If the OP Accepts the request anyway, than it does not verify the signature of the assertion.",OP,"The OP must test the validity of all the fields that are present in the JWT contained in the client assertion, plus the validity of its signature, with respect to the parameter client_id",SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request without aud in client_assertion,Revocation request without aud in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests without the aud parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the aud parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert aud in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request with wrong aud in client_assertion,Revocation request with wrong aud in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests with a wrong aud parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong aud parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert aud in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request without exp in client_assertion,Revocation request without exp in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests without the exp parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the exp parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert exp in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request with wrong exp in client_assertion,Revocation request with wrong exp in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests with a wrong exp parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong exp parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert exp in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request without iat in client_assertion,Revocation request without iat in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests without the iat parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the iat parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert iat in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request with wrong iat in client_assertion,Revocation request with wrong iat in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests with a wrong iat parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong iat parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert iat in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request without iss in client_assertion,Revocation request without iss in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests without the iss parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the iss parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert iss in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request with wrong iss in client_assertion,Revocation request with wrong iss in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests with a wrong iss parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong iss parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert iss in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request without jti in client_assertion,Revocation request without jti in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests without the jti parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the jti parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert jti in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request without sub in client_assertion,Revocation request without sub in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests without the sub parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) without the sub parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert sub in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a request with wrong sub in client_assertion,Revocation request with wrong sub in client_assertion,Compliant if the revocation response is an HTTP 400 because invalid_request. Not Compliant otherwise,Revocation response,Does the OP refuse revocation requests with a wrong sub parameter in the client_assertion,A revocation request is made with a client_assetion parameter (JWT) with a wrong sub parameter in it. The response is analyzed; the OP should refuse it,OP,An RP doing a Revocation Request must insert sub in the client_assertion,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation response to a Request without the client id,Revocation request without the client_id parameter in the body ,"Compliant if the Revocation response is an HTTP 401 because of invalid_client, not compliant otherwise",Revocation response,Does the OP accept Revocation Requests without the client id,"To test if an OP verifies the presence of the client id of the RP in the Revocation request, a request without the client id is sent and the response is analyzed.",OP,The OP must check that the client_id in the Revocation Request is known inside the Federation.,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,Trigger The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,"Compliant if the client_id parameter is the correct client URI, not compliant otherwise",Revocation request,Does the Revocation Request contain correct client_id of the RP making the request,The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,RP,The request to the Revocation Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Is revocation bound to a specific client (IsBoundToClient),,,
OP-Revocation response-metadata-value,Revocation response to a Request with a wrong client id,Revocation Request with a wrong client_id parameter in the body,"Compliant if the Revocation response is an HTTP 401 because of invalid_client, not compliant otherwise",Revocation response,Does the OP verify the client id of the Revocation Request,"To test if an OP verifies the presence of the client id of the RP in the Revocation request, a request with a wrong client id (not present in the federation) is sent and the response is analyzed.",OP,The OP must check that the client_id in the Revocation Request is known inside the Federation.,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked equal to the URL of the OP,Trigger The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked equal to the URL of the OP,"Compliant if the JWT Refresh Token Payload has the iss parameter equal to the URL of the OP, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain the 'iss' parameter in the Payload equal to the URL of the OP,The Refresh Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked equal to the URL of the OP,OP,The Refresh Token MUST contain the iss parameter equal to the URL of the OP,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked,Trigger The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked,"Compliant if the JWT Refresh Token Payload contains the jti parameter, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain 'jti' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked,OP,The Refresh Token MUST contain the jti parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked. Its value (unique identifier of Refresh Token) must be based on uuid4 format,Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the JWT Refresh Token Payload contains the jti parameter and it is in uuid4 format, not Compliant otherwise",Token response,Does the issued JWT Refresh Token contain a correct 'jti' parameter in the Payload,The Refresh Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked. Its value (unique identifier of Refresh Token) must be based on uuid4 format,OP,The Refresh Token MUST contain the jti parameter,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Revocation request-metadata-value,"Since the OP has to verify the client assertion in the Revocation Request, this test consist in intercepting a legitimate request and remove token.",Trigger Revocation Request without token,"Compliant if the Revocation response is an HTTP 400 because of invalid_request, not compliant otherwise",Revocation request,Does the OP verify the presence of token in the Revocation request,"Since the OP has to verify the client assertion in the Revocation Request, this test consist in intercepting a legitimate request and remove token.",OP,The OP must test the validity of all the fields that are present in the revocation request,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
OP-Revocation response-metadata-value,Revocation Response to a Request containing a non-existing access token,Revocation request with a non-existing token,"Compliant if the response is an HTTP 200 OK response, not compliant otherwise",Revocation response,Does the OP's revocation endpoint answer correctly when a non-existing token is provided,A request to the Revocation endpoint containing a non-existing token is sent and the response analyzed,OP,"The Revocation Endpoint answers with a code HTTP 200, also though the indicated token does not exist or has already been revoked (so that non information is going to be released)",SPID_CIE_OIDC#Revocation-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request without the client_assertion_type parameter,Token request without the client_assertion_type parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made without the client_assertion_type parameter return a Token Error response,This test consists in sending a token request without the client_assertion_type parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with a wrong client_assertion_type parameter,Token request with a wrong client_assertion_type parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with an incorrect client_assertion_type parameter return a Token Error response,This test consists in sending a token request with a wrong client_assertion_type parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request without the client_assertion,Token request without the client_assertion parameter in the body,"Compliant if the Token response is an HTTP 401 because of invalid_client, not compliant otherwise",Token response,Does the token response to a token request made without the client_assertion parameter return a Token Error response,This test consists in sending a token request without the client_assertion parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the client_assertion parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Is JWT authentication implemented (SupportsJwtClientAuthentication),,,
OP-Token response-metadata-value,"In this test an RP makes an authentication request with scope 'offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the refresh token.",Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the token response has the refresh_token parameter, not Compliant otherwise",Token response,Does the OP issue the refresh tokens when requested,"In this test an RP makes an authentication request with scope 'offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the refresh token.",OP,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Are refresh tokens supported (HasRefreshTokens),,,
OP-Token response-metadata-value,"In this test an RP makes an authentication request with scope 'openid offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain a JWT refresh token.",Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the refresh_token is a JWT, not Compliant otherwise",Token response,Does the OP issue a correct type of refresh tokens when requested,"In this test an RP makes an authentication request with scope 'openid offline_access'. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain a JWT refresh token.",OP,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Are refresh tokens supported (HasRefreshTokens),,,
OP-Token response-metadata-value,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the sub claim is missing,Token request with a client assertion without sub claim,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion field not containing sub claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the sub claim is missing,OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the aud claim does not contain the OP's Token endpoint,Token request with a client assertion without the URL of the OP's token endpoint in the aud claim,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong aud claim not containing the OP's Token endpoint in JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the aud claim does not contain the OP's Token endpoint,OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the aud claim. This claim must be set to the URL of the OP’s Token Endpoint.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,"In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular, the exp claim is wrong",Token request with a client assertion with an expiration time (exp) set before the request,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong exp claim in the JWT return a Token Error response,"In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular, the exp claim is wrong",OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the exp claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,"In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular, the iat claim is wrong",Token request with a client assertion with an issued time (iat) set after the request,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong iat claim in the JWT return a Token Error response,"In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular, the iat claim is wrong",OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iat claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the sub claim. Its value must be the same of the iss value","Compliant if the client assertion JWT contains the sub claim and it is set to the same value of the iss claim, not Compliant otherwise",Token request,Does the JWT payload contain a correct sub claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the sub claim. Its value must be the same of the iss value",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the same value of iss",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the iss claim is missing.,Token request with a client assertion without iss claim,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter not containing iss claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the iss claim is missing.,OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the RP","Compliant if the client assertion JWT contains the iss claim and it is set to the client ID of the RP making the request, not Compliant otherwise",Token request,Does the JWT payload contain a correct 'iss' claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the iss claim. Its value must be an URL identifying the RP",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the iss claim is not set to the RP's client ID,Token request with a client assertion with the iss claim not set to the RP's client ID,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong iss claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the iss claim is not set to the RP's client ID,OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the sub claim is not set to the RP's client ID,Token request with a client assertion with sub claim not set to the RP's client ID,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter containing a wrong sub claim in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the sub claim is not set to the RP's client ID,OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with a client assertion signed with a wrong key,Token Request with the client_assertion parameter in the url being a JWT with a wrongly signed signature,"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the OP's token endpoint refuse assertions signed with a wrong key,"In this test a classic flow is accomplished and, when exchanging the code for an access token, the signature is done with a wrong key. The OP's response is analyzed",OP,The client assertion parameter is a JWT signed with the Relying Party's private key,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with a client_assertion with a wrong signature,Token request with a client_assertion parameter in the body with a wrong signature,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a wrong signature return a Token Error response,"In this test a classic flow is accomplished and, when exchanging the code for an access token, the client_assertion parameter is taken and the signature is substitute with a wrong one. The OP's response is analyzed",OP,The client assertion parameter is a JWT signed with the Relying Party's private key,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,In this test the client_id parameter in the URL of the token request is removed and the response analyzed,Token request without the client_id parameter in the URL,"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the OP check the client_id in the request,In this test the client_id parameter in the URL of the token request is removed and the response analyzed,OP,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request without the client_id parameter,Token request without the client_id parameter in the body,"Compliant if the Token response is an HTTP 401 because of invalid_client, not compliant otherwise",Token response,Does the OP require the client_id in the token request,This test consists in sending a token request without the client_id parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the client_id parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Is client id required (IsClientIdRequired),,,
OP-Token response-metadata-value,Token response request without the code_verifier parameter,Token request without the code_verifier parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_grant, not compliant otherwise",Token response,Does the token response to a token request made without the code_verifier parameter return a Token Error response,This test consists in sending a token request without the code_verifier parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the code_verifier parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with a wrong code_verifier parameter,Token request with a wrong code_verifier parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with an incorrect code_verifier parameter return a Token Error response,This test consists in sending a token request with a wrong code_verifier parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the code_verifier parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request without the code parameter,Token request without the code parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_grant, not compliant otherwise",Token response,Does the token response to a token request made without the code parameter return a Token Error response,This test consists in sending a token request without the code parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the code parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with a wrong code parameter,Token request with a wrong code parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_grant, not compliant otherwise",Token response,"Does the token response to a token request made with an incorrect code parameter (i.e., not belonging to that client ID or a random code) return a Token Error response",This test consists in sending a token request with a wrong code parameter (thus not for that client ID or a random code) and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the code parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,Is the authorization code bound to the client (IsCodeBoundToClient),,Is it bound or not?,
OP-Token response-metadata-value,Token response to a request without the grant_type parameter,Token request without the grant_type parameter in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made without the grant_type parameter return a Token Error response,This test consists in sending a token request without the grant_type parameter and analyzing the token response. The response must be a Token Error response.,OP,An RP doing a Token Request must insert the grant_type parameter in the request with the value 'authorization_code',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Token response-metadata-value,Token response to a request with a wrong grant_type parameter,Token request with the grant_type parameter in the body set to example,"Compliant if the Token response is an HTTP 400 because of unsupported_grant_type, not compliant otherwise",Token response,Does the OP checks that the token request contains the grant_type parameter set correctly,"In order to validate if the OP checks the token request sent by the RP, in this test we send the grant_type parameter in the request set to and invalid value, just like 'example' and analyze the response",OP,"An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code', than it must contain the code and the code_verifier",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,UserInfo response to a request without the Token,UserInfo request without the Token in Authorization parameter in the head,"Compliant if the Userinfo response is an HTTP 400 because of invalid_request, not compliant otherwise",Userinfo response,How does the OP behave when the token in the userinfo request is missing,A userinfo request without the 'Authorization: Bearer ...' field is made and the response analyzed,OP,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter","Compliant if the OP redirects the client to the redirect_uri and contains the state parameter in the query parameters, not compliant otherwise",Authentication response,Does the OP contain correct state parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'state' as query parameter",OP,If the authentication is successful the OpenID Provider (OP) redirects the user by adding state parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked","Compliant if the alg parameter in the Access Token Header is present, not compliant otherwise",Token response,Does the issued JWT Access Token contain the 'alg' parameter in the Header,"In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,The JWT Access Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,Not present in the description but present in the example. I assumed the signature values,
OP-Token response-metadata-value,Token response,"Trigger In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be a supported asymmetric algorithm between ['RS256', 'RS512']","Compliant if the alg parameter in the Access Token Header contains a value among RS256 and RS512, not compliant otherwise ",Token response,Does the issued JWT Access Token contain a correct 'alg' parameter in the Header,"In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be a supported asymmetric algorithm between ['RS256', 'RS512']",OP,The JWT Access Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Access Token is not compliant.","Compliant if the alg parameter in the Access Token Header contains a value among RS256 and RS512, not Compliant if it contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",Token response,Does the issued JWT Access Token contain a wrong 'alg' parameter in the Header,"In this test, the Access Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Access Token is not compliant.",OP,The JWT Access Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked","Compliant if the ID Token Header has the alg parameter, not compliant otherwise",Token response,Does the issued JWT ID Token contain a correct 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the ID Token is not compliant.","Not compliant if the alg parameter in the ID Token contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",Token response,Does the issued JWT ID Token contain a wrong 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the ID Token is not compliant.",OP,The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Userinfo response-metadata-value,The UserInfo response is taken and the presence of a signed and encrypted JWE in the body of the response is checked.,Trigger The UserInfo response is taken and the presence of a signed and encrypted JWE in the body of the response is checked.,"Compliant if the response contains a signed and encrypted JWT, not compliant otherwise",Userinfo response,Does the UserInfo Endpoint create a signed and encrypted JWT,The UserInfo response is taken and the presence of a signed and encrypted JWE in the body of the response is checked.,OP,The content of the Response body MUST be a signed and encrypted JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,Must understand how to check encryption of the JWT,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter","Compliant if the OP redirects the client to the redirect_uri and adds the code parameter in the query parameters, not compliant otherwise",Authentication response,Does the OP correctly contain the code parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter",OP,If the authentication is successful the OpenID Provider (OP) redirects the user by adding code parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,Is at least one grant type supported (HasSupportedFlows),Can make request with code response_type,,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter and it must be a UUID.","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter and it must be a UUID.","Compliant if the OP redirects the client to the redirect_uri and adds the code parameter in the query parameters as a UUID, not compliant otherwise",Authentication response,Does the OP contain the correct type of code parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'code' as query parameter and it must be a UUID.",OP,If the authentication is successful the OpenID Provider (OP) redirects the user by adding code parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
OP-Authentication response-metadata-value,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter","Trigger In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter","Compliant if the OP redirects the client to the redirect_uri and adds the iss parameter in the query parameters, not compliant otherwise",Authentication response,Does the OP contain iss parameter on redirect in a successful authentication,"In order to check if the OP correctly handles a successful authentication request, a correct request is sent by a client and the behavior of the OP is analyzed. In particular, the client must be redirected to its redirect_uri and the redirect must have 'iss' as query parameter",OP,If the authentication is successful the OpenID Provider (OP) redirects the user by adding iss parameter required as query parameters to the redirect_uri,SPID_CIE_OIDC#Authorization-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,The Token response is analyzed and the presence of the access token is checked,Trigger The Token response is analyzed and the presence of the access token is checked,"Compliant if the token response has the access_token parameter, not Compliant otherwise",Token response,Does the successful token response contain access token,The Token response is analyzed and the presence of the access token is checked,OP,"If the Token request is correct, the succesful response sent by the OP must contain the access_token parameter, containing the issued access token",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Are access token supported (HasAccessTokens) Are JWT access token used (HasJwtAccessTokens),,,
OP-Token response-metadata-value,The RP receiving the Token response and that sent a correct token request must check the presence of the ID token,Trigger The RP receiving the Token response and that sent a correct token request must check the presence of the ID token,"Compliant if the token response has the id_token parameter containing a value in JWT format, not Compliant otherwise",Token response,Does the successful token response contain the ID token,The RP receiving the Token response and that sent a correct token request must check the presence of the ID token,OP,"If the authorization request is correct, the succesfull response sent by the OP must contain the id_token parameter, containing the ID Token value in JWT format",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,The RP receiving the Token response and that sent a correct token request must check the presence of the token type,Trigger The RP receiving the Token response and that sent a correct token request must check the presence of the token type,"Compliant if the token response has the token_type parameter, not Compliant otherwise",Token response,Does the successful token response contain the token type,The RP receiving the Token response and that sent a correct token request must check the presence of the token type,OP,"If the authorization request is correct, the succesfull response sent by the OP must contain the token_type parameter set to 'Bearer'",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken and the presence of the 'code_challenge' parameter is checked. If it is present, than the Authentication Request is using PKCE and is compliant with the specifications, otherwise it is not compliant.","Trigger The Authentication request is taken and the presence of the 'code_challenge' parameter is checked. If it is present, than the Authentication Request is using PKCE and is compliant with the specifications, otherwise it is not compliant.","Compliant if code_challenge is present, not Compliant if it is not",Authentication request,Does the RP's Authentication Request contain the 'code_challenge' parameter,"The Authentication request is taken and the presence of the 'code_challenge' parameter is checked. If it is present, than the Authentication Request is using PKCE and is compliant with the specifications, otherwise it is not compliant.",RP,The HTTP Authentication Request must contain the 'code_challenge' parameter.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,Correctness in the OP is checked with the code_verifier,
RP-Authentication request-metadata-value,"The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is not present, then the RP is not compliant with the specifications","Trigger The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is not present, then the RP is not compliant with the specifications","Compliant if the code_challenge_method parameter is present, not Compliant otherwise",Authentication request,Does the RP's Authentication Request contain the 'code_challenge_method' parameter,"The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is not present, then the RP is not compliant with the specifications",RP,The HTTP Authentication Request must contain the 'code_challenge_method' parameter and it must be set to on of the value of the code_challenge_methods_supported parameter in the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,Create OP test on code_challenge,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the presence of the client_assertion parameter is checked.,Trigger The Introspection request made by the RP is taken and the presence of the client_assertion parameter is checked.,"Compliant if the client_assertion parameter in the request is present, not compliant otherwise",Introspection request,Does the Introspection Request contain the client_assertion,The Introspection request made by the RP is taken and the presence of the client_assertion parameter is checked.,RP,The request to the Introspection Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,Trigger The Introspection request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,"Compliant if the client_assertion_type parameter in the request is present, not compliant otherwise",Introspection request,Does the Introspection Request contain the client_assertion_type,The Introspection request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,RP,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,Trigger The Introspection request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,"Compliant if the client_assertion parameter in the request is a signed JWT, not compliant otherwise",Introspection request,Does the Introspection Request contain the client_assertion as a valid JWT,The Introspection request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,RP,The request to the Introspection Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the presence of the client_id parameter is checked.,Trigger The Introspection request made by the RP is taken and the presence of the client_id parameter is checked.,"Compliant if the client_id parameter in the request is present, not compliant otherwise",Introspection request,Does the Introspection Request contain the client id of the RP making the request,The Introspection request made by the RP is taken and the presence of the client_id parameter is checked.,RP,The request to the Introspection Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the presence of the token parameter is checked.,Trigger The Introspection request made by the RP is taken and the presence of the token parameter is checked.,"Compliant if the token parameter in the request is present, not compliant otherwise",Introspection request,Does the Introspection Request contain the token,The Introspection request made by the RP is taken and the presence of the token parameter is checked.,RP,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the presence of the client_assertion parameter is checked.,Trigger The Revocation request made by the RP is taken and the presence of the client_assertion parameter is checked.,"Compliant if the client_assertion parameter in the request is present, not compliant otherwise",Revocation request,Does the Revocation Request contain the client assertion,The Revocation request made by the RP is taken and the presence of the client_assertion parameter is checked.,RP,The request to the Revocation Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,Trigger The Revocation request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,"Compliant if the client_assertion_type parameter in the request is present, not compliant otherwise",Revocation request,Does the Revocation Request contain the client_assertion_type,The Revocation request made by the RP is taken and the presence of the client_assertion_type parameter is checked.,RP,The request to the Revocation Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the presence of the client_id parameter is checked.,Trigger The Revocation request made by the RP is taken and the presence of the client_id parameter is checked.,"Compliant if the client_id parameter in the request is present, not compliant otherwise",Revocation request,Does the Revocation Request contain the client_id of the RP making the request,The Revocation request made by the RP is taken and the presence of the client_id parameter is checked.,RP,The request to the Revocation Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Is revocation bound to a specific client (IsBoundToClient),,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the presence of the token parameter is checked.,Trigger The Revocation request made by the RP is taken and the presence of the token parameter is checked.,"Compliant if the token parameter in the request is present, not compliant otherwise",Revocation request,Does the Revocation Request contain the token for which the request is made,The Revocation request made by the RP is taken and the presence of the token parameter is checked.,RP,The request to the Revocation Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must contain client_assertion parameter in the URL,"Compliant if the Token request contains the client_assertion parameter, not Compliant otherwise",Token request,Does the token request contain the client_assertion,The token request sent by the RP must contain client_assertion parameter in the URL,RP,An RP doing a Token Request must insert the client_assertion parameter in the request and it is a signed JWT,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must be sent in HTTP POST,"Compliant if the Token request is sent in HTTP POST, not Compliant otherwise",Token request,Does the token request use HTTP POST,The token request sent by the RP must be sent in HTTP POST,RP,An RP doing a Token Request must be done via HTTP POST,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must contain client_assertion_type parameter in the URL,"Compliant if the Token Request contains the client_assertion_type parameter,not Compliant otherwise",Token request,Does the token request contain the client_assertion_type,The token request sent by the RP must contain client_assertion_type parameter in the URL,RP,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must contain client_id parameter in the URL,"Compliant if the token request contains the client_id parameter, not Compliant otherwise",Token request,Does the token request contain the client_id,The token request sent by the RP must contain client_id parameter in the URL,RP,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must contain code parameter in the URL,"Compliant if the Token Request contains the code parameter, not Compliant otherwise",Token request,Does the token request contain the code parameter,The token request sent by the RP must contain code parameter in the URL,RP,"An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code', than it must contain the code and the code_verifier",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must contain code_verifier parameter in the URL,"Compliant if the Token Request contains the code_verifier parameter, not Compliant otherwise",Token request,Does the token request contain the code_verifier parameter,The token request sent by the RP must contain code_verifier parameter in the URL,RP,"An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code', than it must contain the code and the code_verifier",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The token request sent by the RP must contain grant_type parameter in the URL,"Compliant if the Token Request contains the grant_type parameter, not Compliant otherwise",Token request,Does the token request contain the grant_type parameter,The token request sent by the RP must contain grant_type parameter in the URL,RP,An RP doing a Token Request must insert the grant_type parameter in the request,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-User logout-metadata-value,Revocation request,"Trigger In order to test if the RP really revokes an access token on logout, a classic authentication flow is computed and, once obtained the token and used, a logout is performed. After this, the requests made by the RP must be analyzed and there has to be a request to the OP's revocation endpoint for only the access token","Compliant if the RP sends a Revocation Request regarding the access token, not compliant otherwise",User logout,Does the RP revoke the Token when the User logs out,"In order to test if the RP really revokes an access token on logout, a classic authentication flow is computed and, once obtained the token and used, a logout is performed. After this, the requests made by the RP must be analyzed and there has to be a request to the OP's revocation endpoint for only the access token",RP,"When the user logs out, the RP MUST revoke the Access Token in its possession",SPID_CIE_OIDC#logout; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/logout.html,OIDC Core,,,,
RP-Userinfo request-metadata-value,The UserInfo request from the RP is taken and analyzed. In the Authorization field of the header there must be an Access Token,Trigger The UserInfo request from the RP is taken and analyzed. In the Authorization field of the header there must be an Access Token,"Compliant if the the authorization field in the header of the UserInfo Request contains an Access Token, not compliant otherwise",Userinfo request,Does the RP contain the Access Token in the UserInfo request,The UserInfo request from the RP is taken and analyzed. In the Authorization field of the header there must be an Access Token,RP,"In order to obtain the requested claims, the RP sends a request to the UserInfo Endpoint using the Access Token",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
ALL-Entity Configuration response-metadata-value,Entity Configuration Response,"Trigger In order to check the presence and correctness of the /.well-known/openid-federation endpoint, an HTTP GET request to the entity's endpoint is done and its entity configuration is expected as response.","Compliant if the Response is exposed, not compliant otherwise",Entity Configuration response,Does the Entity expose the /.well-known/openid-federation endpoint,"In order to check the presence and correctness of the /.well-known/openid-federation endpoint, an HTTP GET request to the entity's endpoint is done and its entity configuration is expected as response.",ALL,All the Entities MUST contain the /.well-known/openid-federation endpoint. It gives the Entity Configuration,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"The considered entity must have published its entity configuration in the .well-known/openid-federation endpoint. So in this test, an HTTP GET request is made to the entity's .well-known/openid-federation endpoint (appended to the URL which identifies the entity) and the response is analyzed. This response has to be the entity configuration of the entity and therefore a Federation Metadata in JOSE format (Content-Type: application/entity-statement+jwt)","Trigger The considered entity must have published its entity configuration in the .well-known/openid-federation endpoint. So in this test, an HTTP GET request is made to the entity's .well-known/openid-federation endpoint (appended to the URL which identifies the entity) and the response is analyzed. This response has to be the entity configuration of the entity and therefore a Federation Metadata in JOSE format (Content-Type: application/entity-statement+jwt)","Compliant if the response is the Entity Configuration of the entity, not compliant otherwise",Entity Configuration response,Does the entity configuration of a considered entity return a Federation Metadata in JOSE format when an HTTP GET request is made to its .well-known/openid-federation endpoint,"The considered entity must have published its entity configuration in the .well-known/openid-federation endpoint. So in this test, an HTTP GET request is made to the entity's .well-known/openid-federation endpoint (appended to the URL which identifies the entity) and the response is analyzed. This response has to be the entity configuration of the entity and therefore a Federation Metadata in JOSE format (Content-Type: application/entity-statement+jwt)",ALL,"An Entity Configuration (EC) is a Federation Metadata in Jose format, signed by its issuing subject and regarding itself, published at the web endpoint .well-known/openid-federation.",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,,,,
ALL-Resolve Entity Statement endpoint response-metadata-value,Resolve Entity Statement endpoint response,"Trigger In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request containing the parameters 'sub', 'anchor' and 'type' is made to the entity's endpoint and an HTTP 200 OK response containing the resolved metadata for the entity in the request's sub claim is expected.","Compliant if the Response contains a JWT, not compliant otherwise",Resolve Entity Statement endpoint response,Does the Entity expose the resolve entity statement endpoint,"In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request containing the parameters 'sub', 'anchor' and 'type' is made to the entity's endpoint and an HTTP 200 OK response containing the resolved metadata for the entity in the request's sub claim is expected.",ALL,"All the Entities MUST contain the resolve entity statement endpoint. It gives the final Metadata, the Trust Chain and the Trust Marks regarding another subject.",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
OP-Token response-metadata-value,In this test a correct Token request is sent and the response is analyzed. It must contain the access token parameter and its value must be a JWT,Trigger In this test a correct Token request is sent and the response is analyzed. It must contain the access token parameter and its value must be a JWT,"Compliant if the token response has a valid JWT access_token parameter, not Compliant otherwise",Token response,Does the successful token response contain a valid access token,In this test a correct Token request is sent and the response is analyzed. It must contain the access token parameter and its value must be a JWT,OP,"If the Token request is correct, the succesful response sent by the OP must contain the access_token parameter, containing the issued access token",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Are access token supported (HasAccessTokens) Are JWT access token used (HasJwtAccessTokens),,,
OP-Token response-metadata-value,The RP receiving the Token response and that sent a correct token request must check the presence of a valid ID token,Trigger The RP receiving the Token response and that sent a correct token request must check the presence of a valid ID token,"Compliant if the token response has a valid JWT id_token parameter, not Compliant otherwise",Token response,Does the successful token response contain a valid ID token,The RP receiving the Token response and that sent a correct token request must check the presence of a valid ID token,OP,"If the authorization request is correct, the succesfull response sent by the OP must contain the id_token parameter, containing the ID Token value in JWT format",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the value of the client_id parameter is an URI,Trigger The Introspection request made by the RP is taken and the value of the client_id parameter is an URI,"Compliant if the client_id parameter in the request is an URI, not compliant otherwise",Introspection request,Does the Introspection Request contain correct type of client id of the RP making the request,The Introspection request made by the RP is taken and the value of the client_id parameter is an URI,RP,The request to the Introspection Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the type of the token parameter is a JWT,Trigger The Introspection request made by the RP is taken and the type of the token parameter is a JWT,"Compliant if the token parameter in the request is a valid JWT, not compliant otherwise",Introspection request,Does the Introspection Request contain correct type token,The Introspection request made by the RP is taken and the type of the token parameter is a JWT,RP,The request to the Introspection Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,Trigger The Revocation request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,"Compliant if the client_assertion parameter in the request is a valid JWT, not compliant otherwise",Revocation request,Does the Revocation Request contain correct type of client assertion,The Revocation request made by the RP is taken and the value of the client_assertion parameter is a signed JWT structure,RP,The request to the Revocation Endpoint must contain the client_assertion parameter and it has to be a JWT signed with the RP's private key,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,Trigger The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,"Compliant if the client_id parameter in the request is an URI, not compliant otherwise",Revocation request,Does the Revocation Request contain correct type of client_id of the RP making the request,The Revocation request made by the RP is taken and the value of the client_id parameter is an URI that identifies the RP,RP,The request to the Revocation Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,Is revocation bound to a specific client (IsBoundToClient),,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the value of the token parameter is a JWT.,Trigger The Revocation request made by the RP is taken and the value of the token parameter is a JWT.,"Compliant if the token parameter in the request is a valid JWT, not compliant otherwise",Revocation request,Does the Revocation Request contain correct type of token for which the request is made,The Revocation request made by the RP is taken and the value of the token parameter is a JWT.,RP,The request to the Revocation Endpoint must contain the token for which the request is made,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The client_assertion parameter in the token request sent by the RP must be a JWT,"Compliant if the client_assertion parameter in the token request is a valid JWT, not Compliant otherwise",Token request,Does the client_assertion in the token request contain a JWT,The client_assertion parameter in the token request sent by the RP must be a JWT,RP,An RP doing a Token Request must insert the client_assertion parameter in the request and it is a signed JWT,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The client_assertion parameter in the token request sent by the RP must be a JWT with a signature,"Compliant if the signature of the client_assertion parameter in the token request is valid, not Compliant otherwise",Token request,Does the client_assertion in the token request have a correct signature,The client_assertion parameter in the token request sent by the RP must be a JWT with a signature,RP,An RP doing a Token Request must insert the client_assertion parameter in the request and it is a signed JWT,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Userinfo request-metadata-value,The UserInfo request from the RP is taken and analyzed. In the Authorization field of the head there must be a valid Access Token,Trigger The UserInfo request from the RP is taken and analyzed. In the Authorization field of the head there must be a valid Access Token,"Compliant if the authorization field in the header of the UserInfo Request contains a valid Access Token (JWT), not compliant otherwise",Userinfo request,Does the RP contain a valid Access Token in the UserInfo request,The UserInfo request from the RP is taken and analyzed. In the Authorization field of the head there must be a valid Access Token,RP,"In order to obtain the requested claims, the RP sends a request to the UserInfo Endpoint using the Access Token",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
SA-Entity Listing endpoint response-metadata-value,Entity Listing endpoint response,"Trigger In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request entity's endpoint. An HTTP 200 OK response containing a JSON list with the known Entity Identifiers is expected","Compliant if the Response contains a JSON list (array), not compliant otherwise",Entity Listing endpoint response,Does the Entity expose the entity listing endpoint,"In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request entity's endpoint. An HTTP 200 OK response containing a JSON list with the known Entity Identifiers is expected",SA,This test simply checks if the entity exposes the /.well-known/openid-federation endpoint and if it,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Trigger After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Compliant if the SA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",Entity Statement response OP,Does the SA correctly release the Entity statements,"After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",SA,"The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it. An Entity publishes an ES related to a subordinate, at its Fetch Endpoint.",SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Listing endpoint response-metadata-value,Entity Listing endpoint response,"Trigger In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request to the entity's endpoint is done. A response containing a JSON list with the known Entity Identifiers is expected","Compliant if the response contains a JSON list, not compliant otherwise",Entity Listing endpoint response,Does the Entity expose the entity listing endpoint,"In order to check the presence and correctness of the resolve entity statement endpoint, an HTTP GET request to the entity's endpoint is done. A response containing a JSON list with the known Entity Identifiers is expected",TA,This test simply checks if the entity exposes the /.well-known/openid-federation endpoint and if it,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Trigger After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Compliant if the TA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",Entity Statement response OP,Does the TA correctly release the Entity statements,"After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",TA,The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it.,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Trigger In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Compliant if the response contains a JWT, not compliant otherwise",Entity Statement response OP,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",TA,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
TA-Public Keys History response-metadata-value,TA's public keys history response,Trigger An HTTP Get request is made to the TA's /.well-known/openid-federation-jwks endpoint and the answer is analyzed,"Compliant if the response contains a JWT, not compliant otherwise",Public Keys History response,Does the TA publish the federation public key history,An HTTP Get request is made to the TA's /.well-known/openid-federation-jwks endpoint and the answer is analyzed,TA,"In order to enable the verification of messages exchanged by Entities participating in the federation and their Trust Chains, the TA MUST publish the federation public key history (JWKS) within a registry made available to all participants via the /.well-known/openid-federation-jwks endpoint.",SPID_CIE_OIDC#Retention-Policy; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/log_management.html,OIDC Federation,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,Trigger The Introspection request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,"Compliant if the client_assertion_type parameter in the request is urn:ietf:params:oauth:clientassertion-type:jwt-bearer, not compliant otherwise",Introspection request,Does the Introspection Request contain correct type of client_assertion_type,The Introspection request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,RP,The request to the Introspection Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP is taken and the value of the client_id parameter identifies the RP,Trigger The Introspection request made by the RP is taken and the value of the client_id parameter identifies the RP,"Compliant if the client_id parameter in the request identifies the RP, not compliant otherwise",Introspection request,Does the Introspection Request contain correct client id of the RP making the request,The Introspection request made by the RP is taken and the value of the client_id parameter identifies the RP,RP,The request to the Introspection Endpoint must contain the client_id parameter and it has to be an URI identifying the RP,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
RP-Revocation request-metadata-value,The Revocation request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,Trigger The Revocation request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,"Compliant if the client_assertion_type parameter in the request is urn:ietf:params:oauth:clientassertion-type:jwt-bearer, not compliant otherwise",Revocation request,Does the Revocation Request contain correct client_assertion_type,The Revocation request made by the RP is taken and the value of the client_assertion_type parameter is urn:ietf:params:oauth:clientassertion-type:jwt-bearer,RP,The request to the Revocation Endpoint must contain the client_assertion_type parameter and it has to be set to urn:ietf:params:oauth:clientassertion-type:jwt-bearer,SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The client_assertion_type parameter in the URL of the token request sent by the RP must be set to urn:ietf:params:oauth:client-assertion-type:jwtbearer,"Compliant if the client_assertion_type parameter in the request is urn:ietf:params:oauth:clientassertion-type:jwt-bearer, not compliant otherwise",Token request,Does the client_assertion_type paramter in the token request contain the correct type,The client_assertion_type parameter in the URL of the token request sent by the RP must be set to urn:ietf:params:oauth:client-assertion-type:jwtbearer,RP,An RP doing a Token Request must insert the client_assertion_type parameter in the request and it must be set to 'urn:ietf:params:oauth:client-assertion-type:jwtbearer',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The client_id parameter in the URL of the token request is taken and checked to be an HTTPS URL,Compliant if the token request contains a client_id parameter and it is an HTTPS URL. Not Compliant otherwise,Token request,Does the client_id in the token request contain an HTTPS URL,The client_id parameter in the URL of the token request is taken and checked to be an HTTPS URL,RP,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The client_id parameter in the URL of the token request is taken. This parameter must identify the RP,Compliant if the token request contains a client_id parameter identifying the RP. Not Compliant otherwise,Token request,Does the client_id in the token request identifies the RP,The client_id parameter in the URL of the token request is taken. This parameter must identify the RP,RP,An RP doing a Token Request must insert the client_id parameter in the request and it has to be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,Trigger The grant_type parameter in the URL of the token request sent by the RP must be set to authorization_code or to refresh_token. So in this test a token request is taken and the grant_type parameter is checked,"Compliant if the Token Request set the grant_type parameter to authorization_code or refresh_token, not Compliant otherwise",Token request,Does the token request contain a correct grant_type parameter,The grant_type parameter in the URL of the token request sent by the RP must be set to authorization_code or to refresh_token. So in this test a token request is taken and the grant_type parameter is checked,RP,An RP doing a Token Request must set the grant_type parameter in the request to 'authorization_code'  or 'refresh_token',SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
TA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,"Trigger In order to check if the trust mark status endpoint of a TA or SA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed","Compliant if the response contains the claim 'active' set to true, not compliant otherwise",Trust Mark status response,Does the Entity's trust mark status endpoint correctly response to valid Trust Marks with claim 'active',"In order to check if the trust mark status endpoint of a TA or SA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed",TA,"All the Entities that release Trust Marks, MUST expose a Trust Mark status endpoint for allowing the dynamic validation.",SPID_CIE_OIDC#Trust-Marks-Validation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#validazione-dei-trust-mark,OIDC Federation,,,,
OP-Revocation response-metadata-value,"A correct flow is accomplished and, once received the token, a request is made to the revocation endpoint. The response is then analyzed and has to be an empty HTTP 200 OK","Trigger A correct flow is accomplished and, once received the token, a request is made to the revocation endpoint. The response is then analyzed and has to be an empty HTTP 200 OK","Compliant if the response is a an HTTP 200 OK, not compliant otherwise",Revocation response,Does the revocation endpoint return an empty HTTP 200 OK response upon a correct revocation request,"A correct flow is accomplished and, once received the token, a request is made to the revocation endpoint. The response is then analyzed and has to be an empty HTTP 200 OK",OP,"The Revocation Endpoint answers with a code HTTP 200, also though the indicated token does not exist or has already been revoked (so that non information is going to be released)",SPID_CIE_OIDC#Revocation-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,In this test a normal flow is accomplished and is tried to obtain an Access Token. All requests are well-formed and the Responses of the OP are analyzed.,Trigger In this test a normal flow is accomplished and is tried to obtain an Access Token. All requests are well-formed and the Responses of the OP are analyzed.,"Compliant if the response is a an HTTP 200 OK, not compliant otherwise",Token response,Does the OP handle a correct token request,In this test a normal flow is accomplished and is tried to obtain an Access Token. All requests are well-formed and the Responses of the OP are analyzed.,OP,Response example,SPID_CIE_OIDC#Token-response https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
TA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,"Trigger In order to check if the trust mark status endpoint of a TA or SA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed","Compliant if the response is a an HTTP 200 OK, not compliant otherwise",Trust Mark status response,Does the Entity's trust mark status endpoint correctly response to valid Trust Marks,"In order to check if the trust mark status endpoint of a TA or SA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed",TA,"All the Entities that release Trust Marks, MUST expose a Trust Mark status endpoint for allowing the dynamic validation.",SPID_CIE_OIDC#Trust-Marks-Validation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#validazione-dei-trust-mark,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the value of the issuer claim in the 'oauth_authorization_server' entity type is an URL,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the value of the issuer claim in the 'oauth_authorization_server' entity type is an URL,"Compliant if the issuer claim in the metadata claim is an URL, not compliant otherwise",Entity Configuration response,Does the AA metadata contain a correct type of issuer claim,In this test the AA metadata in the AA Entity Configuration are taken and the value of the issuer claim in the 'oauth_authorization_server' entity type is an URL,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain issuer,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the value of the logo_uri claim is an URL,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the value of the logo_uri claim is an URL,"Compliant if the logo_uri claim in the metadata claim is an URL, not compliant otherwise",Entity Configuration response,Does the AA metadata contain a correct logo_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the value of the logo_uri claim is an URL,AA,The AA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be an URL with no query or fragment component,Trigger In this test the OP metadata are taken and the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be an URL with no query or fragment component,"Compliant if the issuer parameter in the OP metadata ('openid_provider' type) is an URL with no query or fragment component, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct type issuer parameter,In this test the OP metadata are taken and the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be an URL with no query or fragment component,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'issuer' and it must contain an HTTPS URL that uniquely identifies the OP, without query of fragment components.",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,config has issuer,"The fact of not having fragments or query components is written in the link (https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata) in the description of the claim. Maybe it could be made more clear. external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,"Compliant if the logo_uri parameter in the OP metadata ('openid_provider' type) is an URL, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct type logo_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,OP,The OP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is 'one_of': ['RS256', 'RS512']","Trigger In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is 'one_of': ['RS256', 'RS512']","Compliant if the dpop_signing_alg_values_supported claim contains 'one_of': ['RS256', 'RS512'], not compliant if it is missing",Entity Configuration response,Does the AA metadata contain correct dpop_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is 'one_of': ['RS256', 'RS512']",AA,The AA Metadata of type 'oauth_authorization_server' MUST contain dpop_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the value of the 'client_id' parameter is an HTTPS URL,Trigger In this test the RP metadata are taken and the value of the 'client_id' parameter is an HTTPS URL,"Compliant if the 'client_id' parameter in the RP metadata is an HTTPS URL, not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct type of 'client_id' parameter,In this test the RP metadata are taken and the value of the 'client_id' parameter is an HTTPS URL,RP,The RP metadata of type 'openid_relying_party' must contain the parameter client_id and it must contain an HTTPS URL that uniquely identifies the RP,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the 'grant_types' parameter is a JSON array,Trigger In this test the RP metadata are taken and the 'grant_types' parameter is a JSON array,"Compliant if the 'grant_types' parameter in the RP metadata is a JSON, not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct type grant_types claim,In this test the RP metadata are taken and the 'grant_types' parameter is a JSON array,RP,The RP metadata of type 'openid_relying_party' must contain the parameter grant_types and it must be a JSON array containing 'authorization_code' and 'refresh_token',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,"Compliant if the logo_uri claim is an URL, not compliant otherwise",Entity Configuration response,Does the RP metadata contain correct type logo_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the value of the logo_uri claim in the 'federation_entity' entity type is an URL,RP,The RP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' is a JSON array,Trigger In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' is a JSON array,Compliant if the 'response_types' parameter in the RP metadata is a JSON Array. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'response_types' parameter as a json,In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' is a JSON array,RP,The RP metadata of type 'openid_relying_party' must contain the parameter response_types and it has to be a JSON array containing the value 'code',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Authentication request-metadata-value,In this test the Authentication Request is taken and the presence of the client_id parameter in the URL is checked,Trigger In this test the Authentication Request is taken and the presence of the client_id parameter in the URL is checked,Compliant if the url contains the client_id parameter,Authentication request,Does the RP insert the client ID in the url of the request,In this test the Authentication Request is taken and the presence of the client_id parameter in the URL is checked,RP,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,In this test the Authentication Request is taken and the presence of the response_type parameter in the URL is checked,Trigger In this test the Authentication Request is taken and the presence of the response_type parameter in the URL is checked,Compliant if the url contains the response_type parameter,Authentication request,Does the RP insert the response type in the url of the request,In this test the Authentication Request is taken and the presence of the response_type parameter in the URL is checked,RP,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must contain the attribute max_path_length","Trigger To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must contain the attribute max_path_length","Compliant if the constraints parameter contains the max_path_length attribute, not compliant otherwise",Entity Configuration response TA,Does the Trust Anchor's Entity configuration's constraints parameter contain the attribute 'max_path_length',"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must contain the attribute max_path_length",TA,TA's Entity Configuration must have the 'constraints' and 'trust_mark_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the authorization_endpoint claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the authorization_endpoint claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the authorization_endpoint claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the authorization_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the authorization_endpoint claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain authorization_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,"Compliant if the contacts claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the contacts claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain contacts,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the dpop_signing_alg_values_supported claim is present, not compliant if it is missing",Entity Configuration response,Does the AA metadata contain dpop_signing_alg_values_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain dpop_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,"Compliant if the federation_resolve_endpoint claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the federation_resolve_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain federation_resolve_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_trust_mark_status_endpoint claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_trust_mark_status_endpoint claim in the 'federation_entity' entity type is checked.,"Compliant if the federation_trust_mark_status_endpoint claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the federation_trust_mark_status_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the federation_trust_mark_status_endpoint claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain federation_trust_mark_status_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the grant_types_supported claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the grant_types_supported claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the grant_types_supported claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the grant_types_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the grant_types_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain grant_types_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the homepage_uri claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the homepage_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain homepage_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the issuer claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the issuer claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the issuer claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the issuer claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the issuer claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain issuer,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the jwks claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the jwks claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the jwks claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the jwks claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the jwks claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain jwks,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the logo_uri claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the logo_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_policy_uri claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_policy_uri claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the op_policy_uri claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the op_policy_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_policy_uri claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain op_policy_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_tos_uri claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_tos_uri claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the op_tos_uri claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the op_tos_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the op_tos_uri claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain op_tos_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,"Compliant if the organization_name claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the organization_name claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain organization_name,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the policy_uri claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the policy_uri claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,AA,The AA Metadata of type 'federation_entity' MUST contain policy_uri,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the resource claim in the 'oauth_resource' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the resource claim in the 'oauth_resource' entity type is checked.,"Compliant if the resource claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the resource claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the resource claim in the 'oauth_resource' entity type is checked.,AA,The AA Metadata of type 'oauth_resource' MUST contain resource,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the response_types_supported claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the response_types_supported claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the response_types_supported claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the response_types_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the response_types_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain response_types_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the scopes_supported claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the scopes_supported claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the scopes_supported claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the scopes_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the scopes_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain scopes_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the token_endpoint claim is present, not compliant otherwise",Entity Configuration response,Does the AA metadata contain the token_endpoint claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the token_endpoint_auth_signing_alg_values_supported claim is present, not compliant if it is empty or is missing",Entity Configuration response,Does the AA metadata contain the token_endpoint_auth_signing_alg_values_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'jwks' parameter in the 'openid_provider' subclaim (metadata type) is checked,Trigger In this test the OP metadata are taken and the presence of the 'jwks' parameter in the 'openid_provider' subclaim (metadata type) is checked,Compliant if the 'jwks' parameter in the OP metadata ('openid_provider' type) is present,Entity Configuration response,Does the OP metadata contain the jwks claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'jwks' parameter in the 'openid_provider' subclaim (metadata type) is checked,OP,The OP metadata of type 'openid_provider' must contain the parameter 'jwks' or the parameter 'signed_jwks_uri',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'jwks' or the 'signed_jwks_uri' parameter in the 'openid_provider' subclaim (metadata type) is checked. There must be at least one of the two,Trigger In this test the OP metadata are taken and the presence of the 'jwks' or the 'signed_jwks_uri' parameter in the 'openid_provider' subclaim (metadata type) is checked. There must be at least one of the two,Compliant if the 'signed_jwks_uri' parameter in the OP metadata ('openid_provider' type) is present,Entity Configuration response,Does the OP metadata contain the jwks or signed_jwks_uri claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'jwks' or the 'signed_jwks_uri' parameter in the 'openid_provider' subclaim (metadata type) is checked. There must be at least one of the two,OP,The OP metadata of type 'openid_provider' must contain the parameter 'jwks' or the parameter 'signed_jwks_uri',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked.,Trigger In this test the OP metadata are taken and the presence of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked.,"Compliant if the acr_values_supported ('openid_provider' type) parameter in the OP metadata is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the acr_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked.,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'acr_values_supported' and it must be set to [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'authorization_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,Trigger In this test the OP metadata are taken and the presence of the 'authorization_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,"Compliant if the authorization_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the authorization_endpoint parameter,In this test the OP metadata are taken and the presence of the 'authorization_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,The OP metadata of type 'openid_provider' must contain the parameter 'authorization_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has authorization_endpoint,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'code_challenge_methods_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the code_challenge_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'code_challenge_methods_supported' and it must be set to 'S256',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,"Compliant if the contacts claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the OP metadata contain the contacts claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,OP,The OP Metadata of type 'federation_entity' MUST contain contacts,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,"Compliant if the federation_resolve_endpoint claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the OP metadata contain the federation_resolve_endpoint claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,OP,The OP Metadata of type 'federation_entity' MUST contain federation_resolve_endpoint,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the grant_types_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the grant_types_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'grant_types_supported' and it must be set to [refresh_token, authorization_code]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the homepage_uri claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the OP metadata contain the homepage_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,OP,The OP Metadata of type 'federation_entity' MUST contain homepage_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'id_token_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the id_token_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'id_token_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the id_token_encryption_enc_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'id_token_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the id_token_signing_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has id_token_signing_alg_values_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'introspection_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,Trigger In this test the OP metadata are taken and the presence of the 'introspection_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,"Compliant if the introspection_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the introspection_endpoint parameter,In this test the OP metadata are taken and the presence of the 'introspection_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,The OP metadata of type 'openid_provider' must contain the parameter 'introspection_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the issuer parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the issuer parameter,In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'issuer' and it must contain an HTTPS URL that uniquely identifies the OP, without query of fragment components.",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,config has issuer,"The fact of not having fragments or query components is written in the link (https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata) in the description of the claim. Maybe it could be made more clear. external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the logo_uri claimin the OP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the OP metadata contain the logo_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,OP,The OP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,"Compliant if the organization_name claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the OP metadata contain the organization_name claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,OP,The OP Metadata of type 'federation_entity' MUST contain organization_name,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the OP metadata in the OP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the policy_uri claim in the OP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the OP metadata contain the policy_uri claim,In this test the OP metadata in the OP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,OP,The OP Metadata of type 'federation_entity' MUST contain policy_uri,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'request_object_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the request_object_signing_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'request_object_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the response_modes_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the response_modes_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'response_modes_supported' and it must be set to [form_post, query]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the response_types_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the response_types_supported claim,In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'response_types_supported' and it must be set to 'code',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has response_types_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'revocation_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,Trigger In this test the OP metadata are taken and the presence of the 'revocation_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,"Compliant if the revocation_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the revocation_endpoint parameter,In this test the OP metadata are taken and the presence of the 'revocation_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,The OP metadata of type 'openid_provider' must contain the parameter 'revocation_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'revocation_endpoint_auth_methods_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the revocation_endpoint_auth_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'revocation_endpoint_auth_methods_supported' and it must be set to 'private_key_jwt',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the scopes_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the scopes_supported claim,In this test the OP metadata are taken and the presence of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'scopes_supported' and it must be set to [openid, offline_access, profile, email]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the subject_types_supported parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the subject_types_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'subject_types_supported' and it must be set to 'pairwise',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has subject_types_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'token_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,Trigger In this test the OP metadata are taken and the presence of the 'token_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,"Compliant if the token_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the token_endpoint parameter,In this test the OP metadata are taken and the presence of the 'token_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,The OP metadata of type 'openid_provider' must contain the parameter 'token_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has token_endpoint,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'userinfo_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the userinfo_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,"Compliant if the 'userinfo_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the userinfo_encryption_enc_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'userinfo_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,Trigger In this test the OP metadata are taken and the presence of the 'userinfo_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,"Compliant if the userinfo_endpoint parameter in the OP metadata ('openid_provider' type) is present, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain the userinfo_endpoint parameter,In this test the OP metadata are taken and the presence of the 'userinfo_endpoint' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present,OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_endpoint',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has userinfo_endpoint,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Trigger In this test the OP metadata are taken and the presence of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,Compliant if the 'userinfo_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is present. Not Compliant otherwise,Entity Configuration response,Does the OP metadata contain the userinfo_signing_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the presence of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked.,OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'client_id' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'client_id' parameter is checked.,"Compliant if the 'client_id' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant otherwise",Entity Configuration response,Does the RP metadata contain the 'client_id' parameter,In this test the RP metadata are taken and the presence of the 'client_id' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter client_id and it must contain an HTTPS URL that uniquely identifies the RP,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'client_registration_types' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'client_registration_types' parameter is checked.,Compliant if the 'client_registration_types' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'client_registration_types' parameter,In this test the RP metadata are taken and the presence of the 'client_registration_types' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter client_registration_types and it has to be set to 'automatic'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,"Compliant if the contacts claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the RP metadata contain the contacts claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the contacts claim in the 'federation_entity' entity type is checked.,RP,The RP Metadata of type 'federation_entity' MUST contain contacts,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,"Compliant if the federation_resolve_endpoint claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the RP metadata contain the federation_resolve_endpoint claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the federation_resolve_endpoint claim in the 'federation_entity' entity type is checked.,RP,The RP Metadata of type 'federation_entity' MUST contain federation_resolve_endpoint,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'grant_types' parameter is checked,Trigger In this test the RP metadata are taken and the presence of the 'grant_types' parameter is checked,"Compliant if the 'grant_types' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant otherwise",Entity Configuration response,Does the RP metadata contain the grant_types claim,In this test the RP metadata are taken and the presence of the 'grant_types' parameter is checked,RP,The RP metadata of type 'openid_relying_party' must contain the parameter grant_types and it must be a JSON array containing 'authorization_code' and 'refresh_token',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the homepage_uri claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the RP metadata contain the homepage_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the homepage_uri claim in the 'federation_entity' entity type is checked.,RP,The RP Metadata of type 'federation_entity' MUST contain homepage_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_alg' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_alg' parameter is checked.,Compliant if the 'id_token_encrypted_response_alg' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'id_token_encrypted_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_alg' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_enc' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_enc' parameter is checked.,Compliant if the 'id_token_encrypted_response_enc' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'id_token_encrypted_response_enc' parameter,In this test the RP metadata are taken and the presence of the 'id_token_encrypted_response_enc' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_enc and it has to contain the content encryption algorithms. This parameter is required only if the id_token_encrypted_response_alg is given,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,This parameter is required only if the id_token_encrypted_response_alg is given,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'id_token_signed_response_alg' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'id_token_signed_response_alg' parameter is checked.,Compliant if the 'id_token_signed_response_alg' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'id_token_signed_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'id_token_signed_response_alg' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the presence of the 'jwks' parameter is checked. If it is absent, than the RP is not compliant with the specification","Trigger In this test the RP metadata are taken and the presence of the 'jwks' parameter is checked. If it is absent, than the RP is not compliant with the specification","Compliant if the 'jwks' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant if is absent",Entity Configuration response,Does the RP metadata contain the 'jwks' parameter,"In this test the RP metadata are taken and the presence of the 'jwks' parameter is checked. If it is absent, than the RP is not compliant with the specification",RP,The RP metadata of type 'openid_relying_party' must contain the parameter jwks,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the logo_uri claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the RP metadata contain the logo_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the logo_uri claim in the 'federation_entity' entity type is checked.,RP,The RP Metadata of type 'federation_entity' MUST contain logo_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,"Compliant if the organization_name claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the RP metadata contain the organization_name claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the organization_name claim in the 'federation_entity' entity type is checked.,RP,The RP Metadata of type 'federation_entity' MUST contain organization_name,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
RP-Entity Configuration response-metadata-value,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,Trigger In this test the RP metadata in the RP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,"Compliant if the policy_uri claim in the RP metadata ('federation_entity' type) is present, not compliant otherwise",Entity Configuration response,Does the RP metadata contain the policy_uri claim,In this test the RP metadata in the RP Entity Configuration are taken and the presence of the policy_uri claim in the 'federation_entity' entity type is checked.,RP,The RP Metadata of type 'federation_entity' MUST contain policy_uri,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'token_endpoint_auth_method' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'token_endpoint_auth_method' parameter is checked.,Compliant if the 'token_endpoint_auth_method' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'token_endpoint_auth_method' parameter,In this test the RP metadata are taken and the presence of the 'token_endpoint_auth_method' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter token_endpoint_auth_method and it has to be set to 'private_key_jwt'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_alg' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_alg' parameter is checked.,"Compliant if the 'userinfo_encrypted_response_alg' parameter in the RP metadata ('openid_relying_party' type) is present, Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain the 'userinfo_encrypted_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_alg' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is checked.,Compliant if the 'userinfo_encrypted_response_enc' parameter in the RP metadata ('openid_relying_party' type) is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'userinfo_encrypted_response_enc' parameter,In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_enc and it has to contain the content encryption algorithms.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'userinfo_signed_response_alg' parameter is checked.,Trigger In this test the RP metadata are taken and the presence of the 'userinfo_signed_response_alg' parameter is checked.,Compliant if the 'userinfo_signed_response_alg' parameter in the RP metadata is present. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain the 'userinfo_signed_response_alg' parameter,In this test the RP metadata are taken and the presence of the 'userinfo_signed_response_alg' parameter is checked.,RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the presence of the 'response_types' parameter in the 'openid_relying_party' metadata type is checked,Trigger In this test the RP metadata are taken and the presence of the 'response_types' parameter in the 'openid_relying_party' metadata type is checked,"Compliant if the 'response_types' parameter in the RP metadata ('openid_relying_party' type) is present, not Compliant otherwise",Entity Configuration response,Does the RP metadata contain the 'response_types' parameter,In this test the RP metadata are taken and the presence of the 'response_types' parameter in the 'openid_relying_party' metadata type is checked,RP,The RP metadata of type 'openid_relying_party' must contain the parameter response_types and it has to be a JSON array containing the value 'code',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'contacts' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the contacts parameter,In this test the SA metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter contacts,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_fetch_endpoint' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the federation_fetch_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter federation_fetch_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_list_endpoint' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the federation_list_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter federation_list_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_resolve_endpoint' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the federation_resolve_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter federation_resolve_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'federation_trust_mark_status_endpoint' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the federation_trust_mark_status_endpoint parameter,In this test the SA metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter federation_trust_mark_status_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'homepage_uri' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the homepage_uri parameter,In this test the SA metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter homepage_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'logo_uri' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the logo_uri parameter,In this test the SA metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter logo_uri and it must be in SVG format,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'organization_name' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the organization_name parameter,In this test the SA metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter organization_name,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
SA-Entity Configuration response-metadata-value,In this test the SA metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the SA metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the SA contains the 'federation_entity' type in the metadata and it contains the 'policy_uri' parameter, not compliant otherwise",Entity Configuration response,Does the SA's metadata contain the policy_uri parameter,In this test the SA metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,SA,The TA and SA metadata must contain the parameter policy_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'contacts' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the contacts parameter,In this test the Entity metadata are taken and the presence of the 'contacts' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter contacts,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_fetch_endpoint' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the federation_fetch_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_fetch_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter federation_fetch_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_list_endpoint' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the federation_list_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_list_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter federation_list_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_resolve_endpoint' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the federation_resolve_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_resolve_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter federation_resolve_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'federation_trust_mark_status_endpoint' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the federation_trust_mark_status_endpoint parameter,In this test the Entity metadata are taken and the presence of the 'federation_trust_mark_status_endpoint' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter federation_trust_mark_status_endpoint,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'homepage_uri' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the homepage_uri parameter,In this test the Entity metadata are taken and the presence of the 'homepage_uri' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter homepage_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'logo_uri' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the logo_uri parameter,In this test the Entity metadata are taken and the presence of the 'logo_uri' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter logo_uri and it must be in SVG format,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'organization_name' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the organization_name parameter,In this test the Entity metadata are taken and the presence of the 'organization_name' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter organization_name,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""federation_entity"" subclaim. (For details see coverage.md)",
TA-Entity Configuration response TA-metadata-value,In this test the Entity metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,Trigger In this test the Entity metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,"Compliant if the TA contains the 'federation_entity' type in the metadata and it contains the 'policy_uri' parameter, not compliant otherwise",Entity Configuration response TA,Does the Entity's metadata contain the policy_uri parameter,In this test the Entity metadata are taken and the presence of the 'policy_uri' parameter inside the 'federation_entity' metadata type is checked.,TA,The TA and SA metadata must contain the parameter policy_uri,SPID_CIE_OIDC#TA-and-SA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_ta_sa.html,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Compliant if the logo_uri claim is present in the trust_mark JWT in the trust_marks parameter, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",TA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the claims_parameter_supported parameter inside the openid_provider type is checked","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the claims_parameter_supported parameter inside the openid_provider type is checked","Compliant if the claims_parameter_supported parameter is present in the openid_provider type, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the claims_parameter_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the claims_parameter_supported parameter inside the openid_provider type is checked",TA,The claims_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked","Compliant if the token_endpoint_auth_methods_supported parameter is present in the openid_provider type, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct token_endpoint_auth_methods_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked",TA,The token_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked.,Trigger In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked.,"Compliant if the token_endpoint_auth_methods_supported claim is present, not compliant otherwise.",Entity Configuration response,Does the AA metadata contain the token_endpoint_auth_methods_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the presence of the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked.,AA,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_methods_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,In this test the AA metadata in the AA Entity Configuration are taken and the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked. It must contain the key-value pair 'one_of': ['private_key_jwt'],Trigger In this test the AA metadata in the AA Entity Configuration are taken and the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked. It must contain the key-value pair 'one_of': ['private_key_jwt'],"Compliant if the token_endpoint_auth_methods_supported claim is present and contains the value 'one_of': ['private_key_jwt'], not compliant otherwise.",Entity Configuration response,Does the AA metadata contain the token_endpoint_auth_methods_supported claim,In this test the AA metadata in the AA Entity Configuration are taken and the token_endpoint_auth_methods_supported claim in the 'oauth_authorization_server' entity type is checked. It must contain the key-value pair 'one_of': ['private_key_jwt'],AA,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_methods_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked to be 'one_of': ['RS256', 'RS512'].","Trigger In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked to be 'one_of': ['RS256', 'RS512'].","Compliant if the token_endpoint_auth_signing_alg_values_supported claim is 'one_of': ['RS256', 'RS512'], not compliant if it is empty or is missing",Entity Configuration response,Does the AA metadata contain correct token_endpoint_auth_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked to be 'one_of': ['RS256', 'RS512'].",AA,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked to be [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]","Trigger In this test the OP metadata are taken and the value of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked to be [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]","Compliant if the acr_values_supported ('openid_provider' type) parameter in the OP metadata is [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct acr_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'acr_values_supported' in the 'openid_provider' subclaim (metadata type) parameter is checked to be [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]",OP,"The OP metadata of type 'openid_provider' must contain the parameter 'acr_values_supported' and it must be set to [https://www.spid.gov.it/SpidL1, https://www.spid.gov.it/SpidL2, https://www.spid.gov.it/SpidL3]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the value of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be 'S256',Trigger In this test the OP metadata are taken and the value of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be 'S256',"Compliant if the 'code_challenge_methods_supported' parameter in the OP metadata ('openid_provider' type) is 'S256', not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct code_challenge_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'code_challenge_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be 'S256',OP,The OP metadata of type 'openid_provider' must contain the parameter 'code_challenge_methods_supported' and it must be set to 'S256',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [refresh_token, authorization_code]","Trigger In this test the OP metadata are taken and the value of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [refresh_token, authorization_code]","Compliant if the grant_types_supported parameter in the OP metadata ('openid_provider' type) is [refresh_token, authorization_code], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct grant_types_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'grant_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [refresh_token, authorization_code]",OP,"The OP metadata of type 'openid_provider' must contain the parameter 'grant_types_supported' and it must be set to [refresh_token, authorization_code]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the 'id_token_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RSA-OAEP', 'RSA-OAEP-256'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct id_token_encryption_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RSA-OAEP', 'RSA-OAEP-256']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In this test the OP metadata are taken and the value of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the 'id_token_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is ['A128CBC-HS256', 'A256CBC-HS512'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct id_token_encryption_enc_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['A128CBC-HS256', 'A256CBC-HS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']","Trigger In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']","Compliant if the 'id_token_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RS256', 'RS512']. Not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct id_token_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has id_token_signing_alg_values_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be the URL of the OP,Trigger In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be the URL of the OP,"Compliant if the issuer parameter in the OP metadata ('openid_provider' type) identifies the OP, not Compliant otherwise",Entity Configuration response,Does the OP metadata contain a correct issuer parameter,In this test the OP metadata are taken and the presence of the 'issuer' parameter in the 'openid_provider' subclaim (metadata type) is checked to be the URL of the OP,OP,"The OP metadata of type 'openid_provider' must contain the parameter 'issuer' and it must contain an HTTPS URL that uniquely identifies the OP, without query of fragment components.",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,config has issuer,"The fact of not having fragments or query components is written in the link (https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata) in the description of the claim. Maybe it could be made more clear. external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']","Trigger In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']","Compliant if the 'request_object_signing_alg_values_supported' parameter is ['RS256', 'RS512'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct request_object_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be ['RS256', 'RS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'request_object_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [form_post, query]","Trigger In this test the OP metadata are taken and the value of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [form_post, query]","Compliant if the response_modes_supported parameter in the OP metadata ('openid_provider' type) is [form_post, query], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct response_modes_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'response_modes_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked to be [form_post, query]",OP,"The OP metadata of type 'openid_provider' must contain the parameter 'response_modes_supported' and it must be set to [form_post, query]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present and must be set to 'code',Trigger In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present and must be set to 'code',"Compliant if the response_types_supported parameter in the OP metadata ('openid_provider' type) is 'code', not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct response_types_supported claim,In this test the OP metadata are taken and the presence of the 'response_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must be present and must be set to 'code',OP,The OP metadata of type 'openid_provider' must contain the parameter 'response_types_supported' and it must be set to 'code',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has response_types_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the value of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'private_key_jwt',Trigger In this test the OP metadata are taken and the value of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'private_key_jwt',"Compliant if the 'revocation_endpoint_auth_methods_supported' parameter in the OP metadata ('openid_provider' type) is 'private_key_jwt', not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct revocation_endpoint_auth_methods_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'revocation_endpoint_auth_methods_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'private_key_jwt',OP,The OP metadata of type 'openid_provider' must contain the parameter 'revocation_endpoint_auth_methods_supported' and it must be set to 'private_key_jwt',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,,
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is [openid, offline_access, profile, email]","Trigger In this test the OP metadata are taken and the value of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is [openid, offline_access, profile, email]","Compliant if the scopes_supported parameter in the OP metadata ('openid_provider' type) is [openid, offline_access, profile, email], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct scopes_supported claim,"In this test the OP metadata are taken and the value of the 'scopes_supported' parameter in the 'openid_provider' subclaim (metadata type) is [openid, offline_access, profile, email]",OP,"The OP metadata of type 'openid_provider' must contain the parameter 'scopes_supported' and it must be set to [openid, offline_access, profile, email]",SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the value of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'pairwise',Trigger In this test the OP metadata are taken and the value of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'pairwise',"Compliant if the subject_types_supported parameter in the OP metadata ('openid_provider' type) is 'pairwise', not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct subject_types_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'subject_types_supported' parameter in the 'openid_provider' subclaim (metadata type) is 'pairwise',OP,The OP metadata of type 'openid_provider' must contain the parameter 'subject_types_supported' and it must be set to 'pairwise',SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has subject_types_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the 'userinfo_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RSA-OAEP', 'RSA-OAEP-256'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct userinfo_encryption_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RSA-OAEP', 'RSA-OAEP-256']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In this test the OP metadata are taken and the value of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the 'userinfo_encryption_enc_values_supported' parameter in the OP metadata ('openid_provider' type) is ['A128CBC-HS256', 'A256CBC-HS512'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct userinfo_encryption_enc_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_encryption_enc_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['A128CBC-HS256', 'A256CBC-HS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_enc_values_supported' and it must contain the content encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RS256', 'RS512']","Trigger In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RS256', 'RS512']","Compliant if the 'userinfo_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) is ['RS256', 'RS512']. Not Compliant otherwise",Entity Configuration response,Does the OP metadata contain correct userinfo_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is ['RS256', 'RS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the value of the 'client_registration_types' parameter is 'automatic',Trigger In this test the RP metadata are taken and the value of the 'client_registration_types' parameter is 'automatic',Compliant if the 'client_registration_types' parameter in the RP metadata is 'automatic'. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain correct 'client_registration_types' parameter,In this test the RP metadata are taken and the value of the 'client_registration_types' parameter is 'automatic',RP,The RP metadata of type 'openid_relying_party' must contain the parameter client_registration_types and it has to be set to 'automatic'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the value of the 'grant_types' parameter contains 'authorization_code' and 'refresh_token',Trigger In this test the RP metadata are taken and the value of the 'grant_types' parameter contains 'authorization_code' and 'refresh_token',"Compliant if the 'grant_types' parameter in the RP metadata is ['authorization_code', 'refresh_token'], not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct grant_types claim,In this test the RP metadata are taken and the value of the 'grant_types' parameter contains 'authorization_code' and 'refresh_token',RP,The RP metadata of type 'openid_relying_party' must contain the parameter grant_types and it must be a JSON array containing 'authorization_code' and 'refresh_token',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the 'id_token_encrypted_response_alg' parameter in the RP metadata is ['RSA-OAEP', 'RSA-OAEP-256']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct 'id_token_encrypted_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']",RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].","Trigger In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].","Compliant if the 'id_token_encrypted_response_enc' parameter in the RP metadata is ['A128CBC-HS256', 'A256CBC-HS512']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct 'id_token_encrypted_response_enc' parameter,"In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].",RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_enc and it has to contain the content encryption algorithms. This parameter is required only if the id_token_encrypted_response_alg is given,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,This parameter is required only if the id_token_encrypted_response_alg is given,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is ['RS256', 'RS512']","Trigger In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is ['RS256', 'RS512']","Compliant if the 'id_token_signed_response_alg' parameter in the RP metadata is ['RS256', 'RS512']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct 'id_token_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is ['RS256', 'RS512']",RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the value of the 'token_endpoint_auth_method' parameter is 'one_of': 'private_key_jwt',Trigger In this test the RP metadata are taken and the value of the 'token_endpoint_auth_method' parameter is 'one_of': 'private_key_jwt',Compliant if the 'token_endpoint_auth_method' parameter in the RP metadata is 'one_of': 'private_key_jwt'. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain correct 'token_endpoint_auth_method' parameter,In this test the RP metadata are taken and the value of the 'token_endpoint_auth_method' parameter is 'one_of': 'private_key_jwt',RP,The RP metadata of type 'openid_relying_party' must contain the parameter token_endpoint_auth_method and it has to be set to 'private_key_jwt'.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the 'userinfo_encrypted_response_alg' parameter in the RP metadata is ['RSA-OAEP', 'RSA-OAEP-256']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct 'userinfo_encrypted_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is ['RSA-OAEP', 'RSA-OAEP-256']",RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].","Trigger In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].","Compliant if the 'userinfo_encrypted_response_enc' parameter in the RP metadata is ['A128CBC-HS256', 'A256CBC-HS512']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct 'userinfo_encrypted_response_enc' parameter,"In this test the RP metadata are taken and the presence of the 'userinfo_encrypted_response_enc' parameter is ['A128CBC-HS256', 'A256CBC-HS512'].",RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_enc and it has to contain the content encryption algorithms.,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is ['RS256', 'RS512']","Trigger In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is ['RS256', 'RS512']","Compliant if the 'userinfo_signed_response_alg' parameter in the RP metadata is ['RS256', 'RS512']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain correct 'userinfo_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is ['RS256', 'RS512']",RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' contains the value 'code',Trigger In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' contains the value 'code',Compliant if the 'response_types' parameter in the RP metadata contains the value 'code'. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain in the 'response_types' the value 'code',In this test the RP metadata are taken and the 'response_types' parameter in the 'openid_relying_party' contains the value 'code',RP,The RP metadata of type 'openid_relying_party' must contain the parameter response_types and it has to be a JSON array containing the value 'code',SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
SA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the SA, an entity statement for an RP must be fetched in the SA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations","Trigger In order to check the compliance of a metadata policy issued by the SA, an entity statement for an RP must be fetched in the SA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations","Compliant if the jwks parameter is present in the openid_relying_party type and it contains the RP's JWKS (type json), not compliant otherwise",Entity Statement response RP,Does the SA's metadata policy for an RP contain the jwks parameter,"In order to check the compliance of a metadata policy issued by the SA, an entity statement for an RP must be fetched in the SA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations",SA,The jwks claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that an SA establishes for an RP that is its direct descendant,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must be a JSON object containing the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must be a JSON object containing the key 'subset_of'","Compliant if the acr_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct acr_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must be a JSON object containing the key 'subset_of'",TA,The acr_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must contain the value 'subset_of': ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must contain the value 'subset_of': ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']","Compliant if the acr_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct acr_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the acr_values_supported parameter inside the openid_provider type is checked. It must contain the value 'subset_of': ['https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2', 'https://www.spid.gov.it/SpidL3']",TA,The acr_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked","Compliant if the authorization_response_iss_parameter_supported parameter is present in the openid_provider type, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the authorization_response_iss_parameter_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked",TA,The authorization_response_iss_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the authorization_response_iss_parameter_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct authorization_response_iss_parameter_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The authorization_response_iss_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']","Compliant if the authorization_response_iss_parameter_supported parameter is present in the openid_provider type and contains the value 'one_of': ['true'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct authorization_response_iss_parameter_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the authorization_response_iss_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']",TA,The authorization_response_iss_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the claims_parameter_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct claims_parameter_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The claims_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']","Compliant if the claims_parameter_supported parameter is present in the openid_provider type and contains the value 'one_of': ['true'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct claims_parameter_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the claims_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['true']",TA,The claims_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types_supported parameter inside the openid_provider type is checked","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types_supported parameter inside the openid_provider type is checked","Compliant if the client_registration_types_supported parameter is present in the openid_provider type, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the client_registration_types_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types_supported parameter inside the openid_provider type is checked",TA,The client_registration_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",Compliant if the client_registration_types_supported parameter is present in the openid_provider type and contains the key 'one_of' not compliant otherwise,Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct client_registration_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The client_registration_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['automatic']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['automatic']","Compliant if the client_registration_types_supported parameter is present in the openid_provider type and contains the value 'one_of': ['automatic'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct client_registration_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the client_registration_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued as ['automatic']",TA,The client_registration_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the code_challenge_methods_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct code_challenge_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The code_challenge_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['S256']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['S256']","Compliant if the code_challenge_methods_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['S256'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct code_challenge_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the code_challenge_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['S256']",TA,The code_challenge_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the grant_types_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct grant_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The grant_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['refresh_token', 'authorization_code']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['refresh_token', 'authorization_code']","Compliant if the grant_types_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['refresh_token', 'authorization_code'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct grant_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['refresh_token', 'authorization_code']",TA,The grant_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the id_token_encryption_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The id_token_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and must be valued as ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and must be valued as ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the id_token_encryption_enc_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_enc_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and must be valued as ['A128CBC-HS256', 'A256CBC-HS512']",TA,The id_token_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the id_token_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The id_token_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,message type - validate | {head/body/url} | jwt_name | {header/payload} | param_path,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['RS256', 'RS512']","Compliant if the id_token_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it must be valued as ['RS256', 'RS512']",TA,The id_token_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,message type - validate | {head/body/url} | jwt_name | {header/payload} | param_path | param_value1 | param_value2 | ...,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the token_endpoint_auth_signing_alg_values_supported parameter is present in the openid_provider type and not contains the values ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the token_endpoint_auth_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The token_endpoint_auth_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_provider type is checked. It must contain the RP JWKS related to the OIDC Core operations","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_provider type is checked. It must contain the RP JWKS related to the OIDC Core operations","Compliant if the jwks parameter is present, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the jwks parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_provider type is checked. It must contain the RP JWKS related to the OIDC Core operations",TA,The jwks claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_methods_supported parameter inside the openid_provider type is checked","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_methods_supported parameter inside the openid_provider type is checked","Compliant if the request_authentication_methods_supported parameter is present in the openid_provider type, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the request_authentication_methods_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_methods_supported parameter inside the openid_provider type is checked",TA,The request_authentication_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,message type - validate | {head/body/url} | jwt_name | {header/payload} | param_path,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the request_authentication_methods_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The request_authentication_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued with ['request_object']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued with ['request_object']","Compliant if the request_authentication_methods_supported parameter is present in the openid_provider type and the key 'one_of' is valued with ['request_object'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_authentication_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' and it must be valued with ['request_object']",TA,The request_authentication_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the request_authentication_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The request_authentication_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued as ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued as ['RS256', 'RS512']","Compliant if the request_authentication_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_authentication_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued as ['RS256', 'RS512']",TA,The request_authentication_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_parameter_supported parameter inside the openid_provider type is checked","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_parameter_supported parameter inside the openid_provider type is checked","Compliant if the request_parameter_supported parameter is present in the openid_provider type, not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the request_parameter_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_parameter_supported parameter inside the openid_provider type is checked",TA,The request_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the request_parameter_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_parameter_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The request_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['true']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['true']","Compliant if the request_parameter_supported parameter is present in the openid_provider type and contains the value 'one_of': ['true'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct request_parameter_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the request_parameter_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['true']",TA,The request_parameter_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the response_modes_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_modes_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The response_modes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it is valued with['form_post', 'query']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it is valued with['form_post', 'query']","Compliant if the response_modes_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['form_post', 'query'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_modes_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_modes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' and it is valued with['form_post', 'query']",TA,The response_modes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the response_types_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The response_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['code']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['code']","Compliant if the response_types_supported parameter is present in the openid_provider type and contains the value 'one_of': ['code'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct response_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the response_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['code']",TA,The response_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the revocation_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct revocation_endpoint_auth_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The revocation_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']","Compliant if the revocation_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the value 'one_of': ['private_key_jwt'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct revocation_endpoint_auth_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the revocation_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']",TA,The revocation_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the scopes_supported parameter is present in the openid_provider typeand contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct scopes_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The scopes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['openid', 'offline_access', 'profile', 'email']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['openid', 'offline_access', 'profile', 'email']","Compliant if the scopes_supported parameter is present in the openid_provider typeand contains the value 'subset_of': ['openid', 'offline_access', 'profile', 'email'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct scopes_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the scopes_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['openid', 'offline_access', 'profile', 'email']",TA,The scopes_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the subject_types_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct subject_types_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The subject_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['pairwise']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['pairwise']","Compliant if the subject_types_supported parameter is present in the openid_provider type and contains the value 'one_of': ['pairwise'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct subject_types_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the subject_types_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['pairwise']",TA,The subject_types_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Token response-metadata-value,Token Response to a request with refresh token ,Token request with offline_access grant type and a valid refresh token in it,"Compliant if the response has a new refresh token, not compliant otherwise",Token response,Does the OP use token rotation,A Token Request with the grant_type=refresh_token and the refresh token in it is sent. The response must contain a new refresh token.,OP,"For security reasons, an OP MUST return, along with a new Access Token, also a new Refresh Token, invalidating all previously issued tokens (refresh token rotation) to the RP and related to the end-user",SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,Is refresh token rotation used (UsesTokenRotation),,,
OP-Token response-metadata-value,Token response to a request with a client assertion with a jti already used,Token request with a client assertion with a jti already used in the life time of the JWT (JWT replay),"Compliant if the Token Response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the token response to a token request made with a client_assertion parameter containing an already used jti in the JWT return a Token Error response,In this test the Token Request's 'client_assertion' field is set to a wrong JWT. In particular the jti has already been used.,OP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the jti claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,Userinfo response to a request with an Access token whose refresh token was revoked,Userinfo request with an Access Token whose corresponding refresh_token was revoked,"Compliant if the Userinfo Response is an HTTP 400 because of invalid_grant, not compliant otherwise",Userinfo response,Does the OP revoke the Access Tokens when revoking a refresh token,"In order to test if the OP revokes an Access token together with the refresh token revocation, an authentication flow of type offline_access is computed. After this, a revocation request for the refresh token is accomplished and a new userinfo request using the access token is made. This procedure must be done inside the expiration time of the access token. The expected response is an error from the OP",OP,"If the token passed to the request is a Refresh Token, the OP MUST revoke the respective Access Token as well, if it is not expired yet",SPID_CIE_OIDC#revocation-endpoint; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html,OIDC Core,Are access tokens revoked after refresh token revocation (RefreshRevokesAccess),,,
OP-Userinfo response-metadata-value,Userinfo response to a request with an Access Token with a wrong payload,Userinfo request with an Access Token with a wrong payload,"Compliant if the Userinfo Response is an HTTP 401 because of invalid_grant, not compliant otherwise",Userinfo response,Does the OP correctly validate the Access Tokens,"In order to test if the OP's UserInfo endpoint correctly validates the Access Tokens, a UserInfo Request with an Access Token with a wrong payload is sent and the OP's response analyzed",OP,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,The Content-Type of the UserInfo response must be set to 'application/jwt' ,Trigger The Content-Type of the UserInfo response must be set to 'application/jwt' ,"Compliant if the Content-Type is 'application/jwt', not compliant otherwise",Userinfo response,Does the Content-Type of the UserInfo response set to 'application/jwt' ,The Content-Type of the UserInfo response must be set to 'application/jwt' ,OP,Tthe Content-Type of the UserInfo response must be set to 'application/jwt',SPID_CIE_OIDC#UserInfo Response#response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,ONLY FOR SPID,
OP-Userinfo response-metadata-value,Userinfo response to a request with a refreshed Access token,"Trigger In this test the offline access flow is accomplished, obtaining a refresh token and an access token. After this, a UserInfo request is sent with the access token and the released information saved. Once obtained the information, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The access token included in the latter response is then taken, a UserInfo Request is made with it and the results compared. The last UserInfo Response must contain exactly the claims issued with the previous one to a refreshed access token","Compliant if the claim issued by the two UserInfo response are the same, not compliant otherwise",Userinfo response,Does the OP release only previously accepted information when presenting a refresh token,"In this test the offline access flow is accomplished, obtaining a refresh token and an access token. After this, a UserInfo request is sent with the access token and the released information saved. Once obtained the information, a new token request is done with 'grant_type=refresh_token' and the refresh token inserted in the 'refresh_token' parameter. The access token included in the latter response is then taken, a UserInfo Request is made with it and the results compared. The last UserInfo Response must contain exactly the claims issued with the previous one",OP,The Refresh Token MAY be used as a mechanism to obtain from the UserInfo endpoint only the same set of user attributes requested at the initial authentication phase and for which the user has given explicit consent,SPID_CIE_OIDC#Refresh-token https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'","Compliant if the token_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the key 'one_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the token_endpoint_auth_methods_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of'",TA,The token_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']","Compliant if the token_endpoint_auth_methods_supported parameter is present in the openid_provider type and contains the value 'one_of': ['private_key_jwt'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain the token_endpoint_auth_methods_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the token_endpoint_auth_methods_supported parameter inside the openid_provider type is checked. It must contain the key 'one_of' valued with ['private_key_jwt']",TA,The token_endpoint_auth_methods_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the token_endpoint_auth_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct token_endpoint_auth_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The token_endpoint_auth_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Compliant if the token_endpoint_auth_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct token_endpoint_auth_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,The token_endpoint_auth_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_encryption_alg_values_supported parameter is presentin the openid_provider type and contains the key 'subset_of', not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The userinfo_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the userinfo_encryption_alg_values_supported parameter is presentin the openid_provider type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,The userinfo_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_encryption_enc_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_enc_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The userinfo_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the userinfo_encryption_enc_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_encryption_enc_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_enc_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,The userinfo_encryption_enc_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_signing_alg_values_supported parameter is present in the openid_provider type and contains the key 'subset_of', not compliant if is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_signing_alg_values_supported parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of'",TA,The userinfo_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Compliant if the userinfo_signing_alg_values_supported parameter is present in the openid_provider type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if is missing or empty",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct userinfo_signing_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,The userinfo_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'","Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the key 'one_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct client_registration_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'",TA,The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['automatic']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['automatic']","Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the value 'one_of': ['automatic'], not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct client_registration_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['automatic']",TA,The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the grant_types parameter inside the openid_relying_party type is present and it contains the key 'subset_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct grant_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with '[authorization_code, refresh_token]'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with '[authorization_code, refresh_token]'","Compliant if the grant_types parameter inside the openid_relying_party type is present and it contains the value 'subset_of: [authorization_code, refresh_token]', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct grant_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with '[authorization_code, refresh_token]'",TA,The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"After a successful Authentication Request with a scope 'openid profile' , a valid Access Token obtained from the OP is sent to the OP's userinfo endpoint using an HTTP GET request. If the userinfo endpoint returns a signed and encrypted JWT containing the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier), the OP is compliant with the specification.","UserInfo request via HTTP GET with scope ""openid profile""","Compliant if the JWT in the body of the response contains  the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier). Not compliant otherwise",Userinfo response,Does the OP give the correct claims through HTTP GET at the userinfo endpoint,"After a successful Authentication Request with a scope 'openid profile' , a valid Access Token obtained from the OP is sent to the OP's userinfo endpoint using an HTTP GET request. If the userinfo endpoint returns a signed and encrypted JWT containing the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier), the OP is compliant with the specification.",OP,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,Is JWT authentication implemented (SupportsJwtClientAuthentication),"Has userinfo endpoint, Userinfo Endpoint access with header method",,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the id_token_encrypted_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the id_token_encrypted_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the id_token_encrypted_response_enc parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the id_token_encrypted_response_enc parameter is present in the openid_relying_party type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,A correct UserInfo request is made to the UserInfo endpoint (it must contain the parameter Authorization: Bearer <token> in the header) and the response analyzed. The HTTP code must be 200,Trigger A correct UserInfo request is made to the UserInfo endpoint (it must contain the parameter Authorization: Bearer <token> in the header) and the response analyzed. The HTTP code must be 200,"Compliant if the HTTP status code is 200, not compliant otherwise",Userinfo response,Does the HTTP status code of the UserInfo response is 200,A correct UserInfo request is made to the UserInfo endpoint (it must contain the parameter Authorization: Bearer <token> in the header) and the response analyzed. The HTTP code must be 200,OP,The HTTP status code of the UserInfo response is 200,SPID_CIE_OIDC#UserInfo Response#response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the id_token_signed_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant if it is missing or empty",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Compliant if the id_token_signed_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct id_token_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'","Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the key 'one_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct token_endpoint_auth_method parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of'",TA,The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['private_key']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['private_key']","Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the value 'one_of': ['private_key'], not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct token_endpoint_auth_method parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the openid_relying_party type is checked. It must contain the key 'one_of' valued with ['private_key']",TA,The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"In order to guarantee confidentiality, the Userinfo Response's JWE must be encrypted with the RP's public key, so that only the intended RP is able to decrypt it. In this test a correct request is made and the correctness of the encryption of the JWT is checked by trying to decrypt the payload with the RP's private key","Trigger In order to guarantee confidentiality, the Userinfo Response's JWE must be encrypted with the RP's public key, so that only the intended RP is able to decrypt it. In this test a correct request is made and the correctness of the encryption of the JWT is checked by trying to decrypt the payload with the RP's private key",Compliant if the JWT in the payload of the response can be decrypted with the RP's private key,Userinfo response,Does Userinfo endpoint encrypt the JWE in the response with the RP's public key,"In order to guarantee confidentiality, the Userinfo Response's JWE must be encrypted with the RP's public key, so that only the intended RP is able to decrypt it. In this test a correct request is made and the correctness of the encryption of the JWT is checked by trying to decrypt the payload with the RP's private key",OP,The content of the Response body MUST be a signed and encrypted JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_encrypted_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant if it is missing or empty",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the cty parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the cty parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the cty parameter (Content Type) configured to JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the userinfo_encrypted_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the cty parameter set to 'JWT', not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct cty parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the cty parameter (Content Type) configured to JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'aud' parameter in the payload, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'aud' parameter in the payload, then it is compliant with the specification","Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the aud parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the aud parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'aud' parameter in the payload, then it is compliant with the specification",OP,The JWT payload is a JSON containing the aud parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'aud' parameter in the payload is set to the RP's identifier, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'aud' parameter in the payload is set to the RP's identifier, then it is compliant with the specification","Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the aud parameter set to the RP's identifier, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct aud parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'aud' parameter in the payload is set to the RP's identifier, then it is compliant with the specification",OP,"The JWT payload is a JSON containing the aud parameter, which must be the RP's identifier",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iss' parameter in the payload, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iss' parameter in the payload, then it is compliant with the specification","Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the iss parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the iss parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iss' parameter in the payload, then it is compliant with the specification",OP,The JWT payload is a JSON containing the iss parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iss' parameter in the payload is set to the OP's identifier, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iss' parameter in the payload is set to the OP's identifier, then it is compliant with the specification","Compliant if the value of the iss parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is an URL identifying the OP, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct iss parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iss' parameter in the payload is set to the OP's identifier, then it is compliant with the specification",OP,The JWT payload is a JSON containing the iss parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'sub' parameter in the payload, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'sub' parameter in the payload, then it is compliant with the specification","Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the sub parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the sub parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'sub' parameter in the payload, then it is compliant with the specification",OP,The JWT payload is a JSON containing the sub parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,Userinfo has sub claim,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'sub' parameter in the payload is set to the same value set in the ID Token, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'sub' parameter in the payload is set to the same value set in the ID Token, then it is compliant with the specification","Compliant if the value of the sub parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is the same as the one sent in the ID Token, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct sub parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'sub' parameter in the payload is set to the same value set in the ID Token, then it is compliant with the specification",OP,The JWT payload is a JSON containing the sub parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,Userinfo has sub claim,,
OP-Userinfo response-metadata-value,"In order to guarantee integrity, the Userinfo Response's JWE must be signed with the OP's private key, so that everyone in possess of the OP's public key can decrypt it and verify that it was issued by the OP. In this test a correct request is made and the correctness of the signature of the JWE is checked using the OP's public key","Trigger In order to guarantee integrity, the Userinfo Response's JWE must be signed with the OP's private key, so that everyone in possess of the OP's public key can decrypt it and verify that it was issued by the OP. In this test a correct request is made and the correctness of the signature of the JWE is checked using the OP's public key","Compliant if the signature verification of the JWE in the payload of the response is valid using the OP's public key, not compliant otherwise",Userinfo response,Does Userinfo endpoint sign the JWE in the response with the OP's private key,"In order to guarantee integrity, the Userinfo Response's JWE must be signed with the OP's private key, so that everyone in possess of the OP's public key can decrypt it and verify that it was issued by the OP. In this test a correct request is made and the correctness of the signature of the JWE is checked using the OP's public key",OP,The content of the Response body MUST be a signed and encrypted JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain the userinfo_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the enc parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the enc parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the enc parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the userinfo_encrypted_response_enc parameter is present in the openid_relying_party type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain the userinfo_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the enc parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct enc parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the enc parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'exp' parameter in the payload, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'exp' parameter in the payload, then it is compliant with the specification","Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the exp parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain exp parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'exp' parameter in the payload, then it is compliant with the specification",OP,The JWS header is a JSON containing the exp parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'exp' parameter in the payload is a UNIX time, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'exp' parameter in the payload is a UNIX time, then it is compliant with the specification","Compliant if the exp parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is a valid unix time, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct exp parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'exp' parameter in the payload is a UNIX time, then it is compliant with the specification",OP,The JWS header is a JSON containing the exp parameter as a valid unix time,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iat' parameter in the payload, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iat' parameter in the payload, then it is compliant with the specification","Compliant if in the payload of the JWS contained in the payload of the JWE in the body of the response there is the iat parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain iat parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'iat' parameter in the payload, then it is compliant with the specification",OP,The JWS header is a JSON containing the iat parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_signed_response_alg parameter is present in the openid_relying_party type and contains the key 'subset_of', not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of'",TA,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Compliant if the userinfo_signed_response_alg parameter is present in the openid_relying_party type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response RP,Does the TA's metadata policy for an RP contain a correct userinfo_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of'","Compliant if the client_registration_types parameter is present in the intermediary type and contains the key 'one_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct client_registration_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of'",TA,The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['automatic']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['automatic']","Compliant if the client_registration_types parameter is present in the intermediary type and contains the value 'one_of': ['automatic'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct client_registration_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the client_registration_types parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['automatic']",TA,The client_registration_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the grant_types parameter is present in the intermediary type and it contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct grant_types parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,From the trust marks table I assumed the correct type is intermediary,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of' values with ['authorization_code', 'refresh_token']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of' values with ['authorization_code', 'refresh_token']","Compliant if the grant_types parameter is present in the intermediary type and it contains the value 'subset_of: [authorization_code, refresh_token]', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct grant_types parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the grant_types parameter inside the intermediary type is checked. It must contain the key 'subset_of' values with ['authorization_code', 'refresh_token']",TA,The grant_types claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,From the trust marks table I assumed the correct type is intermediary,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the id_token_encrypted_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of': valued with ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of': valued with ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the id_token_encrypted_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of': valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the id_token_encrypted_response_enc parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the id_token_encrypted_response_enc parameter is present in the intermediary type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,The id_token_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the id_token_signed_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Compliant if the id_token_signed_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct id_token_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of'","Compliant if the token_endpoint_auth_method parameter is present in the intermediary type and contains the key  'one_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct token_endpoint_auth_method parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of'",TA,The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['private_key']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['private_key']","Compliant if the token_endpoint_auth_method parameter is present in the intermediary type and contains the value 'one_of': ['private_key'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct token_endpoint_auth_method parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the token_endpoint_auth_method parameter inside the intermediary type is checked. It must contain the key 'one_of' valued with ['private_key']",TA,The token_endpoint_auth_method claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_encrypted_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']","Compliant if the userinfo_encrypted_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RSA-OAEP', 'RSA-OAEP-256'], not compliant if it is missing or empty",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RSA-OAEP', 'RSA-OAEP-256']",TA,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_encrypted_response_enc parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_enc parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']","Compliant if the userinfo_encrypted_response_enc parameter is present in the intermediary type and contains the value 'subset_of': ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_encrypted_response_enc parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_enc parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['A128CBC-HS256', 'A256CBC-HS512']",TA,The userinfo_encrypted_response_enc claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'","Compliant if the userinfo_signed_response_alg parameter is present in the intermediary type and contains the key 'subset_of', not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_signed_response_alg parameter key,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of'",TA,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']","Compliant if the userinfo_signed_response_alg parameter is present in the intermediary type and contains the value 'subset_of': ['RS256', 'RS512'], not compliant if it is missing or empty",Entity Statement response SA,Does the TA's metadata policy for an SA contain a correct userinfo_signed_response_alg parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. It must contain the key 'subset_of' valued with ['RS256', 'RS512']",TA,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the dpop_signing_alg_values_supported claim does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",Entity Configuration response,Does the AA metadata contain incorrect dpop_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the dpop_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",AA,The AA Metadata of type 'oauth_authorization_server' MUST contain dpop_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the token_endpoint_auth_signing_alg_values_supported claim does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",Entity Configuration response,Does the AA metadata contain incorrect token_endpoint_auth_signing_alg_values_supported claim,"In this test the AA metadata in the AA Entity Configuration are taken and the value of the token_endpoint_auth_signing_alg_values_supported claim in the 'oauth_authorization_server' entity type is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",AA,The AA Metadata of type 'oauth_authorization_server' MUST contain token_endpoint_auth_signing_alg_values_supported,SPID_CIE_OIDC#AA-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_aa.html,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the value ['RSA_1_5'],Trigger In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the value ['RSA_1_5'],"Compliant if the 'id_token_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain ['RSA_1_5'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain an incorrect id_token_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'id_token_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the value ['RSA_1_5'],OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the 'id_token_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",Entity Configuration response,Does the OP metadata contain incorrect id_token_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'id_token_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'id_token_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,Config has id_token_signing_alg_values_supported,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the 'request_object_signing_alg_values_supported' parameter does not contain ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain incorrect request_object_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'request_object_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'request_object_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['RSA_1_5'],Trigger In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['RSA_1_5'],"Compliant if the 'userinfo_encryption_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain the value ['RSA_1_5'], not Compliant otherwise",Entity Configuration response,Does the OP metadata contain incorrect userinfo_encryption_alg_values_supported claim in the openid_provider subclaim,In this test the OP metadata are taken and the value of the 'userinfo_encryption_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['RSA_1_5'],OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_encryption_alg_values_supported' and it must contain the key encryption algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
OP-Entity Configuration response-metadata-value,"In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the 'userinfo_signing_alg_values_supported' parameter in the OP metadata ('openid_provider' type) does not contain ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",Entity Configuration response,Does the OP metadata contain incorrect userinfo_signing_alg_values_supported claim in the openid_provider subclaim,"In this test the OP metadata are taken and the value of the 'userinfo_signing_alg_values_supported' parameter in the 'openid_provider' subclaim (metadata type) is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512']",OP,The OP metadata of type 'openid_provider' must contain the parameter 'userinfo_signing_alg_values_supported' and it must contain the signature algorithms,SPID_CIE_OIDC#OP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_op.html,OIDC Core,,,"external tests from spid-oidc-check-op have an implementation issue: in those tests the presence of the claims is directly in the ""Metadata"" parameter of the document. In CIE federation instead, in the metadata paramter there are two subclaims ( ""federation_entity"" and ""openid_relying_party"") and the claims that the tests checks are in the ""openid_relying_party"" subclaim. (For details see coverage.md)",
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,Trigger In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,Compliant if the 'id_token_encrypted_response_alg' parameter in the RP metadata does not contain the value ['RSA_1_5']. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain incorrect 'id_token_encrypted_response_alg' parameter,In this test the RP metadata are taken and the value of the 'id_token_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].","Trigger In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].","Compliant if the 'id_token_signed_response_alg' parameter in the RP metadata does not contain ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain incorrect 'id_token_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'id_token_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].",RP,The RP metadata of type 'openid_relying_party' must contain the parameter id_token_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,Trigger In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,Compliant if the 'userinfo_encrypted_response_alg' parameter in the RP metadata does not contain the value ['RSA_1_5']. Not Compliant otherwise,Entity Configuration response,Does the RP metadata contain incorrect 'userinfo_encrypted_response_alg' parameter,In this test the RP metadata are taken and the value of the 'userinfo_encrypted_response_alg' parameter is checked. It must not contain the value ['RSA_1_5'].,RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_encrypted_response_alg and it has to contain the key encryption algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].","Trigger In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].","Compliant if the 'userinfo_signed_response_alg' parameter in the RP metadata does not contain the values ['none', 'HS256', 'HS384', 'HS512']. Not Compliant otherwise",Entity Configuration response,Does the RP metadata contain incorrect 'userinfo_signed_response_alg' parameter,"In this test the RP metadata are taken and the value of the 'userinfo_signed_response_alg' parameter is checked. It must not contain the values ['none', 'HS256', 'HS384', 'HS512'].",RP,The RP metadata of type 'openid_relying_party' must contain the parameter userinfo_signed_response_alg and it has to contain the signature algorithms,SPID_CIE_OIDC#RP-Metadata; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/metadata_oidc_rp.html,OIDC Core,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Compliant if the id_token_encryption_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain a correct id_token_encryption_alg_values_supported parameter value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,The id_token_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the id_token_signing_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the id_token_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The id_token_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the request_authentication_signing_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the request_authentication_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the request_authentication_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The request_authentication_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Compliant if the userinfo_encryption_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the userinfo_encryption_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encryption_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,The userinfo_encryption_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the userinfo_signing_alg_values_supported parameter is present in the openid_provider type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512']",Entity Statement response OP,Does the TA's metadata policy for an OP contain not valid values for the userinfo_signing_alg_values_supported parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an OP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signing_alg_values_supported parameter inside the openid_provider type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The userinfo_signing_alg_values_supported claim MUST be considered in the metadata parameter of type 'openid_provider' within the policy that the TA establishes for an OP,SPID_CIE_OIDC#TA-Metadata-Policy-for-OP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Compliant if the id_token_encrypted_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant if present",Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values for the id_token_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the value of id_token_signed_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not compliant if present",Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values for the id_token_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Compliant if the userinfo_encrypted_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values for the userinfo_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the userinfo_signed_response_alg parameter is present in the openid_relying_party type and the key 'subset_of' does not contain ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain not valid values in the userinfo_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the openid_relying_party type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Compliant if the id_token_encrypted_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid value for the id_token_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,The id_token_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the id_token_signed_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid values for the id_token_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the id_token_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The id_token_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']","Compliant if the userinfo_encrypted_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the value ['RSA_1_5'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid values for the userinfo_encrypted_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_encrypted_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the value ['RSA_1_5']",TA,The userinfo_encrypted_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response SA-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']","Compliant if the userinfo_signed_response_alg parameter is present in the intermediary type and the key 'subset_of' does not contain the values ['none', 'HS256', 'HS384', 'HS512'], not compliant otherwise",Entity Statement response SA,Does the TA's metadata policy for an SA contain not valid values for the userinfo_signed_response_alg parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an SA must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the userinfo_signed_response_alg parameter inside the intermediary type is checked. The key 'subset_of' must not contain the values ['none', 'HS256', 'HS384', 'HS512']",TA,The userinfo_signed_response_alg claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an SA,SPID_CIE_OIDC#TA-Metadata-Policy-for-SA; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
RP-Authentication request-metadata-value,"In this test the Authentication Request is taken and the alg parameter in the JWT Header is checked. If it corresponds to a symmetric algorithm or it is none, than the RP is not compliant with the specifications.","Trigger In this test the Authentication Request is taken and the alg parameter in the JWT Header is checked. If it corresponds to a symmetric algorithm or it is none, than the RP is not compliant with the specifications.","Compliant if the JWT Header of the request parameter contains the alg parameter and its value does not corresponds to one among ['none', 'HS256', 'HS384', 'HS512'], not Compliant otherwise",Authentication request,Does the RP use an asymmetric algorithm to sign the JWT in the request parameter of the Authentication Request,"In this test the Authentication Request is taken and the alg parameter in the JWT Header is checked. If it corresponds to a symmetric algorithm or it is none, than the RP is not compliant with the specifications.",RP,"The JWT Header of the request parameter in the Authentication Request must contain the 'alg' parameter, it must be set to one of the supported values for the OP metadata and must not be 'none' or a symmetric algorithm (MAC).",SPID_CIE_OIDC; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,"If it is not an alg supported by the OP, than it cannot verify the signature and there are 3 cases: 1. It is a algorithm not supported and the OP even trying to use the correct RP's public key cannot decrypt it, or
2. It is a symmetric algorithm and the public key of the RP won't decrypt the signature
3. It is a symmetric algorithm and the public key of the RP is the correct key used to encrypt it
In the first 2 cases the parameter is meaningless because the OP won't be able to decrypt the signature, in the latter we cannot rely on the secrecy of the process. The only interesting case is the third one",
AA-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.","Trigger To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Configuration response,Does the AA's entity configuration contain the trust_marks parameter,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.",AA,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the type of the trust_marks parameter is checked. It must be an array","Trigger To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the type of the trust_marks parameter is checked. It must be an array","Compliant if the trust_marks parameter present in the payload is a JSON array, not compliant otherwise",Entity Configuration response,Does the AA's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the type of the trust_marks parameter is checked. It must be an array",AA,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked","Compliant if the exp parameter is present, not compliant otherwise",Entity Configuration response,Does entity configuration contain the exp parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked",ALL,The exp parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked","Compliant if the exp parameter is timestamp, not compliant otherwise",Entity Configuration response,Does entity configuration contain a correct exp parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the exp parameter is checked",ALL,The exp parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked","Compliant if the iat parameter is timestamp, not compliant otherwise",Entity Configuration response,Does entity configuration contain a correct iat parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked",ALL,The iat parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked","Compliant if the iat parameter is present, not compliant otherwise",Entity Configuration response,Does entity configuration contain the iat parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iat parameter is checked",ALL,The iat parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iss parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iss parameter is checked","Compliant if the iss parameter is present, not compliant otherwise",Entity Configuration response,Does entity configuration contain the iss parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the iss parameter is checked",ALL,The iss parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the jwks parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the jwks parameter is checked","Compliant if the jwks parameter is present, not compliant otherwise",Entity Configuration response,Does entity configuration contain the jwks parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the jwks parameter is checked",ALL,The jwks parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the metadata parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the metadata parameter is checked","Compliant if the metadata parameter is present, not compliant otherwise",Entity Configuration response,Does entity configuration contain the metadata parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the metadata parameter is checked",ALL,The metadata parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the sub parameter is checked","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the sub parameter is checked","Compliant if the sub parameter is present, not compliant otherwise",Entity Configuration response,Does entity configuration contain the sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the presence of the sub parameter is checked",ALL,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
OP-Entity Configuration response OP-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Compliant if the sub parameter is equal to the iss claim, not compliant otherwise",Entity Configuration response OP,Does entity configuration OP contain a correct sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter",OP,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
RP-Entity Configuration response RP-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Compliant if the sub parameter is equal to the iss claim, not compliant otherwise",Entity Configuration response RP,Does entity configuration RP contain a correct sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter",RP,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Compliant if the sub parameter is equal to the iss claim, not compliant otherwise",Entity Configuration response TA,Does entity configuration TA contain a correct sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter",TA,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
SA-Entity Configuration response SA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Compliant if the sub parameter is equal to the iss claim, not compliant otherwise",Entity Configuration response SA,Does entity configuration SA contain a correct sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter",SA,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
AA-Entity Configuration response AA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter","Compliant if the sub parameter is equal to the iss claim, not compliant otherwise",Entity Configuration response AA,Does entity configuration AA contain a correct sub parameter,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the sub parameter is checked. Its value must be equal to the one in the iss parameter",AA,The sub parameter is required in the Entity Configuration of all the entities,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the authority_hints parameter is checked","Trigger To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the authority_hints parameter is checked","Compliant if the authority_hints parameter is present, not compliant otherwise",Entity Configuration response,Does the OP's entity configuration contain the authority_hints parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the authority_hints parameter is checked",OP,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.","Trigger To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Configuration response,Does the OP's entity configuration contain the trust_marks parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.",OP,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
OP-Token response-metadata-value,"The Access Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the Access Token is not compliant.","Trigger The Access Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the Access Token is not compliant.","Compliant if the JWT Access Token Header has the kid parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'kid' parameter in the Header,"The Access Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the Access Token is not compliant.",OP,The JWT Access Token Header requires the kid parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,Not present in the description but present in the example,
OP-Token response-metadata-value,The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked.,Trigger The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked.,"Compliant if the JWT Access Token Header has the typ parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'typ' parameter in the Header,The Access Token present in the Token response is analyzed and the presence of the 'typ' parameter in the header is checked.,OP,The JWT Access Token Header requires the typ parameter and it must be set to 'at+jwt',SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,Not present in the description but present in the example,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,"Compliant if the JWT Access Token Payload has the aud parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'aud' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'aud' parameter in the Payload is checked.,OP,The JWT Access Token Payload requires the aud parameter and it must contain the identifier of the resource server,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iat' parameter in the payload is a UNIX time, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iat' parameter in the payload is a UNIX time, then it is compliant with the specification","Compliant if the iat parameter in the payload of the JWS contained in the payload of the JWE in the body of the response is a valid unix time, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct iat parameter in the payload,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If the 'iat' parameter in the payload is a UNIX time, then it is compliant with the specification",OP,The JWS header is a JSON containing the iat parameter as a valid unix time,SPID_CIE_OIDC#UserInfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'client_id' parameter in the Payload is checked.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'client_id' parameter in the Payload is checked.,"Compliant if the JWT Access Token Payload contains the client_id parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'client_id' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'client_id' parameter in the Payload is checked.,OP,The JWT Access Token Payload requires the client_id parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked.,"Compliant if the JWT Access Token Payload contains the exp parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'exp' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked.,OP,The JWT Access Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked.,"Compliant if the JWT Access Token Payload contains the iat claim, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'iat' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is checked.,OP,The JWT Access Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked,"Compliant if the JWT Access Token Payload has the iss parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'iss' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'iss' parameter in the Payload is checked,OP,The JWT Access Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked.,"Compliant if the JWT Access Token Payload contains the jti parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'jti' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'jti' parameter in the Payload is checked.,OP,The JWT Access Token Payload requires the jti parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'scope' parameter in the Payload is checked,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'scope' parameter in the Payload is checked,"Compliant if the JWT Access Token Payload contains the scope parameter and its value matches the value in the authentication request, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'scope' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'scope' parameter in the Payload is checked,OP,The JWT Access Token Payload requires the scope parameter. It MUST match the value in the authentication request.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'sub' parameter in the Payload is checked.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'sub' parameter in the Payload is checked.,"Compliant if the JWT Access Token Payload has the sub parameter, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'sub' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'sub' parameter in the Payload is checked.,OP,The JWT Access Token Payload requires the sub parameter and it must be 'pairwise',SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked","Trigger In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked","Compliant if the alg parameter is present, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'alg' parameter in the Header,"In this test, the ID Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,The JWT ID Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,Asymmetric ID Token signature with RS256,Not present in the description of the ID Token but present in the example. I assumed the signature values,
OP-Token response-metadata-value,"The ID Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the ID Token is not compliant.","Trigger The ID Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the ID Token is not compliant.","Compliant if the JWT ID Token Header has the kid parameter, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'kid' parameter in the Header,"The ID Token is taken from the Token Response and the presence of the 'kid' parameter in the Header is checked. If it is not present, than the ID Token is not compliant.",OP,The JWT ID Token Header requires the kid parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,Are all required required claims present (HasRequiredClaims),ID Token has kid claim,Not present in the description but present in the example,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked.","Compliant if the ID Token contains the acr_value claim, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'acr' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'acr' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the acr parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,Support acr_values request parameter,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'at_hash' parameter in the Payload is checked","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'at_hash' parameter in the Payload is checked","Compliant if the ID Token contains the at_hash parameter, not Compliant otherwise",Token response,Does ID token payload contain the 'at_hash' parameter,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'at_hash' parameter in the Payload is checked",OP,The JWT ID Token Payload requires the at_hash parameter and its value must match the Access Token returned with the Token ID,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the at_hash claim present (IsAccessTokenHashPresent),,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'aud' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'aud' parameter in the Payload is checked.","Compliant if the ID Token contains the aud parameter, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'aud' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'aud' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the aud parameter and it must contain the RP's client_id,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the token audience set (HasCorrectAudience),ID Token has aud claim,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'exp' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'exp' parameter in the Payload is checked.","Compliant if the ID Token contains the exp claim, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'exp' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'exp' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked.","Compliant if the ID Token contains the iat claim, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'iat' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iat' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Are all required required claims present (HasRequiredClaims),ID Token has iat claim,,
OP-Userinfo response-metadata-value,"After a successful Authentication Request with a scope 'openid profile' , a valid Access Token obtained from the OP is sent to the OP's userinfo endpoint using an HTTP POST request. If the userinfo endpoint returns a signed and encrypted JWT containing the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier), the OP is compliant with the specification.","UserInfo request via HTTP POST with scope ""openid profile""","Compliant if the JWT in the body of the response contains the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier). Not compliant otherwise",Userinfo response,Does the OP gives the correct claims through HTTP POST at the userinfo endpoint,"After a successful Authentication Request with a scope 'openid profile' , a valid Access Token obtained from the OP is sent to the OP's userinfo endpoint using an HTTP POST request. If the userinfo endpoint returns a signed and encrypted JWT containing the claims 'family_name', 'given_name', 'birthdate', https://attributes.eid.gov.it/fiscal_number (National Unique Identifier), the OP is compliant with the specification.",OP,"The UserInfo Endpoint MUST support the method HTTP GET and HTTP POST and MUST accept and validate the Access Token sent in the Authorization field of the Header, whose type is Bearer",SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"In this test an authorization request is made without the claims parameter and inserting in the scope parameter only the 'openid' value. The OP must return a code that will be exchanged for an access token. Once obtained the access token, the UserInfo endpoint is queried and the response must contain a signed JWT which contains (in the payload) the sub claim and no user attributes.",Authentication request with scope openid and claims parameter empty in the request,"Compliant if the payload of the issued JWT contains the sub claim and no user attributes, not compliant otherwise",Userinfo response,Does the OP leak information when the scope is only openid,"In this test an authorization request is made without the claims parameter and inserting in the scope parameter only the 'openid' value. The OP must return a code that will be exchanged for an access token. Once obtained the access token, the UserInfo endpoint is queried and the response must contain a signed JWT which contains (in the payload) the sub claim and no user attributes.",OP,"If in the scope parameter there was only the openid value and the claims parameter was not present or valued, the response of the userinfo endpoint would not have any user attributes but only the claim sub.",SPID_CIE_OIDC#scope-and-claims-parameters; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#parametri-scope-claims,OIDC Core,,Support openid scope,,
RP-Authentication request-metadata-value,"The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is present, than it has to be set to one of the value of the code_challenge_methods_supported parameter in the OP's metadata. If it is not present or contains any other value, then the RP is not compliant with the specifications","Trigger The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is present, than it has to be set to one of the value of the code_challenge_methods_supported parameter in the OP's metadata. If it is not present or contains any other value, then the RP is not compliant with the specifications","Compliant if the code_challenge_method parameter is present and set to a correct value, not Compliant otherwise",Authentication request,Does the RP's Authentication Request contain a correct 'code_challenge_method' parameter,"The Authentication request is taken and the presence of the 'code_challenge_method' parameter is checked. If it is present, than it has to be set to one of the value of the code_challenge_methods_supported parameter in the OP's metadata. If it is not present or contains any other value, then the RP is not compliant with the specifications",RP,The HTTP Authentication Request must contain the 'code_challenge_method' parameter and it must be set to on of the value of the code_challenge_methods_supported parameter in the OP's metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,Create OP test on code_challenge,
RP-Authentication request-metadata-value,"In this test the request parameter of the Authentication Request is taken, and the value of the 'kid' parameter must correspond with jwks parameter of the RP metadata, not Compliant otherwise","Trigger In this test the request parameter of the Authentication Request is taken, and the value of the 'kid' parameter must correspond with jwks parameter of the RP metadata, not Compliant otherwise","Compliant if the JWT of the request parameter contains the 'kid' parameter in the header and its value corresponds to the one that can be found in the jwks parameter of the RP metadata, not Compliant otherwise",Authentication request,Does the JWT header of the Authentication Request contain the kid parameter correspond to the jwks parameter in RP metadata,"In this test the request parameter of the Authentication Request is taken, and the value of the 'kid' parameter must correspond with jwks parameter of the RP metadata, not Compliant otherwise",RP,The JWT Header of the request parameter in the Authentication Request must contain the 'kid' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication response-metadata-value,"In order to check if the RP verifies the OP's Entity Configuration with the keys sent in the ES, once the RP asks for the Entity Statement, the TA's Entity Statement in response could have a (wrong) public key that is different from the one that can be found in the OP's EC (ES keys should be wrong). After this, an authentication request with that OP is made and, if the response contains the code parameter, the RP is either using the public keys present in the Entity Configuration (not reliable) or not checking the signature at all.",Entity Statement response regarding the OP and with a wrong jwks parameter and Authentication request,"Compliant if the authentication response does not contain the code parameter, not compliant otherwise",Authentication response,Does the RP request the OP's Entity Statement to validate the OP's Entity Configuration,"In order to check if the RP verifies the OP's Entity Configuration with the keys sent in the ES, once the RP asks for the Entity Statement, the TA's Entity Statement in response could have a (wrong) public key that is different from the one that can be found in the OP's EC (ES keys should be wrong). After this, an authentication request with that OP is made and, if the response contains the code parameter, the RP is either using the public keys present in the Entity Configuration (not reliable) or not checking the signature at all.",RP,"For each EC of the OPs, the RP validates the signature by using the public key obtained in the Entity Statement released by the Trust Anchor.",SPID_CIE_OIDC#Metadata-Retrieval-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#relying-party,OIDC Federation,,,"The test fails if a correct flow is accomplished by the RP. It is similar to JWT response (correct check-no) but since we are checking the RP's flow, we do not except an HTTP Error code",
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter is checked.","Compliant if the ID Token contains the iss parameter, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'iss' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'iss' parameter is checked.",OP,The JWT ID Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the token issuer set (HasCorrectIssuer),ID Token has iss claim,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'jti' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'jti' parameter in the Payload is checked.","Compliant if the ID Token contains the jti claim, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'jti' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'jti' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the jti parameter,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,,,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked.","Compliant if the ID Token contains the nonce claim, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'nonce' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'nonce' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the nonce parameter and it must be set to the nonce value sent in the Authentication Request,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the nonce present in the ID token (NoncePresentInToken),ID Token has nonce when requested for code flow,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'sub' parameter in the Payload is checked.","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'sub' parameter in the Payload is checked.","Compliant if the ID Token contains the sub parameter, not Compliant otherwise",Token response,Does the issued JWT ID Token contain the 'sub' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the presence of the 'sub' parameter in the Payload is checked.",OP,The JWT ID Token Payload requires the sub parameter and it must be 'pairwise',SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Are all required required claims present (HasRequiredClaims),ID Token has sub claim,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the cty parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain the cty parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'cty' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the cty parameter (Content Type) configured to JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the cty parameter set to 'JWT', not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain a correct cty parameter in the JOSE Header,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'cty' parameter set to 'JWT' in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the cty parameter (Content Type) configured to JWT,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the enc parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain the enc parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'enc' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the enc parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the enc parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'], not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain a correct enc parameter in the JOSE Header,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'enc' parameter containing a value among ['A128CBC-HS256', 'A256CBC-HS512'] in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the enc parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Compliant if the acr_values parameter is present, not compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'acr_values' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,"The JWT payload of the request parameter in the Authentication Request must contain the 'acr_values' parameter and It MUST be a string with the requested 'acr' values, each of them separated by a single space, appearing in order of preference. The supported values 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'aud' parameter is checked. If it missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'aud' parameter is checked. If it missing, than the RP is not compliant with the specifications","Compliant if the aud parameter is present, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'aud' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'aud' parameter is checked. If it missing, than the RP is not compliant with the specifications",RP,The JWT content of the request parameter in the Authentication Request must contain the 'aud' parameter and it must be the OP identifier,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'exp' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'exp' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Compliant if present and before the current time, not compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'exp' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'exp' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,The JWT content of the request parameter in the Authentication Request must contain the 'exp' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication response,"Authentication request with prompt set to ""consent login""","Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse credentials not allowed for that acr level,"In this test an authentication request with prompt sent to 'consent login' is accomplished and, when the user credentials are requested, credentials not authorized for that acr level are inserted. The response is then analyzed",OP,"If the prompt parameter is set to consent login, the OP forces an authentication request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authentication-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
OP-Authentication response-metadata-value,Authentication response,"Authentication request with prompt set to ""consent login""","Compliant if the Authentication response is an HTTP 302 because of invalid_request, not compliant otherwise",Authentication response,Does the OP refuse wrong credentials,"In this test an authentication request with prompt sent to 'consent login' is accomplished and, when the user credentials are requested, wrong ones are inserted. The response is then analyzed",OP,"If the prompt parameter is set to consent login, the OP forces an authentication request to the user. Then it asks permission to transfer the claims.",SPID_CIE_OIDC#Authentication-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#response,OIDC Core,,,,
RP-Authentication request-metadata-value,"In this test the request parameter of the Authentication Request is taken, the payload decrypted and the presence of the 'client_id' parameter is checked.","Trigger In this test the request parameter of the Authentication Request is taken, the payload decrypted and the presence of the 'client_id' parameter is checked.","Compliant if the JWT of the request parameter contains the 'client_id' parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'client_id' parameter,"In this test the request parameter of the Authentication Request is taken, the payload decrypted and the presence of the 'client_id' parameter is checked.",RP,The JWT content of the request parameter in the Authentication Request must contain the 'client_id' parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,"The parameters client_id and response_type SHOULD be sent both as parameters in the HTTP request, and inside the request object.",
RP-Authentication request-metadata-value,"In this test the request parameter of the Authentication Request is taken, and the presence of the 'kid' parameter is checked.","Trigger In this test the request parameter of the Authentication Request is taken, and the presence of the 'kid' parameter is checked.","Compliant if the JWT of the request parameter contains the 'kid' parameter in the header, not Compliant otherwise",Authentication request,Does the JWT header of the Authentication Request contain the kid parameter,"In this test the request parameter of the Authentication Request is taken, and the presence of the 'kid' parameter is checked.",RP,The JWT Header of the request parameter in the Authentication Request must contain the 'kid' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iat' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iat' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Compliant if the JWT of the request parameter contains the 'iat' parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'iat' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iat' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,The JWT content of the request parameter in the Authentication Request must contain the 'iat' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iss' parameter is checked.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iss' parameter is checked.","Compliant if the JWT of the request parameter contains the 'iss' parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'iss' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'iss' parameter is checked.",RP,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'iss' parameter is checked to be the RP's client_id","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'iss' parameter is checked to be the RP's client_id","Compliant if iss parameter in the JWT inside the request parameter corresponds to the RP's client_id, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain a correct 'iss' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'iss' parameter is checked to be the RP's client_id",RP,The JWT content of the request parameter in the Authentication Request must contain the 'iss' parameter and it must be the client_id of the RP creating the request,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'state' parameter is checked.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'state' parameter is checked.","Compliant if the JWT of the request parameter contains the 'state parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'state' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'state' parameter is checked.",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'state' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'ui_locales' parameter is checked. If it is missing, the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'ui_locales' parameter is checked. If it is missing, the RP is not compliant with the specifications","Compliant if the JWT of the request parameter contains the 'ui_locales' parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'ui_locales' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'ui_locales' parameter is checked. If it is missing, the RP is not compliant with the specifications",RP,The JWT content of the request parameter in the Authentication Request must contain the 'ui_locales' parameter,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'nonce' parameter is checked.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'nonce' parameter is checked.","Compliant if the JWT of the request parameter contains the 'nonce' parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'nonce' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'nonce' parameter is checked.",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'nonce' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'prompt' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'prompt' parameter is checked. If it is missing, than the RP is not compliant with the specifications","Compliant if the JWT of the request parameter contains the 'prompt' parameter, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'prompt' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'prompt' parameter is checked. If it is missing, than the RP is not compliant with the specifications",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'prompt' parameter. It can contain the 'consent' or the 'consent login' value,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'redirect_uri' parameter","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'redirect_uri' parameter","Compliant if the redirect_uri parameter is present, not compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'redirect_uri' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'redirect_uri' parameter",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'redirect_uri' parameter. It must match one of the URLs given in the RP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked","Compliant if the response_type parameter is present, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'response_type' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'response_type' parameter is checked",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'response_type' parameter and it must contain the value in 'response_types_supported' parameter of the OP metadata,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'scope' parameter is checked.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'scope' parameter is checked.",Compliant if the scope parameter is present in the JWT payload. Not compliant otherwise,Authentication request,Does the RP Authentication Request contain the 'scope' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'scope' parameter is checked.",RP,"The JWT payload of the request parameter in the Authentication Request must contain the 'scope' parameter and the supported values are 'profile' and 'email'. The parameter scope MUST be sent both as a parameter in the HTTP call, and inside the request object. The two values MUST be the same",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,"Not clear in the new specification, check if the offline access can be used this way",
RP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.","Trigger To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Configuration response,Does the RP's entity configuration contain the trust_marks parameter,"To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks parameter is checked.",RP,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the aud claim is present.","Compliant if the client assertion JWT contains the aud claim, not Compliant otherwise",Token request,Does the signed JWT assertion contain the aud claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the aud claim is present.",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the aud claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the aud. Its value must be an URL","Compliant if the aud claim in the client assertion JWT is set to an URL, not Compliant otherwise",Token request,Does the signed JWT assertion contain a correct aud claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the aud. Its value must be an URL",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the aud claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the exp claim is present","Compliant if the client assertion JWT contains the exp claim, not Compliant otherwise",Token request,Does the signed JWT assertion contain the exp claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the exp claim is present",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the exp claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the exp claim. Its value must be a timestap","Compliant if the client assertion JWT contains the exp claim and its value is a timestamp, not Compliant otherwise",Token request,Does the signed JWT assertion contain a correct exp claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the exp claim. Its value must be a timestap",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the exp claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the iat claim is present.","Compliant if the client assertion JWT contains the iat claim and its value is a timestamp before the current one, not Compliant otherwise",Token request,Does the signed JWT assertion contain the iat claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the iat claim is present.",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iat claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the iat claim. Its value must be a timestap","Compliant if the client assertion JWT contains the iat claim and its value is a timestamp, not Compliant otherwise",Token request,Does the signed JWT assertion contain a correct iat claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking the iat claim. Its value must be a timestap",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iat claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the iss claim is present.","Compliant if the client assertion JWT contains the iss claim, not Compliant otherwise",Token request,Does the JWT payload contain 'iss' claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the iss claim is present.",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the iss claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the jti claim is present.","Compliant if the client assertion JWT contains the jti claim, not Compliant otherwise",Token request,Does the signed JWT assertion contain the jti claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the jti claim is present.",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the jti claim.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
RP-Token request-metadata-value,Token request,"Trigger This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the sub claim is present.","Compliant if the client assertion JWT contains the sub claim, not Compliant otherwise",Token request,Does the signed JWT assertion contain the sub claim,"This test can be performed by taking the JWT present in the 'client_assertion' field of the RP's request, base64url decoding the payload and checking if the sub claim is present.",RP,"The client assertion parameter contains a single (signed) JWT which must contain, among others, the sub claim. This claim must be set to the client ID of the RP creating the request.",SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
SA-Entity Configuration response-metadata-value,"The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the metadata in the response are analyzed. Among them, the 'trust_marks' parameter must be present.","Trigger The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the metadata in the response are analyzed. Among them, the 'trust_marks' parameter must be present.","Compliant if the 'trust_marks' parameter is present, not compliant otherwise",Entity Configuration response,Does the entity configuration of the SA contain the trust marks,"The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the metadata in the response are analyzed. Among them, the 'trust_marks' parameter must be present.",SA,"The RP, OP or SA must include the trust marks in the entity configuration as a result of the onboarding process",SPID_CIE_OIDC#entity-configuration-leaves-and-intermediaries; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
OP-Introspection response-metadata-value,Introspection Response to a Request with a valid token,Introspection request with valid token in the token parameter,"Compliant if the Introspection Response is a JSON Object with only an 'active' parameter set to true, not compliant otherwise",Introspection response,Does the Introspection Endpoint returns true on active tokens,"To test that the Introspection response of the OP's correctly identifies valid tokens, a valid one is sent and the response is analyzed",OP,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,,,,
OP-Introspection response-metadata-value,Introspection Response to a Request with a valid token,Introspection request with valid token in the token parameter,"Compliant if the Introspection Response is a JSON Object with only an 'active' parameter, not compliant otherwise",Introspection response,Does the Introspection Endpoint Response have the active parameter,"To test that the Introspection response of the OP's correctly answers to valid tokens, a valid one is sent and the response is analyzed. It must contain the 'active' parameter",OP,"If the token is expired, it has been revoked or it has never been issued for the calling client_id, the Introspection Endpoint must return false. Otherwise it returns true",SPID_CIE_OIDC#Introspection-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#response,OIDC Core,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Compliant if the constraints parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the constraints parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",SA,The constraints parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Compliant if the exp parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",SA,The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp","Compliant if the exp parameter is a timestamp, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain a correct exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp",SA,The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Compliant if the iat parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",SA,The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp","Compliant if the iat parameter is a timestamp, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain a correct iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp",SA,The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Compliant if the iss parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the iss parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",SA,The iss parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Compliant if the jwks parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the jwks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",SA,The jwks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Compliant if the metadata_policy parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the metadata_policy parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",SA,The metadata_policy parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,"In order to check if the RP correctly verifies the signature of an OP's Entity Configuration and does not trust arbitrary OP, the latter sends as the Entity Configuration response a wrongly signed Entity Configuration and waits for the RP. After this an authentication request is sent and, if the response contains the code, the RP is not checking the authenticity of the EC",Entity Configuration response containing a wrongly-signed Entity Configuration,"Compliant if the Authentication response does not contain the code parameter, not compliant otherwise",Entity Configuration response,Does the RP check the signature in the OP Entity Configuration,"In order to check if the RP correctly verifies the signature of an OP's Entity Configuration and does not trust arbitrary OP, the latter sends as the Entity Configuration response a wrongly signed Entity Configuration and waits for the RP. After this an authentication request is sent and, if the response contains the code, the RP is not checking the authenticity of the EC",RP,"For each EC of the OPs, the RP validates the signature by using the public key obtained in the Entity Statement released by the Trust Anchor.",SPID_CIE_OIDC#Metadata-Retrieval-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_negotiation.html#relying-party,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Compliant if the sub parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the sub parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",SA,The sub parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the SA contain the trust_marks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",SA,The trust_marks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked","Trigger To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked","Compliant if the constraints parameter is present, not compliant otherwise",Entity Configuration response TA,Does the Entity configuration of the Trust Anchor contain the constraints parameter in its decoded payload,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked",TA,TA's Entity Configuration must have the 'constraints' and 'trust_mark_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,,,,
RP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer', not compliant otherwise",Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",RP,"Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
RP-Introspection request-metadata-value,The Introspection request made by the RP use HTTP POST,Trigger The Introspection request made by the RP use HTTP POST,"Compliant if the introspection request is sent via HTTP POST, not compliant otherwise",Introspection request,Does the Introspection Request use HTTP POST,The Introspection request made by the RP use HTTP POST,RP,The request to the Introspection Endpoint must use HTTP POST,SPID_CIE_OIDC#Introspection-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/introspection_endpoint.html#request,OIDC Core,,,,
SA-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer', not compliant otherwise",Entity Configuration response,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SA,"Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
OP-Token response-metadata-value,"In this test an RP makes an authentication request with scope offline_access and the parameter prompt set to consent. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain a valid refresh token. Once obtained, the token must be validated with the proper validation algorithm and public key",Authentication request with scope openid offline_access and prompt contains consent,"Compliant if the refresh_token obtained in the token response is a valid JWT, not Compliant otherwise",Token response,Does the OP issue valid refresh tokens,"In this test an RP makes an authentication request with scope offline_access and the parameter prompt set to consent. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain a valid refresh token. Once obtained, the token must be validated with the proper validation algorithm and public key",OP,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access and prompt=consent)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Are refresh tokens supported (HasRefreshTokens),,,
TA-Entity Configuration response TA-metadata-value,"The Federation configuration must contain, among others, the TA public keys. To check the presence of those keys, the Entity Configuration is taken from the TA's '.well-known/openid-federation' endpoint and the response is analyzed, in the returned JWT the claim 'jwks' must be present","Trigger The Federation configuration must contain, among others, the TA public keys. To check the presence of those keys, the Entity Configuration is taken from the TA's '.well-known/openid-federation' endpoint and the response is analyzed, in the returned JWT the claim 'jwks' must be present","Compliant if the TA's Entity Configuration response contains the TA's public keys, not compliant otherwise",Entity Configuration response TA,Does the Federation Configuration contain the TA public keys,"The Federation configuration must contain, among others, the TA public keys. To check the presence of those keys, the Entity Configuration is taken from the TA's '.well-known/openid-federation' endpoint and the response is analyzed, in the returned JWT the claim 'jwks' must be present",TA,"The Federation configuration contains the Trust Anchor public key for the signature operations, the maximum number of Intermediaries allowed between a Leaf and the Trust Anchor (max_path length) and the authorities who are enabled to issue the Trust Marks (trust_marks_issuers).",SPID_CIE_OIDC#Configuration-of-the-federation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/la_federazione_delle_identita.html#configurazione-della-federazione,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks_issuers parameter is checked","Trigger To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks_issuers parameter is checked","Compliant if the trust_marks_issuers parameter is present, not compliant otherwise",Entity Configuration response TA,Does TA's Entity configuration contain the trust_marks_issuers parameter,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the trust_marks_issuers parameter is checked",TA,TA's Entity Configuration must have the 'constraints' and 'trust_marks_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Compliant if the constraints parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the constraints parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",TA,The constraints parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Compliant if the email claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",TA,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Compliant if the exp parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the exp parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",TA,The exp parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Compliant if the iat parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the iat parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",TA,The iat parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.","Trigger The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.","Compliant if the id claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the id claim,"The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.",TA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Compliant if the id_code claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",TA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Compliant if the iss parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statement issued by the TA contain the iss parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",TA,The iss parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Compliant if the jwks parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the jwks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",TA,The jwks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Compliant if the metadata_policy parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the metadata_policy parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",TA,The metadata_policy parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Compliant if the organization_name claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",TA,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Compliant if the organization_type claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",TA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Compliant if the ref claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",TA,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations","Trigger In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations","Compliant if the jwks parameter is present inside the openid_relying_party type of the metadata_policy, not compliant otherwise",Entity Statement response RP,Does the TA's metadata policy for an RP contain the jwks parameter,"In order to check the compliance of a metadata policy issued by the TA, an entity statement for an RP must be fetched in the TA's fetch endpoint. Once obtained the entity statement, the metadata_policy parameter is taken and the presence of the jwks parameter inside the openid_relying_party type is checked. It must contain the RP JWKS related to the OIDC Core operations",TA,The jwks claim MUST be considered in the metadata parameter of type 'openid_relying_party' within the policy that the TA establishes for an RP,SPID_CIE_OIDC#TA-Metadata-Policy-for-RP; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#metadata-policy,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Compliant if the sub parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the sub parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",TA,The sub parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Compliant if the exp claim is present, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",TA,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.","Compliant if the iss claim is present, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.",TA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Statement response OP,Does Entity Statements issued by the TA contain the trust_marks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",TA,The trust_marks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Compliant if the iat claim is present, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",TA,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.","Compliant if the sub claim is present in the trust mark, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.",TA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
AA-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array","Trigger To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array","Compliant if the trust_marks parameter is present and is a JSON array, not compliant otherwise",Entity Configuration response,Does the AA's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the AA is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array",AA,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
ALL-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object.","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object.","Compliant if 'metadata' parameter is a JSON Object, not compliant otherwise",Entity Configuration response,Does the metadata parameter contain a JSON Object,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object.",ALL,"Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the authority_hints parameter is checked, it must be an array","Trigger To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the authority_hints parameter is checked, it must be an array","Compliant if the authority_hints parameter is present and is an array of URLs, not compliant otherwise",Entity Configuration response,Does the OP's entity configuration contain a correct authority_hints parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the authority_hints parameter is checked, it must be an array",OP,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
OP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array","Trigger To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array","Compliant if the trust_marks parameter is present and is a JSON array, not compliant otherwise",Entity Configuration response,Does the OP's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the OP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array",OP,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must be an HTTPS URL.,Trigger The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must be an HTTPS URL.,"Compliant if the JWT Access Token Payload contains the client_id parameter as an HTTPS URL, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'client_id' parameter in the Payload as an HTTPS url,The Access Token present in the Token Response is analyzed and the value of the 'client_id' parameter in the Payload must be an HTTPS URL.,OP,The JWT Access Token Payload requires the client_id parameter. It MUST contain an HTTPS URL that uniquely identifies the RP.,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,"The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked. In particular, this parameter must be a valid timestamp","Trigger The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked. In particular, this parameter must be a valid timestamp","Compliant if the JWT Access Token Payload contains the exp parameter and its value is a timestamp, not Compliant otherwise",Token response,Does the issued JWT Access Token contain a timestamp as the 'exp' parameter in the Payload,"The Access Token present in the Token Response is analyzed and the presence of the 'exp' parameter in the Payload is checked. In particular, this parameter must be a valid timestamp",OP,The JWT Access Token Payload requires the exp parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is a timestamp.,Trigger The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is a timestamp.,"Compliant if the JWT Access Token Payload contains the iat claim and its value is a timestamp, not Compliant otherwise",Token response,Does the issued JWT Access Token contain a correct 'iat' parameter in the Payload,The Access Token present in the Token Response is analyzed and the presence of the 'iat' parameter in the Payload is a timestamp.,OP,The JWT Access Token Payload requires the iat parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,"The Access Token present in the Token Response is analyzed and the 'iss' parameter in the Payload is checked, in particular, its value must be an HTTPS URL","Trigger The Access Token present in the Token Response is analyzed and the 'iss' parameter in the Payload is checked, in particular, its value must be an HTTPS URL","Compliant if the JWT Access Token Payload has the iss parameter and it is an HTTPS URL, not Compliant otherwise",Token response,Does the issued JWT Access Token's 'iss' parameter contain an URL,"The Access Token present in the Token Response is analyzed and the 'iss' parameter in the Payload is checked, in particular, its value must be an HTTPS URL",OP,The JWT Access Token Payload requires the iss parameter and it must be an HTTPS URL,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the value of the 'jti' parameter in the Payload must be based on uuid4 format.,Trigger The Access Token present in the Token Response is analyzed and the value of the 'jti' parameter in the Payload must be based on uuid4 format.,"Compliant if the JWT Access Token Payload contains the jti parameter in uuid4 format, not Compliant otherwise",Token response,Does the issued JWT Access Token contain the 'jti' parameter in the Payload in uuid4 format,The Access Token present in the Token Response is analyzed and the value of the 'jti' parameter in the Payload must be based on uuid4 format.,OP,The JWT Access Token Payload requires the jti parameter,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'state' parameter must be at least 32 alphanumeric characters long. If it is not present or its length is less than 32 alphanumeric characters, then the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'state' parameter must be at least 32 alphanumeric characters long. If it is not present or its length is less than 32 alphanumeric characters, then the RP is not compliant with the specifications","Compliant if the state parameter is present and longer than 32 characters, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'state' parameter greater than 32 characters,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'state' parameter must be at least 32 alphanumeric characters long. If it is not present or its length is less than 32 alphanumeric characters, then the RP is not compliant with the specifications",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'state' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'nonce' parameter must be at least 32 alphanumeric characters long.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'nonce' parameter must be at least 32 alphanumeric characters long.","Compliant if the nonce parameter is longer than 32 characters, not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'nonce' parameter longer than 32 characters,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'nonce' parameter must be at least 32 alphanumeric characters long.",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'nonce' parameter and it must be of at least 32 alphanumeric characters length,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Entity Configuration response-metadata-value,"To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array","Trigger To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array","Compliant if the trust_marks parameter is a JSON array, not compliant otherwise",Entity Configuration response,Does the RP's entity configuration contain a correct trust_marks parameter,"To accomplish this test, the Entity configuration of the RP is taken, the payload is decoded (Base64 encoding) and the trust_marks parameter is checked, it must be a JSON array",RP,Leaf and intermediate entities' Entity Configuration must have the 'authority_hints' and 'trust_marks' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked","Trigger In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,Entity Statement response OP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked",SA,The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Configuration response-metadata-value,"The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the configuration metadata are analyzed. Among them, the 'trust_marks' parameter must be present and must be a JSON array containing the Trust Marks.","Trigger The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the configuration metadata are analyzed. Among them, the 'trust_marks' parameter must be present and must be a JSON array containing the Trust Marks.","Compliant if the 'trust_marks' parameter is a JSON array, not compliant otherwise",Entity Configuration response,Does the entity configuration of the SA contain a correct trust_marks parameter,"The entity configuration of the SA is taken from its own web endpoint '.well-known/openid-federation', and the configuration metadata are analyzed. Among them, the 'trust_marks' parameter must be present and must be a JSON array containing the Trust Marks.",SA,"The RP, OP or SA must include the trust marks in the entity configuration as a result of the onboarding process",SPID_CIE_OIDC#entity-configuration-leaves-and-intermediaries; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-foglia-e-intermediari,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'","Trigger The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'","Compliant if the id is present, has the structure <SA domain>/<entity_type>/<trustmark_profile>/ and the entity_type and trustmark_profile parts of the URL have values among the allowed ones, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'",SA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,Da capire come individuare che solo l'entity type sia all'interno dei valori dati,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must be a JSON Object","Trigger To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must be a JSON Object","Compliant if the constraints parameter is a JSON object, not compliant otherwise",Entity Configuration response TA,Does the Trust Anchor's Entity configuration contain a constraints parameter valued as a JSON Object,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the presence of the constraints parameter is checked. It must be a JSON Object",TA,TA's Entity Configuration must have the 'constraints' and 'trust_mark_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the trust_marks_issuers parameter must be a JSON Array.","Trigger To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the trust_marks_issuers parameter must be a JSON Array.","Compliant if the trust_mark_issuers parameter is a JSON array, not compliant otherwise",Entity Configuration response TA,Does TA's Entity configuration's trust_marks_issuers parameter contain a JSON Array,"To accomplish this test, the Entity configuration of the TA is taken, the payload is decoded (Base64 encoding) and the trust_marks_issuers parameter must be a JSON Array.",TA,TA's Entity Configuration must have the 'constraints' and 'trust_mark_issuers' parameters,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-trust-anchor,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object","Compliant if the id_code claim is a JSON Object, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object",TA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL","Compliant if the sub claim is an URL, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL",TA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
OP-Token response-metadata-value,The Access Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload is the identifier of the resource server,Trigger The Access Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload is the identifier of the resource server,"Compliant if the JWT Access Token Payload has the aud parameter set to the identifier of the intended resource server, not Compliant otherwise",Token response,Does the issued JWT Access Token contain a correct 'aud' parameter,The Access Token present in the Token Response is analyzed and the value of the 'aud' parameter in the Payload is the identifier of the resource server,OP,The JWT Access Token Payload requires the aud parameter and it must contain the identifier of the resource server,SPID_CIE_OIDC#Token-Endpoint-Access-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#access-token,OIDC Core,,,,
OP-Token response-metadata-value,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the 'sub' parameter is checked to be a string","Trigger The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the 'sub' parameter is checked to be a string","Compliant if the sub parameter in the ID Token is a string, not Compliant otherwise",Token response,Does the issued JWT ID Token contain a correct 'sub' parameter in the Payload,"The ID Token present in the Token Response is taken, the payload is base64url decoded, analyzed and the 'sub' parameter is checked to be a string",OP,The JWT ID Token Payload requires the sub parameter and it must be a string of type pairwise,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Are all required required claims present (HasRequiredClaims),ID Token has sub claim,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,Entity Statement response OP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain the ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'",SA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked","Trigger In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,Entity Statement response RP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number or vat_number claim in the id_code is checked",SA,The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'","Trigger The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'","Compliant if the id is present, has the structure <SA domain>/<entity_type>/<trustmark_profile>/ and the entity_type and trustmark_profile parts of the URL have values among the allowed ones, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <SA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked. If it is present, than the structure of the id must be as described above. The entity type can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or private'",SA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,Da capire come individuare che solo l'entity type sia all'interno dei valori dati,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,Entity Statement response RP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain the ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of the id_code claim contains at least the value 'ipa_code'",SA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,Trust Mark status endpoint request with invalidated Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",Trust Mark status response,Does the SA invalidate revocated trust marks,"In order to check if a TA or SA correctly invalidate a Trust Mark, a Trust Mark revocation request on a Trust Mark has to be made and then the trust mark status endpoint must be fetched. If the response says that the trust mark is invalid, than it is correctly invalidated, otherwise the TA or SA is not compliant with the specification",SA,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is present, than it must be a string with the requested 'acr' values, each of them separated by a single space. The supported values are 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'. If it contains other values or it is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is present, than it must be a string with the requested 'acr' values, each of them separated by a single space. The supported values are 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'. If it contains other values or it is missing, than the RP is not compliant with the specifications","Compliant if the acr_values parameter is present, it is a string with the requested 'acr' values separated by a single space and the values are among 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'. Not compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain a correct 'acr_values' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the presence of the 'acr_values' parameter is checked. If it is present, than it must be a string with the requested 'acr' values, each of them separated by a single space. The supported values are 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'. If it contains other values or it is missing, than the RP is not compliant with the specifications",RP,"The JWT payload of the request parameter in the Authentication Request must contain the 'acr_values' parameter and It MUST be a string with the requested 'acr' values, each of them separated by a single space, appearing in order of preference. The supported values 'https://www.spid.gov.it/SpidL1', 'https://www.spid.gov.it/SpidL2' and 'https://www.spid.gov.it/SpidL3'",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'prompt' parameter is checked. It must be set to the value 'consent' or 'consent login'. If it contains other values or it is missing, than the RP is not compliant with the specifications","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'prompt' parameter is checked. It must be set to the value 'consent' or 'consent login'. If it contains other values or it is missing, than the RP is not compliant with the specifications","Compliant if the prompt parameter is present and is set to 'consent' or to 'consent login', not Compliant otherwise",Authentication request,Does the RP Authentication Request's JWT contain the 'prompt' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the 'prompt' parameter is checked. It must be set to the value 'consent' or 'consent login'. If it contains other values or it is missing, than the RP is not compliant with the specifications",RP,The JWT payload of the request parameter in the Authentication Request must contain the 'prompt' parameter. It can contain the 'consent' or the 'consent login' value,SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,,
RP-Authentication request-metadata-value,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'scope' parameter must be set to the value 'openid' then it can (optionally) have the values 'offline_access', 'profile' or 'email' appended.","Trigger The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'scope' parameter must be set to the value 'openid' then it can (optionally) have the values 'offline_access', 'profile' or 'email' appended.","Compliant if the value of the scope parameter in the JWT payload is set to 'openid'. Optionally to 'openid profile', 'openid email', 'openid offline_access', 'openid offline_access profile' and 'openid offline_access email'. Not compliant otherwise",Authentication request,Does the RP Authentication Request contain a correct value in 'scope' parameter,"The Authentication request is taken, the JWT Token in the request parameter base64url decoded and the value of the 'scope' parameter must be set to the value 'openid' then it can (optionally) have the values 'offline_access', 'profile' or 'email' appended.",RP,"The JWT payload of the request parameter in the Authentication Request must contain the 'scope' parameter and the supported values are 'profile' and 'email'. The parameter scope MUST be sent both as a parameter in the HTTP call, and inside the request object. The two values MUST be the same",SPID_CIE_OIDC#Authorization-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/authorization_endpoint.html#request,OIDC Core,,,"Not clear in the new specification, check if the offline access can be used this way",
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'","Compliant if the organization_type claim is 'public' or 'private', not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'",TA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,Trust Mark status request with a non-valid Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",Trust Mark status response,Does the SA's trust mark status endpoint correctly refuses revocated or invalid Trust Marks,"In order to check if the trust mark status endpoint of a TA or SA correctly refuses invalid trust marks, a invalid or revocated trust mark can be sent to the endpoint and the response analyzed",SA,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,,,,
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Trigger To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'","Compliant if each key in metadata is present only once and is a value between 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer', not compliant otherwise",Entity Configuration response TA,Does the metadata parameter contain only allowed types and only once for each,"To accomplish this test, the Entity configuration of the interested entity is taken, the payload is decoded (Base64 encoding) and the metadata parameter is analyzed. This must be a JSON object with each key representing a type of metadata. These types cannot be repeated and must be a value among the following: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",TA,"Allowed metadata types are: 'openid_relying_party', 'openid_provider', 'federation_entity', 'oauth_authorization_server', 'oauth_resource', 'trust_mark_issuer'",SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#entity-configuration-claim-comuni,OIDC Federation,,,,
OP-Entity Configuration response OP-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Trigger To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Compliant if the signature is correct, not compliant otherwise",Entity Configuration response OP,Does the entity correctly sign the Entity Configuration,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header",OP,Entity Configurations must be signed,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,,,"JOSE format can be JWS or JWE, we assume it to be JWS in this case",
OP-Token response-metadata-value,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained ID Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the third part of the string is taken and passed to a signature verifier correctly configured","Trigger Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained ID Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the third part of the string is taken and passed to a signature verifier correctly configured","Compliant if the signature part of the ID Token is correctly verified using the OP's public key, not compliant otherwise",Token response,Does the OP correctly sign the ID Token,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained ID Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the third part of the string is taken and passed to a signature verifier correctly configured",OP,The ID Token is a JSON Web Token (JWT) that contains information on the user that has executed the authentication.,SPID_CIE_OIDC#Token-Endpoint-ID-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#id-token,OIDC Core,Is the ID token signed (IsSigned),Does the OP sign the ID Token and with what,,
OP-Token response-metadata-value,"In this test an authentication request with scope 'openid' is made. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the access token.","Trigger In this test an authentication request with scope 'openid' is made. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the access token.","Compliant if the token response has the access_token parameter, not Compliant otherwise",Token response,Does the OP issue the access tokens when requested,"In this test an authentication request with scope 'openid' is made. Once received the code, the RP tries to exchange it in the token endpoint and the response must contain the access token.",OP,The Access Token must be formed according to the standard iGov,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained Access Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the access token is passed to a signature verifier correctly configured","Trigger Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained Access Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the access token is passed to a signature verifier correctly configured","Compliant if the signature of the Access Token is correctly verified using the OP's public key, not compliant otherwise",Token response,Does the OP correctly sign the Access Token,"Tokens issued by an OP must have the structure of JWT Tokens. In particular, this structure is composed by three base64url encoded strings separated by dots, namely the header, payload and signature. The signature is made using the OP's private key, in such a way to be decrypted using its public key. In this test a normal flow is performed and the obtained Access Token is analyzed. In order to test if the OP correctly signed the signature part of the JWT, the access token is passed to a signature verifier correctly configured",OP,The Access Token must be formed according to the standard iGov,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
SA-Entity Statement response OP-metadata-value,"To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Trigger To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Compliant if the signature of the trust marks in the entity statement is valid, not compliant otherwise",Entity Statement response OP,Does the SA correctly sign the Trust marks,"To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",SA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Trigger In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Compliant if the signature is verified, not compliant otherwise",Entity Statement response OP,Does the SA correctly signs the Entity Statement,"In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",SA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#firma-di-entity-statement,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Trigger In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Compliant if the signature is verified, not compliant otherwise",Entity Statement response OP,Does the TA correctly sign the Entity statements,"In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",TA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked","Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Compliant if the email claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",SA,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked","Compliant if the id claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the id claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked",SA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Compliant if the id_code claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",SA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Compliant if the logo_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",SA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Compliant if the organization_name claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",SA,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Compliant if the organization_type claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",SA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked","Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Compliant if the ref claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",SA,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked","Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Compliant if the exp claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",SA,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Compliant if the iat claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",SA,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
OP-Token response-metadata-value,"When an RP sends a token request using the refresh token, the OP must check the presence of the grant_type parameter in the request but also the presence of the refresh token. In order to check whether the OP accomplish this control, a token request without a refresh token is sent and the response analyzed",Token request with grant_type refresh token but missing the necessary refresh token in the body,"Compliant if the Token response is an HTTP 400 because of invalid_request, not compliant otherwise",Token response,Does the OP accept a token request using the grant_type set to 'refresh_token' but without the necessary refresh token,"When an RP sends a token request using the refresh token, the OP must check the presence of the grant_type parameter in the request but also the presence of the refresh token. In order to check whether the OP accomplish this control, a token request without a refresh token is sent and the response analyzed",OP,An RP doing a Token Request using a refresh token must insert the grant_type parameter in the request with the value 'refresh_token' and the refresh_token parameter,SPID_CIE_OIDC#Token-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#request,OIDC Core,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked","Compliant if the iss claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked",SA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked","Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked","Compliant if the sub claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain the sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked",SA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.","Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.","Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"A Trust Mark issued for an SA is taken, decrypted and the presence of the sa_profile claim is checked.","Trigger A Trust Mark issued for an SA is taken, decrypted and the presence of the sa_profile claim is checked.","Compliant if the sa_profile claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued intermediary Trust Mark contain the sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the presence of the sa_profile claim is checked.",TA,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.","Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.","Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL","Compliant if the logo_uri parameter in the trust mark in the trust marks parameter of the response is an URI, not compliant otherwise ",Entity Statement response OP,Does the Trust Mark contain a correct logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL",TA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list","Compliant if the claims claim is present and its value is a list, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim and it is a list",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object","Compliant if the id_code claim is a JSON Object, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain correcty type of id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object",SA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
OP-Revocation response-metadata-value,Revocation Response to a Request containing a previously revoked access token,Revocation request with a previously-revoked token,"Compliant if the response is an HTTP 200 OK response, not compliant otherwise",Revocation response,Does the OP's revocation endpoint answer correctly when an already-revoked token is provided,"After a correct flow where an authentication is accomplished and a token is obtained from the OP's Token Endpoint. After this, a request to the Revocation endpoint is done, the token is substituted with an already-revoked token and the response analyzed",OP,"The Revocation Endpoint responds with an HTTP 200 code, even if the indicated token does not exist or has already been revoked (so as not to release information).",SPID_CIE_OIDC#Revocation-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#response,OIDC Core,,,"If an already-revoked token is not held, an ad-hoc session must be created with two revocation requests",
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL","Compliant if the logo_uri claim is value is an URL, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain correct type of logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL",SA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL","Compliant if the policy_uri claim is present and its value is an URL, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL","Compliant if the tos_uri claim is an URL, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL","Compliant if the iss claim is an URL, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL",SA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL","Compliant if the service_documentation claim is an URL, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL","Compliant if the sub claim is an URL, not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL",SA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects","Compliant if the claims claim is a list of JSON Objects, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL","Compliant if the policy_uri claim is an URL, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL","Compliant if the service_documentation claim is an URL, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL","Compliant if the tos_uri claim is an URL, not compliant otherwise",Entity Statement response OP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'","Compliant if the organization_type claim contains 'public' or 'private', not compliant otherwise",Entity Statement response OP,Does the Trust Mark contain correct value for organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'",SA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'","Trigger A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'","Compliant if the sa_profile claim is 'full' or 'light', not compliant otherwise",Entity Statement response OP,Does the issued intermediary Trust Mark contain a correct sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'",TA,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,,,,
TA-Entity Statement response OP-metadata-value,"To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Trigger To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Compliant if the signature is valid, not compliant otherwise",Entity Statement response OP,Does the TA correctly sign the issued Trust Mark,"To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",TA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,,,,
SA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,Trust mark status request (POST) with valid trust mark identifier and subject ,"Compliant if the response contains an active claim in the body, not compliant otherwise",Trust Mark status response,Does the Entity's trust mark status endpoint correctly verify a valid Trust Marks,"In order to check if the trust mark status endpoint of a TA or SA correctly verifies valid trust marks, a valid trust mark can be sent to the endpoint and the response analyzed. It must contain an active claim set to true",SA,"All the Entities that release Trust Marks, MUST expose a Trust Mark status endpoint for allowing the dynamic validation.",SPID_CIE_OIDC#Trust-Marks-Validation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#validazione-dei-trust-mark,OIDC Federation,,,,
OP-Token response-metadata-value,This test verifies the head Content-Type set to application/json in the token response.,Trigger This test verifies the head Content-Type set to application/json in the token response.,"Compliant if the token response has application/json set in Content-Type, not Compliant otherwise",Token response,Does the Content-Type in a token response set correctly?,This test verifies the head Content-Type set to application/json in the token response.,OP,The Token response must have the Content-Type head set to application/json.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,This test verifies whether the HTTP status of a token response is 200.,Trigger This test verifies whether the HTTP status of a token response is 200.,"Compliant if the HTTP status code of a token response is 200, not Compliant otherwise",Token response,Does the HTTP status of a token response correct?,This test verifies whether the HTTP status of a token response is 200.,OP,The Token response must be an HTTP 200.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
TA-Entity Statement response TA-metadata-value,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked","Trigger In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,Entity Statement response TA,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked",TA,The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
OP-Userinfo response-metadata-value,Userinfo response to a request with revoked token,Userinfo request with a revoked token,"Compliant if the Userinfo response is an HTTP 400 because of invalid_grant, not compliant otherwise",Userinfo response,Does the OP really revoke the Token after a request,"Once obtained a token, it is directly sent to the revocation endpoint. In order to verify that the token is really revoked, a new request to the UserInfo endpoint can be made. If the response contains the claims requested, than the token is still valid.",OP,"The OP will have to revoke the token specified in the request and will have to end the Single Sign-On session, if it is still active",SPID_CIE_OIDC#Revocation-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/revocation_endpoint.html#request,OIDC Core,"Can access tokens be revoked (CanAccessTokensBeRevoked), Can refresh tokens be revoked (CanRefreshTokensBeRevoked), Does the server support RFC7009 (token revocation)",,,
TA-Entity Statement response TA-metadata-value,"The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'","Trigger The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'","Compliant if the id is 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile is 'public' or private', not compliant otherwise",Entity Statement response TA,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'",TA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response TA-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,Entity Statement response TA,Does the id_code claim of a Trust Mark issued by a TA for public organization contain ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.",TA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response TA-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",Entity Statement response TA,Does the id_code claim of a Trust Mark issued by a TA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",TA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",Entity Statement response OP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",SA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
OP-Token response-metadata-value,This test verifies whether the token_type of a token response is Bearer.,Trigger This test verifies whether the token_type of a token response is Bearer.,"Compliant if the token_type value in token response is Bearer, not Compliant otherwise",Token response,Does the token_type of a token response set correctly?,This test verifies whether the token_type of a token response is Bearer.,OP,The token_type of a Token response must be Bearer.,SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,,,,
OP-Token response-metadata-value,"In this test an RP makes a correct authentication request and, once received the code, the RP tries to exchange it in the token endpoint. The response is then analyzed and it must contain the expires_in parameter",Trigger Token response,"Compliant if the token response has the expires_in parameter, not Compliant otherwise",Token response,Does the OP issue the expires_in in a token response,"In this test an RP makes a correct authentication request and, once received the code, the RP tries to exchange it in the token endpoint. The response is then analyzed and it must contain the expires_in parameter",OP,"The Token response, if succesful, returns an ID Token, an Access Token and possibly a Refresh Token (if the authentication request has scope=offline_access)",SPID_CIE_OIDC#Token-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#response,OIDC Core,Are refresh tokens supported (HasRefreshTokens),,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked","Compliant if the alg parameter in the Refresh Token Header is present, not compliant otherwise",Token response,Does the issued JWT Refresh Token contain the 'alg' parameter in the Header,"In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked",OP,The JWT Refresh Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Refresh-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be a supported asymmetric algorithm between ['RS256', 'RS512']","Compliant if the alg parameter in the Refresh Token Header contains a value among RS256 and RS512, not compliant otherwise ",Token response,Does the issued JWT Refresh Token contain a correct 'alg' parameter in the Header,"In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. The value must be a supported asymmetric algorithm between ['RS256', 'RS512']",OP,The JWT Refresh Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Refresh-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
OP-Token response-metadata-value,Token response,"Trigger In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.","Compliant if the alg parameter in the Refresh Token Header contains a value among RS256 and RS512, not Compliant if it contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",Token response,Does the issued JWT Refresh Token contain a wrong 'alg' parameter in the Header,"In this test, the Refresh Token is taken from the Token Response, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.",OP,The JWT Refresh Token Header requires the alg parameter,SPID_CIE_OIDC#Token-Endpoint-Refresh-Token; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/token_endpoint.html#refresh-token,OIDC Core,,,,
ALL-Entity Configuration response-metadata-value,In this test a correct request to the entity's /.well-known/openid-federation endpoint is made and the response is analyzed. It must be an HTTP 200 OK response,Entity Configuration request,"Compliant if the response is an HTTP 200 OK, not compliant otherwise",Entity Configuration response,Does the entity return a correct HTTP code in the EC response,In this test a correct request to the entity's /.well-known/openid-federation endpoint is made and the response is analyzed. It must be an HTTP 200 OK response,ALL,,SPID_CIE_OIDC#Entity-Configuration-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the alg parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the alg parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
ALL-Entity Configuration response-metadata-value,In this test a correct request to the entity's /.well-known/openid-federation endpoint is made and the response is analyzed. It must have a Content-Type parameter set to application/entity-statement+jwt,Entity Configuration request,"Compliant if the Content-Type of the response is application/entity-statement+jwt, not compliant otherwise",Entity Configuration response,Does the entity return a correct Content-Type in the EC response,In this test a correct request to the entity's /.well-known/openid-federation endpoint is made and the response is analyzed. It must have a Content-Type parameter set to application/entity-statement+jwt,ALL,,SPID_CIE_OIDC#Entity-Configuration-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RS256', 'RS512'] in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RS256', 'RS512'] in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the alg parameter containing a value among ['RS256', 'RS512'], not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain a correct alg parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RS256', 'RS512'] in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the alg parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain the alg parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'alg' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RS256', 'RS512'] in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RS256', 'RS512'] in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the alg parameter containing a value among ['RS256', 'RS512'], not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain a correct alg parameter in the JOSE Header,"The JWE Token contained in the UserInfo response is taken and analyzed. If it contains the 'alg' parameter containing a value among ['RS256', 'RS512'] in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWS contained in the payload of the JWE in the body of the response there is the kid parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWS contain the kid parameter in the JOSE Header,"The JWS Token contained in the encrypted payload of the JWE in the UserInfo response body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the kid parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked","Trigger In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the fiscal_number or vat_number claim,Entity Statement response RP,Does the id_code claim of a Trust Mark issued for private organization contain the fiscal_number or vat_number claim,"In this test, a Trust Mark issued for a private entity must be taken, decrypted and the presence of the fiscal_number claim or vat_number in the id_code is checked",TA,The vat_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the fiscal_number claim. The fiscal_number claim is required in the id_code claim of Trust Marks issued for private Organizations if there is not the vat_number claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'","Trigger The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'","Compliant if the id is 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile is 'public' or private', not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct id claim,"The id of the trust mark must have the structure <TA domain>/<entity_type>/<trustmark_profile>/. So in this test, an issued Trust Mark must be taken, decrypted and the value of the id claim can be one among 'openid_relying_party', 'openid_provider', 'intermediary' 'oauth_resource', whereas the trustmark profile can be 'public' or 'private'",TA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.",Compliant if the id_code claim of the trust mark in the trust marks parameter contains the ipa_code claim,Entity Statement response RP,Does the id_code claim of a Trust Mark issued by a TA for a public organization contain ipa_code claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the presence of 'ipa_code' in the id_code claim in it is checked.",TA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",Entity Statement response RP,Does the id_code claim of a Trust Mark issued by a TA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",TA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Trigger In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string","Compliant if the ipa_code in the id_code claim of a trust mark is a string, not compliant otherwise",Entity Statement response RP,Does the id_code claim of a Trust Mark issued by an SA for public organization contain a correct type of 'ipa_code' claim,"In this test, a Trust Mark issued for a public entity must be taken, decrypted and the type of the value of the 'ipa_code' in the id_code claim is checked. It has to be a string",SA,The ipa_code claim is required in the id_code claim of Trust Marks issued for public Organizations,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,Trust Mark status invalid request,"Compliant if the Trust Mark status response is an HTTP 400 because of invalid_request, not compliant otherwise",Trust Mark status response,Does the TA checks Trust Marks not issued by the Entity,"In this test, a valid Trust Mark issued by another entity is sent to an SA or TA. If it validates the Trust Mark, than is not compliant with the specifications",TA,trust mark status endpoint: allows an Entity to test if a TM is still active or not. The request MUST be sent to the subject that has released that TM.,SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
TA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,Trust Mark status endpoint request with invalidated Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",Trust Mark status response,Does the TA invalidate revocated trust marks,"In order to check if a TA or SA correctly invalidate a Trust Mark, a Trust Mark revocation request on a Trust Mark has to be made and then the trust mark status endpoint must be fetched. If the response says that the trust mark is invalid, than it is correctly invalidated, otherwise the TA or SA is not compliant with the specification",TA,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,,,,
TA-Trust Mark status response-metadata-value,Trust Mark status endpoint response,Trust Mark status request with a non-valid Trust Mark,"Compliant if the response contains an active claim set to false, not compliant otherwise",Trust Mark status response,Does the TA's trust mark status endpoint correctly refuses revocated or invalid Trust Marks,"In order to check if the trust mark status endpoint of an TA or SA correctly refuses invalid trust marks, a invalid or revocated trust mark can be sent to the endpoint and the response analyzed",TA,"A Trust Mark can be revoked at any moment only and exclusively by the issuing subject. In case of TM revocation, the dynamic validation gives a negative result",SPID_CIE_OIDC#Trust-Marks-Revocation; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#revoca-dei-trust-mark,OIDC Federation,,,,
OP-Userinfo response-metadata-value,"In this test, the JWE is taken from the Userinfo Response's body, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.","Trigger In this test, the JWE is taken from the Userinfo Response's body, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.","Compliant if the alg parameter in the JOSE Header of the JWE in the body of the response contains a value among RS256 and RS512, not Compliant if it contains values among ['none', 'HS256', 'HS384', 'HS512'] or is empty",Userinfo response,Does the UserInfo Response's JWE contain a correct alg parameter in the JOSE Header,"In this test, the JWE is taken from the Userinfo Response's body, the header is base64url decoded and the presence of the 'alg' parameter in the Header is checked. If its value is set to none, contains values among ['none', 'HS256', 'HS384', 'HS512'], is absent or contains a symmetric algorithm, than the Token is not compliant.",OP,The JOSE header MUST contain the alg parameter,SPID_CIE_OIDC#Userinfo-Endpoint-Response; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#response,OIDC Core,,,,
OP-Userinfo response-metadata-value,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification","Trigger The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification","Compliant if in the JOSE Header of the JWE in the body of the response there is the kid parameter, not compliant otherwise",Userinfo response,Does the UserInfo Response's JWE contain the kid parameter in the JOSE Header,"The JWE Token contained in the UserInfo response's body is taken and analyzed. If it contains the 'kid' parameter in the JOSE header, then it is compliant with the specification",OP,The JOSE header MUST contain the kid parameter,SPID_CIE_OIDC#UserInfo-Endpoint-Request; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/userinfo_endpoint.html#request,OIDC Core,,,,
SA-Entity Statement response RP-metadata-value,"After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Trigger After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Compliant if the SA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",Entity Statement response RP,Does the SA correctly release the Entity statements,"After a correct onboarding with the SA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the SA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",SA,"The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it. An Entity publishes an ES related to a subordinate, at its Fetch Endpoint.",SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Trigger After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.","Compliant if the TA's return the Entity Statement regarding the Entity we are considering, not compliant otherwise",Entity Statement response RP,Does the TA correctly release the Entity statements,"After a correct onboarding with the TA, it must publish the entity statement for the subordinate entity in its fetch endpoint. So, in this test, once correctly registered an Entity, an HTTP GET request is made to the TA's fetch endpoint, with the request containing the Entity identifier. The response is then checked and it must contain the subordinate entity's Entity Statement.",TA,The Federation Authority or an Intermediary MUST publish the Leaf Entity Statement containing the Federation public keys of the onboarded Entity and the TMs released for it.,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response TA-metadata-value,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Trigger In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Compliant if the response contains a JWT, not compliant otherwise",Entity Statement response TA,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",TA,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Compliant if the logo_uri claim is present in the trust_mark JWT in the trust_marks parameter, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",TA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Compliant if the constraints parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the constraints parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",SA,The constraints parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Compliant if the exp parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",SA,The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp","Compliant if the exp parameter is a timestamp, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain a correct exp parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the exp parameter is checked. It must be a timestamp",SA,The exp parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Compliant if the iat parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",SA,The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp","Compliant if the iat parameter is a timestamp, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain a correct iat parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response is base64url decoded and once obtained the decrypted Payload, the the iat parameter is checked. It must be a timestamp",SA,The iat parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Compliant if the iss parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the iss parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",SA,The iss parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Compliant if the jwks parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the jwks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",SA,The jwks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Compliant if the metadata_policy parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the metadata_policy parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",SA,The metadata_policy parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Compliant if the sub parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the sub parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",SA,The sub parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Trigger In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the SA contain the trust_marks parameter,"In order to check if the SA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the SA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",SA,The trust_marks parameter is required in the Entity Statement released by the SA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked","Compliant if the constraints parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the constraints parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the constraints parameter is checked",TA,The constraints parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Compliant if the email claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",TA,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked","Compliant if the exp parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the exp parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the exp parameter is checked",TA,The exp parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked","Compliant if the iat parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the iat parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iat parameter is checked",TA,The iat parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.","Trigger The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.","Compliant if the id claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the id claim,"The id of the trust mark must be present. So in this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked.",TA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Compliant if the id_code claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",TA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked","Compliant if the iss parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statement issued by the TA contain the iss parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the iss parameter is checked",TA,The iss parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked","Compliant if the jwks parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the jwks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the jwks parameter is checked",TA,The jwks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object","Compliant if the metadata_policy parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the metadata_policy parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the metadata_policy parameter is checked. It must be a JSON Object",TA,The metadata_policy parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Compliant if the organization_name claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",TA,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Compliant if the organization_type claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",TA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Compliant if the ref claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",TA,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked","Compliant if the sub parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the sub parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the sub parameter is checked",TA,The sub parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Compliant if the exp claim is present, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",TA,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.","Compliant if the iss claim is present, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked.",TA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Trigger In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked","Compliant if the trust_marks parameter is present, not compliant otherwise",Entity Statement response RP,Does Entity Statements issued by the TA contain the trust_marks parameter,"In order to check if the TA issues correct Entity statements, a request for an entity statement is made (HTTP GET request in the TA's fetch endpoint) and the response is analyzed. Therefore, the Entity Statement Payload contained in the response are base64url decoded, once obtained the decrypted Payload, the presence if the trust_marks parameter is checked",TA,The trust_marks parameter is required in the Entity Statement released by the TA,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Compliant if the iat claim is present, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",TA,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.","Compliant if the sub claim is present in the trust mark, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked.",TA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object","Compliant if the id_code claim is a JSON Object, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim is a JSON Object",TA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL","Compliant if the sub claim is an URL, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the sub claim has to be an URL",TA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'","Compliant if the organization_type claim is 'public' or 'private', not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim is 'public' or 'private'",TA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Trigger To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Compliant if the signature of the trust marks in the entity statement is valid, not compliant otherwise",Entity Statement response RP,Does the SA correctly sign the Trust marks,"To accomplish this test, an entity statement issued by the SA is taken, and the trust marks in it are taken. The three parts of the JWT (header, payload and signature) composing the trust marks are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",SA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Trigger In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Compliant if the signature is verified, not compliant otherwise",Entity Statement response RP,Does the SA correctly signs the Entity Statement,"In order to validate the signature of an Entity statement issued by an SA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the Entity Statement of the SA issued from the TA), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",SA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statement; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#firma-di-entity-statement,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Trigger In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header","Compliant if the signature is verified, not compliant otherwise",Entity Statement response RP,Does the TA correctly sign the Entity statements,"In order to validate the signature of an Entity statement issued by the TA, the statement is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter of the entity configuration), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Statement Header",TA,Entity Statements must be signed,SPID_CIE_OIDC#Entity-Statements; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_statement.html#id2,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked","Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.","Compliant if the email claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the email claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the email claim in it is checked.",SA,The issued Trust Marks must have the email claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked","Compliant if the id claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the id claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id claim in it is checked",SA,The issued Trust Marks must have the id claim. The id in the trust mark is an URL with the following structure: <TA domain>/<entity_type>/<trustmark_profile>/,SPID_CIE_OIDC#Trust-Mark-Composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.","Compliant if the id_code claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the id_code claim in it is checked.",SA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.","Compliant if the logo_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the logo_uri claim in it is checked.",SA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.","Compliant if the organization_name claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the organization_name claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_name claim in it is checked.",SA,The issued Trust Marks must have the organization_name claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.","Compliant if the organization_type claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the organization_type claim in it is checked.",SA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked","Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.","Compliant if the ref claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the ref claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the ref claim in it is checked.",SA,The issued Trust Marks must have the ref claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked","Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.","Compliant if the exp claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the exp claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the exp claim in it is checked.",SA,The issued Trust Marks must have the exp claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.","Compliant if the iat claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the iat claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iat claim in it is checked.",SA,The issued Trust Marks must have the iat claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked","Compliant if the iss claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the iss claim in it is checked",SA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked","Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked","Trigger In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked","Compliant if the sub claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain the sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the presence of the sub claim in it is checked",SA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.","Compliant if the claims claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the claims claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.","Compliant if the policy_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the policy_uri claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"A Trust Mark issued for an SA is taken, decrypted and the presence of the sa_profile claim is checked.","Trigger A Trust Mark issued for an SA is taken, decrypted and the presence of the sa_profile claim is checked.","Compliant if the sa_profile claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued intermediary Trust Mark contain the sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the presence of the sa_profile claim is checked.",TA,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.","Compliant if the service_documentation claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the service_documentation claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.","Compliant if the tos_uri claim is present in the trust mark payload, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain the tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the presence of the tos_uri claim in it is checked.",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL","Compliant if the logo_uri parameter in the trust mark in the trust marks parameter of the response is an URI, not compliant otherwise ",Entity Statement response RP,Does the Trust Mark contain a correct logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim has to be an URL",TA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list","Compliant if the claims claim is present and its value is a list, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim is checked to be a list",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim and it is a list",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object","Compliant if the id_code claim is a JSON Object, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain correcty type of id_code claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the id_code claim must be a JSON Object",SA,The issued Trust Marks must have the id_code claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL","Compliant if the logo_uri claim is value is an URL, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain correct type of logo_uri claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the logo_uri claim is an URL",SA,The issued Trust Marks must have the logo_uri claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL","Compliant if the policy_uri claim is present and its value is an URL, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the policy_uri claim in it is checked. Its value has to be an URL",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL","Compliant if the tos_uri claim is an URL, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the tos_uri claim is checked to be an URL",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL","Compliant if the iss claim is an URL, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct iss claim,"In this test, an issued Trust Mark must be taken, decrypted and the iss claim in it is checked. Its value has to be an URL",SA,The issued Trust Marks must have the iss claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL","Compliant if the service_documentation claim is an URL, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) is taken and the service_documentation claim is checked to be an URL",SA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL","Trigger In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL","Compliant if the sub claim is an URL, not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain a correct sub claim,"In this test, an issued Trust Mark must be taken, decrypted and the sub claim in it is checked. Its value has to be an URL",SA,The issued Trust Marks must have the sub claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects","Compliant if the claims claim is a list of JSON Objects, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct claims claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the claims claim has to be a list of JSON Objects",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the claims claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL","Compliant if the policy_uri claim is an URL, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct policy_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the policy_uri claim has to be an URL",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the policy_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL","Compliant if the service_documentation claim is an URL, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct service_documentation claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the service_documentation has to be an URL",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the service_documentation claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL","Trigger In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL","Compliant if the tos_uri claim is an URL, not compliant otherwise",Entity Statement response RP,Does the issued oauth_resource Trust Mark contain a correct tos_uri claim,"In this test, a Trust Mark issued for an AA (oauth_resource profile) must be taken, decrypted and the value of the tos_uri claim has to be an URL",TA,"In addition to the claims of the public and private profiles, the profile oauth_resource identifies the AA and adds the tos_uri claim:",SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'","Trigger In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'","Compliant if the organization_type claim contains 'public' or 'private', not compliant otherwise",Entity Statement response RP,Does the Trust Mark contain correct value for organization_type claim,"In this test, an issued Trust Mark must be taken, decrypted and the value of the organization_type claim can be 'public' or 'private'",SA,The issued Trust Marks must have the organization_type claim,SPID_CIE_OIDC#Trust-Mark-composition; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#composizione-dei-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'","Trigger A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'","Compliant if the sa_profile claim is 'full' or 'light', not compliant otherwise",Entity Statement response RP,Does the issued intermediary Trust Mark contain a correct sa_profile claim,"A Trust Mark issued for an SA is taken, decrypted and the value of the sa_profile claim can be 'full' or 'light'",TA,"In addition to the claims of the public and private profiles, the profile intermediary identifies the SA and adds the extensions full and light in the sa_profile claim, according to the ways of operation towards the subordinate Entities.",SPID_CIE_OIDC#federation_entity-Trust-Mark; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html#federation-entity-trust-mark,OIDC Federation,,,,
TA-Entity Statement response RP-metadata-value,"To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Trigger To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.","Compliant if the signature is valid, not compliant otherwise",Entity Statement response RP,Does the TA correctly sign the issued Trust Mark,"To accomplish this test, a Trust Mark issued by the TA is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier.",TA,The Trust Marks (TM) are signed JWT,SPID_CIE_OIDC#Trust-Marks; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/trust_marks.html,OIDC Federation,,,,
SA-Entity Statement response OP-metadata-value,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Trigger In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Compliant if the response contains a JWT, not compliant otherwise",Entity Statement response OP,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",SA,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
SA-Entity Statement response RP-metadata-value,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Trigger In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.","Compliant if the response contains a JWT, not compliant otherwise",Entity Statement response RP,Does the Entity expose the fetch entity statement endpoint,"In order to check the presence and correctness of the fetch entity statement endpoint, an HTTP GET request containing the parameters 'iss' and 'sub' is made to the entity's endpoint and a response containing the resolved metadata for the entity in the request's sub claim is expected.",SA,"In addition to the Federation endpoints reported before, the Entities of type TA or SA MUST provide the fetch entity statement endpoint. It returns the ESs regarding a direct subordinate subject. For obtaining the ES of an Entity, at least its Entity identifier is needed",SPID_CIE_OIDC#federation-endpoints; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/federation_endpoint.html,OIDC Federation,,,,
RP-Entity Configuration response RP-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Trigger To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Compliant if the signature is correct, not compliant otherwise",Entity Configuration response RP,Does the entity correctly sign the Entity Configuration,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header",RP,Entity Configurations must be signed,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,,,"JOSE format can be JWS or JWE, we assume it to be JWS in this case",
SA-Entity Configuration response SA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Trigger To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Compliant if the signature is correct, not compliant otherwise",Entity Configuration response SA,Does the entity correctly sign the Entity Configuration,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header",SA,Entity Configurations must be signed,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,,,"JOSE format can be JWS or JWE, we assume it to be JWS in this case",
TA-Entity Configuration response TA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Trigger To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Compliant if the signature is correct, not compliant otherwise",Entity Configuration response TA,Does the entity correctly sign the Entity Configuration,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header",TA,Entity Configurations must be signed,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,,,"JOSE format can be JWS or JWE, we assume it to be JWS in this case",
AA-Entity Configuration response AA-metadata-value,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Trigger To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header","Compliant if the signature is correct, not compliant otherwise",Entity Configuration response AA,Does the entity correctly sign the Entity Configuration,"To accomplish this test, the Entity configuration of the interested entity is taken and the three parts of the JWT (header, payload and signature) are base64url decoded. Finally, the signature is validated passing the public key (n, e of jwks parameter that must be taken from the Entity Statement of a superior), the JWS Signature (received signature base64url decoded) and the JWS signing input (header and payload base64url encoded and concatenated with a dot dividing them) to a signature verifier configured for the algorithm described in the Entity Configuration Header",AA,Entity Configurations must be signed,SPID_CIE_OIDC#Entity-Configuration; https://docs.italia.it/italia/spid/spid-cie-oidc-docs/it/versione-corrente/entity_configuration.html#,OIDC Federation,,,"JOSE format can be JWS or JWE, we assume it to be JWS in this case",